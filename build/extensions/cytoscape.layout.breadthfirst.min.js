
/* cytoscape.layout.breadthfirst.min.js */

/**
 * This file is part of cytoscape.js 2.0.2-github-snapshot-2013.09.02-09.14.40.
 * 
 * Cytoscape.js is free software: you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the Free
 * Software Foundation, either version 3 of the License, or (at your option) any
 * later version.
 * 
 * Cytoscape.js is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
 * details.
 * 
 * You should have received a copy of the GNU Lesser General Public License along with
 * cytoscape.js. If not, see <http://www.gnu.org/licenses/>.
 */
 
(function(a){var b={fit:true,ready:undefined,stop:undefined,directed:true,padding:30,circle:false,roots:undefined,maximalAdjustments:0};function c(d){this.options=a.util.extend({},b,d)}c.prototype.run=function(){var g=this.options;var D=g;var A=g.cy;var P=A.nodes();var t=A.edges();var L=A.container();var d=L.clientWidth;var l=L.clientHeight;var C;if(a.is.elementOrCollection(D.roots)){C=D.roots}else{if(a.is.array(D.roots)){var o=[];for(var S=0;S<D.roots.length;S++){var M=D.roots[S];var W=A.getElementById(M);
C.push(W)}C=new a.Collection(A,o)}else{C=P.roots()}}var x=[];var X={};var B={};C.bfs(function(h,w){var j=this[0];if(!x[w]){x[w]=[]}x[w].push(j);X[j.id()]=true;B[j.id()]=w},D.directed);var F=[];for(var S=0;S<P.length;S++){var W=P[S];if(X[W.id()]){continue}else{F.push(W)}}var u=F.length*3;var G=0;while(F.length!==0&&G<u){var J=F.shift();var O=J.neighborhood().nodes();var s=false;for(var S=0;S<O.length;S++){var p=B[O[S].id()];if(p!==undefined){x[p].push(J);s=true;break}}if(!s){F.push(J)}G++}while(F.length!==0){var J=F.shift();
var K=J.bfs();var s=false;for(var S=0;S<K.length;S++){var p=B[K[S].id()];if(p!==undefined){x[p].push(J);s=true;break}}if(!s){if(x.length===0){x.push([])}x[0].push(J)}}function I(){for(var Y=0;Y<x.length;Y++){var h=x[Y];for(var w=0;w<h.length;w++){var Z=h[w];Z._private.scratch.BreadthFirstLayout={depth:Y,index:w}}}}I();for(var f=0;f<D.maximalAdjustments;f++){function q(w){var ac=w.connectedEdges('[target = "'+w.id()+'"]');var aa=w._private.scratch.BreadthFirstLayout;var Y=0;var h;for(var ad=0;ad<ac.length;
ad++){var j=ac[ad];var ab=j.source()[0];var Z=ab._private.scratch.BreadthFirstLayout;if(aa.depth<Z.depth&&Y<Z.depth){Y=Z.depth;h=ab}}return h}var m=x.length;var v=[];for(var S=0;S<m;S++){var p=x[S];var N=p.length;for(var R=0;R<N;R++){var W=p[R];var V=W._private.scratch.BreadthFirstLayout;var z=q(W);if(z){V.intEle=z;v.push(W)}}}for(var S=0;S<v.length;S++){var W=v[S];var V=W._private.scratch.BreadthFirstLayout;var z=V.intEle;var k=z._private.scratch.BreadthFirstLayout;x[V.depth].splice(V.index,1);var r=k.depth+1;
while(r>x.length-1){x.push([])}x[r].push(W);V.depth=r;V.index=x[r].length-1}I()}var n=0;for(var S=0;S<P.length;S++){var Q=P[S].outerWidth();var T=P[S].outerHeight();n=Math.max(n,Q,T)}n*=1.75;var y={};function E(af){if(y[af.id()]){return y[af.id()]}var w=af._private.scratch.BreadthFirstLayout.depth;var ae=af.neighborhood().nodes();var Z=0;var aa=0;for(var j=0;j<ae.length;j++){var ac=ae[j];var ab=ac.edgesWith(af);var Y=ac._private.scratch.BreadthFirstLayout.index;var h=ac._private.scratch.BreadthFirstLayout.depth;
var ad=x[h].length;if(w>h||w===0){Z+=Y/ad;aa++}}aa=Math.max(1,aa);Z=Z/aa;if(aa===0){Z=undefined}y[af.id()]=Z;return Z}for(var H=0;H<3;H++){for(var S=0;S<x.length;S++){var p=S;var U=[];x[S]=x[S].sort(function(i,h){var j=E(i);var w=E(h);return j-w})}I()}var e={x:d/2,y:l/2};P.positions(function(){var ac=this[0];var i=ac._private.scratch.BreadthFirstLayout;var j=i.depth;var w=i.index;var ab=Math.max(d/(x[j].length+1),n);var aa=Math.max(l/(x.length+1),n);var Z=Math.min(d/2/x.length,l/2/x.length);Z=Math.max(Z,n);
if(D.circle){var Y=Z*j+Z-(x.length>0&&x[0].length<=3?Z/2:0);var h=2*Math.PI/x[j].length*w;if(j===0&&x[0].length===1){Y=1}return{x:e.x+Y*Math.cos(h),y:e.y+Y*Math.sin(h)}}else{return{x:(w+1)*ab,y:(j+1)*aa}}});if(g.fit){A.fit(D.padding)}A.one("layoutready",g.ready);A.trigger("layoutready");A.one("layoutstop",g.stop);A.trigger("layoutstop")};c.prototype.stop=function(){};a("layout","breadthfirst",c)})(cytoscape);