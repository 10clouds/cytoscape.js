
/* jquery.cytoscapeweb.all.min.js */

/**
 * This file is part of Cytoscape Web snapshot-2012.02.14-14.30.15.
 * 
 * Cytoscape Web is free software: you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the Free
 * Software Foundation, either version 3 of the License, or (at your option) any
 * later version.
 * 
 * Cytoscape Web is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
 * details.
 * 
 * You should have received a copy of the GNU Lesser General Public License along with
 * Cytoscape Web. If not, see <http://www.gnu.org/licenses/>.
 */
 
(jQuery.color||(function(a){a.color={isEqual:function(b,d){if(b.length!==d.length){return false}var c=b.length;while(c--){if(b[c]!==d[c]){return false}}return true},fix:function(b,d){var c=d.length;while(c--){if(typeof b[c]==="number"){switch(d.charAt(c)){case"i":b[c]=Math.round(b[c]);break;case"o":b[c]=Math.min(255,Math.max(0,Math.round(b[c])));break;case"1":b[c]=Math.min(1,Math.max(0,b[c]));break}}}return b},self:function(b){return b},alpha:function(b){return b===undefined?1:b},palette:{},fns:[]}
})(jQuery));(jQuery.color&&(function(a){a.color.RGB={fix:function(b){b=a.color.fix(b,"ooo1");return b},toRGB:a.color.self,toHEX:function(b){return"#"+(16777216+b[0]*65536+b[1]*256+b[2]).toString(16).slice(-6)},toCSS:function(b){if(a.color.alpha(b[3])===0){return"transparent"}if(a.color.alpha(b[3])<1){return"rgba("+b.join(",")+")"}return"rgb("+Array.prototype.slice.call(b,0,3).join(",")+")"},red:function(b){return b[0]},green:function(b){return b[1]},blue:function(b){return b[2]},alpha:function(b){return a.color.alpha(b[3])
}};a.color.RGB.toString=a.color.RGB.toHEX;a.color.fns.push("RGB.toRGB","RGB.toHEX","RGB.toCSS","RGB.red","RGB.green","RGB.blue","RGB.alpha")})(jQuery));(jQuery.color&&(function(a){a.color.HueBased={fix:function(b){b[0]=(b[0]+1)%1;return a.color.fix(b,"1111")},complementary:function(c,b){return[(c[0]+0.5+(b||0))%1,c[1],c[2],c[3]]},analogous:function(c,b){return[(c[0]+1+(b||0))%1,c[1],c[2],c[3]]},hue:function(b){return b[0]},alpha:function(b){return a.color.alpha(b[3])}}})(jQuery));(jQuery.color&&(function(a){a.color.HSV=a.extend({toHSV:a.color.self,toRGB:function(d){var h=d[0]*6,e=Math.floor(h),g=h-e,m=d[1],k=d[2]*255,j=d[3],c=Math.round(k*(1-m)),b=Math.round(k*(1-g*m)),l=Math.round(k*(1-(1-g)*m));
k=Math.round(k);switch(e%6){case 0:return[k,l,c,j];case 1:return[b,k,c,j];case 2:return[c,k,l,j];case 3:return[c,b,k,j];case 4:return[l,c,k,j];case 5:return[k,c,b,j]}},saturationV:function(b){return b[1]},value:function(b){return b[2]}},a.color.HueBased);a.color.RGB.toHSV=function(f){var k=f[0]/255,j=f[1]/255,e=f[2]/255,h=Math.min(k,j,e),c=Math.max(k,j,e),l=c-h;return[l===0?0:(j===c?(e-k)/l/6+(1/3):e===c?(k-j)/l/6+(2/3):(j-e)/l/6+1)%1,l===0?0:l/c,c,f[3]]};a.color.fns.push("HSV.toHSV","HSV.toRGB","RGB.toHSV","HSV.complementary","HSV.analogous","HSV.hue","HSV.saturationV","HSV.value","HSV.alpha")
})(jQuery));(jQuery.color&&(function(a){a.color.HSL=a.extend({toHSL:a.color.self,toRGB:function(d){var f=d[0],e=d[1],b=d[2],g=b<0.5?b*(1+e):b+e-(b*e),j=2*b-g;function k(c){var h=c<0?c+1:c>1?c-1:c;return h<1/6?j+(g-j)*6*h:h<1/2?g:h<2/3?j+(g-j)*6*(2/3-h):j}return[Math.round(255*k(f+1/3)),Math.round(255*k(f)),Math.round(255*k(f-1/3)),d[3]]},saturationL:function(b){return b[1]},lightness:function(b){return b[2]}},a.color.HueBased);a.color.RGB.toHSL=function(f){var k=f[0]/255,j=f[1]/255,e=f[2]/255,h=Math.min(k,j,e),c=Math.max(k,j,e),m=c-h,l=c+h;
return[m===0?0:(j===c?(e-k)/m/6+(1/3):e===c?(k-j)/m/6+(2/3):(j-e)/m/6+1)%1,m===0?0:l>1?m/(2-c-h):m/l,l/2,f[3]]};a.color.fns.push("HSL.toHSL","HSL.toRGB","RGB.toHSL","HSL.complementary","HSL.analogous","HSL.hue","HSL.saturationL","HSL.lightness","HSL.alpha")})(jQuery));(jQuery.color&&jQuery.Color||(function(a){a.Color=function(f,j,g){if(typeof this==="function"){return new a.Color(f,j,g)}if(typeof f==="string"&&a.color.parse){if(!g){g=f}f=a.color.parse(f)}if(f&&f.length){var h;h=this.length=f.length;
while(h--){this[h]=f[h]}}if(f){this.space=j||f.space||"RGB";this.name=g||f.name}};function c(f,l){var h=a.Color.isInstance(f)&&f.space!==this.space?this.to(f.space):new a.Color(this),k=h.length,j=false;while(k--){if(typeof f[k]==="number"){var g=l?h[k]+f[k]:f[k];if(g!==h[k]){h[k]=g;j=true}}}return j?h.setName():this}a.Color.fn=a.Color.prototype={color:"0.6",util:function(){return a.color[this.space]},to:function(f){return this["to"+f]()},fix:function(){return this.util().fix(this)},modify:function(f){return c.call(this,f)
},adjust:function(f){return c.call(this,f,true)},setName:function(f){this.name=f;return this},toString:function(){if(!this.space){return""}var f=this.util();return f.hasOwnProperty("toString")?f.toString(this):this.to("RGB").toString()},join:[].join,push:[].push};a.Color.isInstance=function(f){return f&&typeof f==="object"&&f.color===a.Color.fn.color&&f.space};a.Color.fnspace={};function e(g,h,j,k,f){return function(){var m=[g];Array.prototype.push.apply(m,arguments);var l=j.apply(h,m);return a.isArray(l)?new a.Color(l,k,f?g.name:undefined):l
}}function d(g,h){var f=/^to/.test(h)?h.substring(2):false;return function(){var l=this,k=l.util();if(!k[h]){l=l.to(a.Color.fnspace[h]);k=l.util()}var m=e(l,k,k[h],f||l.space,!!f),j=m.apply(l,arguments);if(f){this[h]=function(){return j};if(a.Color.isInstance(j)){l=this;j["to"+this.space]=function(){return l}}}else{this[h]=m}return j}}function b(){var g=this.split("."),f=g[1],h=g[0];if(!a.Color.fnspace[f]&&f!=="to"+h){a.Color.fnspace[f]=h}if(!a.Color.fn[f]){a.Color.fn[f]=d(this,f)}}a.each(a.color.fns,b);
a.color.fns.push=function(){a.each(arguments,b);return Array.prototype.push.apply(this,arguments)}})(jQuery));(jQuery.color&&(function(a){a.extend(a.color,{parse:function(c){var b;if(typeof c==="string"){if((b=/^\s*rgb(a)?\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*(?:,\s*([0-9]+(?:\.[0-9]+)?)\s*)?\)\s*$/.exec(c))&&!b[1]===!b[5]){return[parseInt(b[2],10),parseInt(b[3],10),parseInt(b[4],10),b[5]?parseFloat(b[5]):1]}if((b=/^\s*rgb(a)?\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*(?:,\s*([0-9]+(?:\.[0-9]+)?)\s*)?\)\s*$/.exec(c))&&!b[1]===!b[5]){return[parseFloat(b[2])*255/100,parseFloat(b[3])*255/100,parseFloat(b[4])*255/100,b[5]?parseFloat(b[5]):1]
}if((b=/^\s*#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})\s*$/.exec(c))){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),1]}if((b=/^\s*#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])\s*$/.exec(c))){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16),1]}if((b=/^\s*hsl(a)?\(\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*(?:,\s*([0-9]+(?:\.[0-9]+)?)\s*)?\)\s*$/.exec(c))&&!b[1]===!b[5]){return[parseInt(b[2],10)/360,parseFloat(b[3])/100,parseFloat(b[4])/100,b[5]?parseFloat(b[5]):1]
}return a.color.named(c)}if(c&&(c.length===3||c.length===4)){if(c.length===3){c.push(1)}return c}},named:function(c){var b;c=a.trim(c.toLowerCase());if(c==="transparent"){return[0,0,0,0]}a.each(a.color.palette,function(e,d){if(d[c]){b=d[c];return false}});return b}})})(jQuery));(jQuery.Color&&(function(a){a.Color.fn.related=function(d){var b=a.Color.fn.related.i18n,c=d||a.Color.fn.related.offset,e=Math.round(c*360)+b.deg;return{"anal-":this.analogous(-c).setName(b.anal+" -"+e),anal0:this.analogous().setName(b.orig),"anal+":this.analogous(c).setName(b.anal+" +"+e),"comp-":this.complementary(-c).setName(b.split+" -"+e),comp0:this.complementary().setName(b.comp),"comp+":this.complementary(c).setName(b.split+" +"+e),"triad-":this.analogous(-1/3).setName(b.triad+" -120"+b.deg),triad0:this.analogous().setName(b.orig),"triad+":this.analogous(1/3).setName(b.triad+" +120"+b.deg)}
};a.Color.fn.related.offset=30/360;a.Color.fn.related.i18n={deg:"Â°",anal:"Analogous",orig:"Original",split:"Split Complementary",comp:"Complementary",triad:"Triadic"}})(jQuery));(jQuery.color&&(function(a){a.color.palette.css3={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}
})(jQuery));(function(a){a.fn.cssColor=function(b){return a.Color(this.css(b))};a.Color.fn.applyCSS=function(b,c){a(b).css(c,this.toCSS());return this}})(jQuery);(function(e){function d(){this._settings=[];this._extensions=[];this.regional=[];this.regional[""]={errorLoadingText:"Error loading",notSupportedText:"This browser does not support SVG"};this.local=this.regional[""];this._uuid=new Date().getTime();this._renesis=c("RenesisX.RenesisCtrl")}function c(j){try{return !!(window.ActiveXObject&&new ActiveXObject(j))
}catch(k){return false}}var g="svgwrapper";e.extend(d.prototype,{markerClassName:"hasSVG",svgNS:"http://www.w3.org/2000/svg",xlinkNS:"http://www.w3.org/1999/xlink",_wrapperClass:b,_attrNames:{class_:"class",in_:"in",alignmentBaseline:"alignment-baseline",baselineShift:"baseline-shift",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorRendering:"color-rendering",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",underlinePosition:"underline-position",underlineThickness:"underline-thickness",vertAdvY:"vert-adv-y",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode"},_attachSVG:function(j,l){var k=(j.namespaceURI==this.svgNS?j:null);
var j=(k?null:j);if(e(j||k).hasClass(this.markerClassName)){return}if(typeof l=="string"){l={loadURL:l}}else{if(typeof l=="function"){l={onLoad:l}}}e(j||k).addClass(this.markerClassName);try{if(!k){k=document.createElementNS(this.svgNS,"svg");k.setAttribute("version","1.1");if(j.clientWidth>0){k.setAttribute("width",j.clientWidth)}if(j.clientHeight>0){k.setAttribute("height",j.clientHeight)}j.appendChild(k)}this._afterLoad(j,k,l||{})}catch(m){if(e.browser.msie){if(!j.id){j.id="svg"+(this._uuid++)
}this._settings[j.id]=l;j.innerHTML='<embed type="image/svg+xml" width="100%" height="100%" src="'+(l.initPath||"")+'blank.svg" pluginspage="http://www.adobe.com/svg/viewer/install/main.html"/>'}else{j.innerHTML='<p class="svg_error">'+this.local.notSupportedText+"</p>"}}},_registerSVG:function(){for(var l=0;l<document.embeds.length;l++){var j=document.embeds[l].parentNode;if(!e(j).hasClass(e.svg.markerClassName)||e.data(j,g)){continue}var k=null;try{k=document.embeds[l].getSVGDocument()}catch(m){setTimeout(e.svg._registerSVG,250);
return}k=(k?k.documentElement:null);if(k){e.svg._afterLoad(j,k)}}},_afterLoad:function(j,k,l){var l=l||this._settings[j.id];this._settings[j?j.id:""]=null;var n=new this._wrapperClass(k,j);e.data(j||k,g,n);try{if(l.loadURL){n.load(l.loadURL,l)}if(l.settings){n.configure(l.settings)}if(l.onLoad&&!l.loadURL){l.onLoad.apply(j||k,[n])}}catch(m){alert(m)}},_getSVG:function(j){j=(typeof j=="string"?e(j)[0]:(j.jquery?j[0]:j));return e.data(j,g)},_destroySVG:function(j){var k=e(j);if(!k.hasClass(this.markerClassName)){return
}k.removeClass(this.markerClassName);if(j.namespaceURI!=this.svgNS){k.empty()}e.removeData(j,g)},addExtension:function(k,j){this._extensions.push([k,j])},isSVGElem:function(j){return(j.nodeType==1&&j.namespaceURI==e.svg.svgNS)}});function b(k,j){this._svg=k;this._container=j;for(var l=0;l<e.svg._extensions.length;l++){var m=e.svg._extensions[l];this[m[0]]=new m[1](this)}}e.extend(b.prototype,{_width:function(){return(this._container?this._container.clientWidth:this._svg.width)},_height:function(){return(this._container?this._container.clientHeight:this._svg.height)
},root:function(){return this._svg},configure:function(o,n,k){if(!o.nodeName){k=n;n=o;o=this._svg}if(k){for(var m=o.attributes.length-1;m>=0;m--){var j=o.attributes.item(m);if(!(j.nodeName=="onload"||j.nodeName=="version"||j.nodeName.substring(0,5)=="xmlns")){o.attributes.removeNamedItem(j.nodeName)}}}for(var l in n){o.setAttribute(e.svg._attrNames[l]||l,n[l])}return this},getElementById:function(j){return this._svg.ownerDocument.getElementById(j)},change:function(k,l){if(k){for(var j in l){if(l[j]==null){k.removeAttribute(e.svg._attrNames[j]||j)
}else{k.setAttribute(e.svg._attrNames[j]||j,l[j])}}}return this},_args:function(k,n,j){n.splice(0,0,"parent");n.splice(n.length,0,"settings");var l={};var o=0;if(k[0]!=null&&k[0].jquery){k[0]=k[0][0]}if(k[0]!=null&&!(typeof k[0]=="object"&&k[0].nodeName)){l.parent=null;o=1}for(var m=0;m<k.length;m++){l[n[m+o]]=k[m]}if(j){e.each(j,function(p,q){if(typeof l[q]=="object"){l.settings=l[q];l[q]=null}})}return l},title:function(l,n,k){var j=this._args(arguments,["text"]);var m=this._makeNode(j.parent,"title",j.settings||{});
m.appendChild(this._svg.ownerDocument.createTextNode(j.text));return m},describe:function(l,n,k){var j=this._args(arguments,["text"]);var m=this._makeNode(j.parent,"desc",j.settings||{});m.appendChild(this._svg.ownerDocument.createTextNode(j.text));return m},defs:function(l,m,k){var j=this._args(arguments,["id"],["id"]);return this._makeNode(j.parent,"defs",e.extend((j.id?{id:j.id}:{}),j.settings||{}))},symbol:function(p,q,l,o,n,j,m){var k=this._args(arguments,["id","x1","y1","width","height"]);return this._makeNode(k.parent,"symbol",e.extend({id:k.id,viewBox:k.x1+" "+k.y1+" "+k.width+" "+k.height},k.settings||{}))
},marker:function(p,j,r,q,m,k,n,l){var o=this._args(arguments,["id","refX","refY","mWidth","mHeight","orient"],["orient"]);return this._makeNode(o.parent,"marker",e.extend({id:o.id,refX:o.refX,refY:o.refY,markerWidth:o.mWidth,markerHeight:o.mHeight,orient:o.orient||"auto"},o.settings||{}))},style:function(l,n,k){var j=this._args(arguments,["styles"]);var m=this._makeNode(j.parent,"style",e.extend({type:"text/css"},j.settings||{}));m.appendChild(this._svg.ownerDocument.createTextNode(j.styles));if(e.browser.opera){e("head").append('<style type="text/css">'+j.styles+"</style>")
}return m},script:function(n,j,m,l){var k=this._args(arguments,["script","type"],["type"]);var o=this._makeNode(k.parent,"script",e.extend({type:k.type||"text/javascript"},k.settings||{}));o.appendChild(this._svg.ownerDocument.createTextNode(k.script));if(!e.browser.mozilla){e.globalEval(k.script)}return o},linearGradient:function(r,k,s,l,q,j,p,m){var o=this._args(arguments,["id","stops","x1","y1","x2","y2"],["x1"]);var n=e.extend({id:o.id},(o.x1!=null?{x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2}:{}));return this._gradient(o.parent,"linearGradient",e.extend(n,o.settings||{}),o.stops)
},radialGradient:function(t,k,u,p,n,j,o,l,m){var s=this._args(arguments,["id","stops","cx","cy","r","fx","fy"],["cx"]);var q=e.extend({id:s.id},(s.cx!=null?{cx:s.cx,cy:s.cy,r:s.r,fx:s.fx,fy:s.fy}:{}));return this._gradient(s.parent,"radialGradient",e.extend(q,s.settings||{}),s.stops)},_gradient:function(n,j,m,p){var o=this._makeNode(n,j,m);for(var l=0;l<p.length;l++){var k=p[l];this._makeNode(o,"stop",e.extend({offset:k[0],stopColor:k[1]},(k[2]!=null?{stopOpacity:k[2]}:{})))}return o},pattern:function(t,j,s,q,k,u,r,p,m,v,l){var o=this._args(arguments,["id","x","y","width","height","vx","vy","vwidth","vheight"],["vx"]);
var n=e.extend({id:o.id,x:o.x,y:o.y,width:o.width,height:o.height},(o.vx!=null?{viewBox:o.vx+" "+o.vy+" "+o.vwidth+" "+o.vheight}:{}));return this._makeNode(o.parent,"pattern",e.extend(n,o.settings||{}))},clipPath:function(m,n,j,l){var k=this._args(arguments,["id","units"]);k.units=k.units||"userSpaceOnUse";return this._makeNode(k.parent,"clipPath",e.extend({id:k.id,clipPathUnits:k.units},k.settings||{}))},mask:function(o,q,k,p,n,j,m){var l=this._args(arguments,["id","x","y","width","height"]);return this._makeNode(l.parent,"mask",e.extend({id:l.id,x:l.x,y:l.y,width:l.width,height:l.height},l.settings||{}))
},createPath:function(){return new f()},createText:function(){return new h()},svg:function(s,r,p,j,t,q,o,l,u,k){var n=this._args(arguments,["x","y","width","height","vx","vy","vwidth","vheight"],["vx"]);var m=e.extend({x:n.x,y:n.y,width:n.width,height:n.height},(n.vx!=null?{viewBox:n.vx+" "+n.vy+" "+n.vwidth+" "+n.vheight}:{}));return this._makeNode(n.parent,"svg",e.extend(m,n.settings||{}))},group:function(l,m,k){var j=this._args(arguments,["id"],["id"]);return this._makeNode(j.parent,"g",e.extend({id:j.id},j.settings||{}))
},use:function(q,p,o,j,r,k,m){var n=this._args(arguments,["x","y","width","height","ref"]);if(typeof n.x=="string"){n.ref=n.x;n.settings=n.y;n.x=n.y=n.width=n.height=null}var l=this._makeNode(n.parent,"use",e.extend({x:n.x,y:n.y,width:n.width,height:n.height},n.settings||{}));l.setAttributeNS(e.svg.xlinkNS,"href",n.ref);return l},link:function(l,n,k){var j=this._args(arguments,["ref"]);var m=this._makeNode(j.parent,"a",j.settings);m.setAttributeNS(e.svg.xlinkNS,"href",j.ref);return m},image:function(q,p,o,j,r,k,m){var n=this._args(arguments,["x","y","width","height","ref"]);
var l=this._makeNode(n.parent,"image",e.extend({x:n.x,y:n.y,width:n.width,height:n.height},n.settings||{}));l.setAttributeNS(e.svg.xlinkNS,"href",n.ref);return l},path:function(l,m,k){var j=this._args(arguments,["path"]);return this._makeNode(j.parent,"path",e.extend({d:(j.path.path?j.path.path():j.path)},j.settings||{}))},rect:function(q,p,o,l,r,k,j,m){var n=this._args(arguments,["x","y","width","height","rx","ry"],["rx"]);return this._makeNode(n.parent,"rect",e.extend({x:n.x,y:n.y,width:n.width,height:n.height},(n.rx?{rx:n.rx,ry:n.ry}:{}),n.settings||{}))
},circle:function(m,j,o,n,l){var k=this._args(arguments,["cx","cy","r"]);return this._makeNode(k.parent,"circle",e.extend({cx:k.cx,cy:k.cy,r:k.r},k.settings||{}))},ellipse:function(m,j,p,o,n,l){var k=this._args(arguments,["cx","cy","rx","ry"]);return this._makeNode(k.parent,"ellipse",e.extend({cx:k.cx,cy:k.cy,rx:k.rx,ry:k.ry},k.settings||{}))},line:function(p,l,o,j,m,n){var k=this._args(arguments,["x1","y1","x2","y2"]);return this._makeNode(k.parent,"line",e.extend({x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2},k.settings||{}))
},polyline:function(m,l,k){var j=this._args(arguments,["points"]);return this._poly(j.parent,"polyline",j.points,j.settings)},polygon:function(m,l,k){var j=this._args(arguments,["points"]);return this._poly(j.parent,"polygon",j.points,j.settings)},_poly:function(n,j,m,l){var o="";for(var k=0;k<m.length;k++){o+=m[k].join()+" "}return this._makeNode(n,j,e.extend({points:e.trim(o)},l||{}))},text:function(m,j,o,n,l){var k=this._args(arguments,["x","y","value"]);if(typeof k.x=="string"&&arguments.length<4){k.value=k.x;
k.settings=k.y;k.x=k.y=null}return this._text(k.parent,"text",k.value,e.extend({x:(k.x&&a(k.x)?k.x.join(" "):k.x),y:(k.y&&a(k.y)?k.y.join(" "):k.y)},k.settings||{}))},textpath:function(l,o,n,k){var j=this._args(arguments,["path","value"]);var m=this._text(j.parent,"textPath",j.value,j.settings||{});m.setAttributeNS(e.svg.xlinkNS,"href",j.path);return m},_text:function(r,j,q,n){var m=this._makeNode(r,j,n);if(typeof q=="string"){m.appendChild(m.ownerDocument.createTextNode(q))}else{for(var o=0;o<q._parts.length;
o++){var l=q._parts[o];if(l[0]=="tspan"){var k=this._makeNode(m,l[0],l[2]);k.appendChild(m.ownerDocument.createTextNode(l[1]));m.appendChild(k)}else{if(l[0]=="tref"){var k=this._makeNode(m,l[0],l[2]);k.setAttributeNS(e.svg.xlinkNS,"href",l[1]);m.appendChild(k)}else{if(l[0]=="textpath"){var p=e.extend({},l[2]);p.href=null;var k=this._makeNode(m,l[0],p);k.setAttributeNS(e.svg.xlinkNS,"href",l[2].href);k.appendChild(m.ownerDocument.createTextNode(l[1]));m.appendChild(k)}else{m.appendChild(m.ownerDocument.createTextNode(l[1]))
}}}}}return m},other:function(m,k,l){var j=this._args(arguments,["name"]);return this._makeNode(j.parent,j.name,j.settings||{})},_makeNode:function(l,j,k){l=l||this._svg;var m=this._svg.ownerDocument.createElementNS(e.svg.svgNS,j);for(var j in k){var n=k[j];if(n!=null&&n!=null&&(typeof n!="string"||n!="")){m.setAttribute(e.svg._attrNames[j]||j,n)}}l.appendChild(m);return m},add:function(l,m){var k=this._args((arguments.length==1?[null,l]:arguments),["node"]);var j=this;k.parent=k.parent||this._svg;
k.node=(k.node.jquery?k.node:e(k.node));try{if(e.svg._renesis){throw"Force traversal"}k.parent.appendChild(k.node.cloneNode(true))}catch(n){k.node.each(function(){var o=j._cloneAsSVG(this);if(o){k.parent.appendChild(o)}})}return this},clone:function(m,n){var j=this;var l=this._args((arguments.length==1?[null,m]:arguments),["node"]);l.parent=l.parent||this._svg;l.node=(l.node.jquery?l.node:e(l.node));var k=[];l.node.each(function(){var o=j._cloneAsSVG(this);if(o){o.id="";l.parent.appendChild(o);k.push(o)
}});return k},_cloneAsSVG:function(m){var l=null;if(m.nodeType==1){l=this._svg.ownerDocument.createElementNS(e.svg.svgNS,this._checkName(m.nodeName));for(var k=0;k<m.attributes.length;k++){var j=m.attributes.item(k);if(j.nodeName!="xmlns"&&j.nodeValue){if(j.prefix=="xlink"){l.setAttributeNS(e.svg.xlinkNS,j.localName||j.baseName,j.nodeValue)}else{l.setAttribute(this._checkName(j.nodeName),j.nodeValue)}}}for(var k=0;k<m.childNodes.length;k++){var o=this._cloneAsSVG(m.childNodes[k]);if(o){l.appendChild(o)
}}}else{if(m.nodeType==3){if(e.trim(m.nodeValue)){l=this._svg.ownerDocument.createTextNode(m.nodeValue)}}else{if(m.nodeType==4){if(e.trim(m.nodeValue)){try{l=this._svg.ownerDocument.createCDATASection(m.nodeValue)}catch(n){l=this._svg.ownerDocument.createTextNode(m.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}}}}}return l},_checkName:function(j){j=(j.substring(0,1)>="A"&&j.substring(0,1)<="Z"?j.toLowerCase():j);return(j.substring(0,4)=="svg:"?j.substring(4):j)},load:function(j,m){m=(typeof m=="boolean"?{addTo:m}:(typeof m=="function"?{onLoad:m}:(typeof m=="string"?{parent:m}:(typeof m=="object"&&m.nodeName?{parent:m}:(typeof m=="object"&&m.jquery?{parent:m}:m||{})))));
if(!m.parent&&!m.addTo){this.clear(false)}var k=[this._svg.getAttribute("width"),this._svg.getAttribute("height")];var p=this;var o=function(q){q=e.svg.local.errorLoadingText+": "+q;if(m.onLoad){m.onLoad.apply(p._container||p._svg,[p,q])}else{p.text(null,10,20,q)}};var n=function(r){var q=new ActiveXObject("Microsoft.XMLDOM");q.validateOnParse=false;q.resolveExternals=false;q.async=false;q.loadXML(r);if(q.parseError.errorCode!=0){o(q.parseError.reason);return null}return q};var l=function(s){if(!s){return
}if(s.documentElement.nodeName!="svg"){var w=s.getElementsByTagName("parsererror");var r=(w.length?w[0].getElementsByTagName("div"):[]);o(!w.length?"???":(r.length?r[0]:w[0]).firstChild.nodeValue);return}var x=(m.parent?e(m.parent)[0]:p._svg);var y={};for(var t=0;t<s.documentElement.attributes.length;t++){var v=s.documentElement.attributes.item(t);if(!(v.nodeName=="version"||v.nodeName.substring(0,5)=="xmlns")){y[v.nodeName]=v.nodeValue}}p.configure(x,y,!m.parent);var q=s.documentElement.childNodes;
for(var t=0;t<q.length;t++){try{if(e.svg._renesis){throw"Force traversal"}x.appendChild(p._svg.ownerDocument.importNode(q[t],true));if(q[t].nodeName=="script"){e.globalEval(q[t].textContent)}}catch(u){p.add(x,q[t])}}if(!m.changeSize){p.configure(x,{width:k[0],height:k[1]})}if(m.onLoad){m.onLoad.apply(p._container||p._svg,[p])}};if(j.match("<svg")){l(e.browser.msie?n(j):new DOMParser().parseFromString(j,"text/xml"))}else{e.ajax({url:j,dataType:(e.browser.msie?"text":"xml"),success:function(q){l(e.browser.msie?n(q):q)
},error:function(r,s,q){o(s+(q?" "+q.message:""))}})}return this},remove:function(j){j=(j.jquery?j[0]:j);j.parentNode.removeChild(j);return this},clear:function(j){if(j){this.configure({},true)}while(this._svg.firstChild){this._svg.removeChild(this._svg.firstChild)}return this},toSVG:function(j){j=j||this._svg;return(typeof XMLSerializer=="undefined"?this._toSVG(j):new XMLSerializer().serializeToString(j))},_toSVG:function(m){var l="";if(!m){return l}if(m.nodeType==3){l=m.nodeValue}else{if(m.nodeType==4){l="<![CDATA["+m.nodeValue+"]]>"
}else{l="<"+m.nodeName;if(m.attributes){for(var k=0;k<m.attributes.length;k++){var j=m.attributes.item(k);if(!(e.trim(j.nodeValue)==""||j.nodeValue.match(/^\[object/)||j.nodeValue.match(/^function/))){l+=" "+(j.namespaceURI==e.svg.xlinkNS?"xlink:":"")+j.nodeName+'="'+j.nodeValue+'"'}}}if(m.firstChild){l+=">";var n=m.firstChild;while(n){l+=this._toSVG(n);n=n.nextSibling}l+="</"+m.nodeName+">"}else{l+="/>"}}}return l}});function f(){this._path=""}e.extend(f.prototype,{reset:function(){this._path="";
return this},move:function(j,l,k){k=(a(j)?l:k);return this._coords((k?"m":"M"),j,l)},line:function(j,l,k){k=(a(j)?l:k);return this._coords((k?"l":"L"),j,l)},horiz:function(j,k){this._path+=(k?"h":"H")+(a(j)?j.join(" "):j);return this},vert:function(k,j){this._path+=(j?"v":"V")+(a(k)?k.join(" "):k);return this},curveC:function(l,n,k,m,j,p,o){o=(a(l)?n:o);return this._coords((o?"c":"C"),l,n,k,m,j,p)},smoothC:function(k,l,j,n,m){m=(a(k)?l:m);return this._coords((m?"s":"S"),k,l,j,n)},curveQ:function(k,l,j,n,m){m=(a(k)?l:m);
return this._coords((m?"q":"Q"),k,l,j,n)},smoothQ:function(j,l,k){k=(a(j)?l:k);return this._coords((k?"t":"T"),j,l)},_coords:function(m,l,r,k,q,j,p){if(a(l)){for(var n=0;n<l.length;n++){var o=l[n];this._path+=(n==0?m:" ")+o[0]+","+o[1]+(o.length<4?"":" "+o[2]+","+o[3]+(o.length<6?"":" "+o[4]+","+o[5]))}}else{this._path+=m+l+","+r+(k==null?"":" "+k+","+q+(j==null?"":" "+j+","+p))}return this},arc:function(m,j,p,s,l,r,q,k){k=(a(m)?j:k);this._path+=(k?"a":"A");if(a(m)){for(var n=0;n<m.length;n++){var o=m[n];
this._path+=(n==0?"":" ")+o[0]+","+o[1]+" "+o[2]+" "+(o[3]?"1":"0")+","+(o[4]?"1":"0")+" "+o[5]+","+o[6]}}else{this._path+=m+","+j+" "+p+" "+(s?"1":"0")+","+(l?"1":"0")+" "+r+","+q}return this},close:function(){this._path+="z";return this},path:function(){return this._path}});f.prototype.moveTo=f.prototype.move;f.prototype.lineTo=f.prototype.line;f.prototype.horizTo=f.prototype.horiz;f.prototype.vertTo=f.prototype.vert;f.prototype.curveCTo=f.prototype.curveC;f.prototype.smoothCTo=f.prototype.smoothC;
f.prototype.curveQTo=f.prototype.curveQ;f.prototype.smoothQTo=f.prototype.smoothQ;f.prototype.arcTo=f.prototype.arc;function h(){this._parts=[]}e.extend(h.prototype,{reset:function(){this._parts=[];return this},string:function(j){this._parts[this._parts.length]=["text",j];return this},span:function(k,j){this._parts[this._parts.length]=["tspan",k,j];return this},ref:function(k,j){this._parts[this._parts.length]=["tref",k,j];return this},path:function(l,k,j){this._parts[this._parts.length]=["textpath",k,e.extend({href:l},j||{})];
return this}});e.fn.svg=function(k){var j=Array.prototype.slice.call(arguments,1);if(typeof k=="string"&&k=="get"){return e.svg["_"+k+"SVG"].apply(e.svg,[this[0]].concat(j))}return this.each(function(){if(typeof k=="string"){e.svg["_"+k+"SVG"].apply(e.svg,[this].concat(j))}else{e.svg._attachSVG(this,k||{})}})};function a(j){return(j&&j.constructor==Array)}e.svg=new d()})(jQuery);Array.prototype.foreach=function(b){for(var a=0;a<this.length;a++){b(this[a])}};Array.prototype.map=function(c){var a=new Array();
for(var b=0;b<this.length;b++){a.push(c(this[b]))}return a};Array.prototype.min=function(){var b=this[0];for(var a=0;a<this.length;a++){if(this[a]<b){b=this[a]}}return b};Array.prototype.max=function(){var a=this[0];for(var b=0;b<this.length;b++){if(this[b]>a){a=this[b]}}return a};AntiZoomAndPan.VERSION="1.2";function AntiZoomAndPan(){this.init()}AntiZoomAndPan.prototype.init=function(){var a=svgDocument.documentElement;this.svgNodes=new Array();this.x_trans=0;this.y_trans=0;this.scale=1;this.lastTM=a.createSVGMatrix();
a.addEventListener("SVGZoom",this,false);a.addEventListener("SVGScroll",this,false);a.addEventListener("SVGResize",this,false)};AntiZoomAndPan.prototype.appendNode=function(a){this.svgNodes.push(a)};AntiZoomAndPan.prototype.removeNode=function(b){for(var a=0;a<this.svgNodes.length;a++){if(this.svgNodes[a]===b){this.svgNodes.splice(a,1);break}}};AntiZoomAndPan.prototype.handleEvent=function(b){var a=b.type;if(this[a]==null){throw new Error("Unsupported event type: "+a)}this[a](b)};AntiZoomAndPan.prototype.SVGZoom=function(a){this.update()
};AntiZoomAndPan.prototype.SVGScroll=function(a){this.update()};AntiZoomAndPan.prototype.SVGResize=function(a){this.update()};AntiZoomAndPan.prototype.update=function(){if(this.svgNodes.length>0){var a=svgDocument.documentElement;var c=(window.ViewBox!=null)?new ViewBox(a):null;var b=(c!=null)?c.getTM():a.createSVGMatrix();var f=a.currentTranslate;b=b.scale(1/a.currentScale);b=b.translate(-f.x,-f.y);for(var e=0;e<this.svgNodes.length;e++){var g=this.svgNodes[e];var h=b.multiply(this.lastTM.multiply(g.getCTM()));
var d="matrix("+[h.a,h.b,h.c,h.d,h.e,h.f].join(",")+")";this.svgNodes[e].setAttributeNS(null,"transform",d)}this.lastTM=b.inverse()}};EventHandler.VERSION=1;function EventHandler(){this.init()}EventHandler.prototype.init=function(){};EventHandler.prototype.handleEvent=function(a){if(this[a.type]==null){throw new Error("Unsupported event type: "+a.type)}this[a.type](a)};var svgns="http://www.w3.org/2000/svg";Mouser.prototype=new EventHandler();Mouser.prototype.constructor=Mouser;Mouser.superclass=EventHandler.prototype;
function Mouser(){this.init()}Mouser.prototype.init=function(){this.svgNode=null;this.handles=new Array();this.shapes=new Array();this.lastPoint=null;this.currentNode=null;this.realize()};Mouser.prototype.realize=function(){if(this.svgNode==null){var a=svgDocument.createElementNS(svgns,"rect");this.svgNode=a;a.setAttributeNS(null,"x","-32767");a.setAttributeNS(null,"y","-32767");a.setAttributeNS(null,"width","65535");a.setAttributeNS(null,"height","65535");a.setAttributeNS(null,"fill","none");a.setAttributeNS(null,"pointer-events","all");
a.setAttributeNS(null,"display","none");svgDocument.documentElement.appendChild(a)}};Mouser.prototype.register=function(b){if(this.handleIndex(b)==-1){var a=b.owner;b.select(true);this.handles.push(b);if(a!=null&&this.shapeIndex(a)==-1){this.shapes.push(a)}}};Mouser.prototype.unregister=function(b){var a=this.handleIndex(b);if(a!=-1){b.select(false);this.handles.splice(a,1)}};Mouser.prototype.registerShape=function(a){if(this.shapeIndex(a)==-1){a.select(true);this.shapes.push(a)}};Mouser.prototype.unregisterShape=function(a){var b=this.shapeIndex(a);
if(b!=-1){a.select(false);a.selectHandles(false);a.showHandles(false);a.unregisterHandles();this.shapes.splice(b,1)}};Mouser.prototype.unregisterAll=function(){for(var a=0;a<this.handles.length;a++){this.handles[a].select(false)}this.handles=new Array()};Mouser.prototype.unregisterShapes=function(){for(var b=0;b<this.shapes.length;b++){var a=this.shapes[b];a.select(false);a.selectHandles(false);a.showHandles(false);a.unregisterHandles()}this.shapes=new Array()};Mouser.prototype.handleIndex=function(c){var a=-1;
for(var b=0;b<this.handles.length;b++){if(this.handles[b]===c){a=b;break}}return a};Mouser.prototype.shapeIndex=function(b){var a=-1;for(var c=0;c<this.shapes.length;c++){if(this.shapes[c]===b){a=c;break}}return a};Mouser.prototype.beginDrag=function(b){this.currentNode=b.target;var a=this.getUserCoordinate(this.currentNode,b.clientX,b.clientY);this.lastPoint=new Point2D(a.x,a.y);this.svgNode.addEventListener("mouseup",this,false);this.svgNode.addEventListener("mousemove",this,false);svgDocument.documentElement.appendChild(this.svgNode);
this.svgNode.setAttributeNS(null,"display","inline")};Mouser.prototype.mouseup=function(a){this.lastPoint=null;this.currentNode=null;this.svgNode.removeEventListener("mouseup",this,false);this.svgNode.removeEventListener("mousemove",this,false);this.svgNode.setAttributeNS(null,"display","none")};Mouser.prototype.mousemove=function(g){var d=this.getUserCoordinate(this.currentNode,g.clientX,g.clientY);var b=new Point2D(d.x,d.y);var j=b.subtract(this.lastPoint);var h=new Array();var k=new Date().getTime();
this.lastPoint.setFromPoint(b);for(var c=0;c<this.handles.length;c++){var f=this.handles[c];var a=f.owner;f.translate(j);if(a!=null){if(a.lastUpdate!=k){a.lastUpdate=k;h.push(a)}}else{h.push(f)}}for(var c=0;c<h.length;c++){h[c].update()}};Mouser.prototype.getUserCoordinate=function(a,e,d){var g=svgDocument.documentElement;var f=g.getCurrentTranslate();var h=g.getCurrentScale();var j=this.getTransformToElement(a);var c=j.inverse();var b=svgDocument.documentElement.createSVGPoint();b.x=(e-f.x)/h;b.y=(d-f.y)/h;
return b.matrixTransform(c)};Mouser.prototype.getTransformToElement=function(a){var b=a.getCTM();while((a=a.parentNode)!=svgDocument){b=a.getCTM().multiply(b)}return b};ViewBox.VERSION="1.0";function ViewBox(a){if(arguments.length>0){this.init(a)}}ViewBox.prototype.init=function(a){var d=a.getAttributeNS(null,"viewBox");var c=a.getAttributeNS(null,"preserveAspectRatio");if(d!=""){var b=d.split(/\s*,\s*|\s+/);this.x=parseFloat(b[0]);this.y=parseFloat(b[1]);this.width=parseFloat(b[2]);this.height=parseFloat(b[3])
}else{this.x=0;this.y=0;this.width=innerWidth;this.height=innerHeight}this.setPAR(c)};ViewBox.prototype.getTM=function(){var k=svgDocument.documentElement;var h=svgDocument.documentElement.createSVGMatrix();var c=k.getAttributeNS(null,"width");var a=k.getAttributeNS(null,"height");c=(c!="")?parseFloat(c):innerWidth;a=(a!="")?parseFloat(a):innerHeight;var g=this.width/c;var e=this.height/a;h=h.translate(this.x,this.y);if(this.alignX=="none"){h=h.scaleNonUniform(g,e)}else{if(g<e&&this.meetOrSlice=="meet"||g>e&&this.meetOrSlice=="slice"){var b=0;
var d=c*e-this.width;if(this.alignX=="Mid"){b=-d/2}else{if(this.alignX=="Max"){b=-d}}h=h.translate(b,0);h=h.scale(e)}else{if(g>e&&this.meetOrSlice=="meet"||g<e&&this.meetOrSlice=="slice"){var j=0;var f=a*g-this.height;if(this.alignY=="Mid"){j=-f/2}else{if(this.alignY=="Max"){j=-f}}h=h.translate(0,j);h=h.scale(g)}else{h=h.scale(g)}}}return h};ViewBox.prototype.setPAR=function(a){if(a){var b=a.split(/\s+/);var c=b[0];if(c=="none"){this.alignX="none";this.alignY="none"}else{this.alignX=c.substring(1,4);
this.alignY=c.substring(5,9)}if(b.length==2){this.meetOrSlice=b[1]}else{this.meetOrSlice="meet"}}else{this.align="xMidYMid";this.alignX="Mid";this.alignY="Mid";this.meetOrSlice="meet"}};function Intersection(a){if(arguments.length>0){this.init(a)}}Intersection.prototype.init=function(a){this.status=a;this.points=new Array()};Intersection.prototype.appendPoint=function(a){this.points.push(a)};Intersection.prototype.appendPoints=function(a){this.points=this.points.concat(a)};Intersection.intersectShapes=function(c,b){var e=c.getIntersectionParams();
var d=b.getIntersectionParams();var a;if(e!=null&&d!=null){if(e.name=="Path"){a=Intersection.intersectPathShape(c,b)}else{if(d.name=="Path"){a=Intersection.intersectPathShape(b,c)}else{var g;var f;if(e.name<d.name){g="intersect"+e.name+d.name;f=e.params.concat(d.params)}else{g="intersect"+d.name+e.name;f=d.params.concat(e.params)}if(!(g in Intersection)){throw new Error("Intersection not available: "+g)}a=Intersection[g].apply(null,f)}}}else{a=new Intersection("No Intersection")}return a};Intersection.intersectPathShape=function(b,a){return b.intersectShape(a)
};Intersection.intersectBezier2Bezier2=function(O,M,L,o,m,l){var K,J;var q,r,t;var z,B,D;var w=0.0001;var v=new Intersection("No Intersection");K=M.multiply(-2);q=O.add(K.add(L));K=O.multiply(-2);J=M.multiply(2);r=K.add(J);t=new Point2D(O.x,O.y);K=m.multiply(-2);z=o.add(K.add(l));K=o.multiply(-2);J=m.multiply(2);B=K.add(J);D=new Point2D(o.x,o.y);var K=q.x*r.y-r.x*q.y;var J=z.x*r.y-r.x*z.y;var I=B.x*r.y-r.x*B.y;var H=r.x*(t.y-D.y)+r.y*(-t.x+D.x);var G=z.x*q.y-q.x*z.y;var F=B.x*q.y-q.x*B.y;var E=q.x*(t.y-D.y)+q.y*(-t.x+D.x);
var h=new Polynomial(-G*G,-2*G*F,K*J-F*F-2*G*E,K*I-2*F*E,K*H-E*E);var n=h.getRoots();for(var C=0;C<n.length;C++){var x=n[C];if(0<=x&&x<=1){var p=new Polynomial(-q.x,-r.x,-t.x+D.x+x*B.x+x*x*z.x).getRoots();var u=new Polynomial(-q.y,-r.y,-t.y+D.y+x*B.y+x*x*z.y).getRoots();if(p.length>0&&u.length>0){checkRoots:for(var A=0;A<p.length;A++){var N=p[A];if(0<=N&&N<=1){for(var y=0;y<u.length;y++){if(Math.abs(N-u[y])<w){v.points.push(z.multiply(x*x).add(B.multiply(x).add(D)));break checkRoots}}}}}}}return v
};Intersection.intersectBezier2Bezier3=function(O,N,M,x,w,v,u){var Y,X,W,U;var e,f,g;var F,G,H,I;var q=new Intersection("No Intersection");Y=N.multiply(-2);e=O.add(Y.add(M));Y=O.multiply(-2);X=N.multiply(2);f=Y.add(X);g=new Point2D(O.x,O.y);Y=x.multiply(-1);X=w.multiply(3);W=v.multiply(-3);U=Y.add(X.add(W.add(u)));F=new Vector2D(U.x,U.y);Y=x.multiply(3);X=w.multiply(-6);W=v.multiply(3);U=Y.add(X.add(W));G=new Vector2D(U.x,U.y);Y=x.multiply(-3);X=w.multiply(3);W=Y.add(X);H=new Vector2D(W.x,W.y);I=new Vector2D(x.x,x.y);
var K=g.x*g.x;var t=g.y*g.y;var E=f.x*f.x;var o=f.y*f.y;var A=e.x*e.x;var n=e.y*e.y;var m=I.x*I.x;var Q=I.y*I.y;var h=H.x*H.x;var J=H.y*H.y;var V=G.x*G.x;var C=G.y*G.y;var P=F.x*F.x;var y=F.y*F.y;var B=new Polynomial(-2*e.x*e.y*F.x*F.y+A*y+n*P,-2*e.x*e.y*G.x*F.y-2*e.x*e.y*G.y*F.x+2*n*G.x*F.x+2*A*G.y*F.y,-2*e.x*H.x*e.y*F.y-2*e.x*e.y*H.y*F.x-2*e.x*e.y*G.x*G.y+2*H.x*n*F.x+n*V+A*(2*H.y*F.y+C),2*g.x*e.x*e.y*F.y+2*g.y*e.x*e.y*F.x+f.x*f.y*e.x*F.y+f.x*f.y*e.y*F.x-2*I.x*e.x*e.y*F.y-2*e.x*I.y*e.y*F.x-2*e.x*H.x*e.y*G.y-2*e.x*e.y*H.y*G.x-2*g.x*n*F.x-2*g.y*A*F.y+2*I.x*n*F.x+2*H.x*n*G.x-o*e.x*F.x-E*e.y*F.y+A*(2*I.y*F.y+2*H.y*G.y),2*g.x*e.x*e.y*G.y+2*g.y*e.x*e.y*G.x+f.x*f.y*e.x*G.y+f.x*f.y*e.y*G.x-2*I.x*e.x*e.y*G.y-2*e.x*I.y*e.y*G.x-2*e.x*H.x*e.y*H.y-2*g.x*n*G.x-2*g.y*A*G.y+2*I.x*n*G.x-o*e.x*G.x-E*e.y*G.y+h*n+A*(2*I.y*G.y+J),2*g.x*e.x*e.y*H.y+2*g.y*e.x*H.x*e.y+f.x*f.y*e.x*H.y+f.x*f.y*H.x*e.y-2*I.x*e.x*e.y*H.y-2*e.x*I.y*H.x*e.y-2*g.x*H.x*n-2*g.y*A*H.y+2*I.x*H.x*n-o*e.x*H.x-E*e.y*H.y+2*A*I.y*H.y,-2*g.x*g.y*e.x*e.y-g.x*f.x*f.y*e.y-g.y*f.x*f.y*e.x+2*g.x*e.x*I.y*e.y+2*g.y*I.x*e.x*e.y+f.x*I.x*f.y*e.y+f.x*f.y*e.x*I.y-2*I.x*e.x*I.y*e.y-2*g.x*I.x*n+g.x*o*e.x+g.y*E*e.y-2*g.y*A*I.y-I.x*o*e.x-E*I.y*e.y+K*n+t*A+m*n+A*Q);
var r=B.getRootsInInterval(0,1);for(var T=0;T<r.length;T++){var L=r[T];var l=new Polynomial(e.x,f.x,g.x-I.x-L*H.x-L*L*G.x-L*L*L*F.x).getRoots();var D=new Polynomial(e.y,f.y,g.y-I.y-L*H.y-L*L*G.y-L*L*L*F.y).getRoots();if(l.length>0&&D.length>0){var p=0.0001;checkRoots:for(var S=0;S<l.length;S++){var z=l[S];if(0<=z&&z<=1){for(var R=0;R<D.length;R++){if(Math.abs(z-D[R])<p){q.points.push(F.multiply(L*L*L).add(G.multiply(L*L).add(H.multiply(L).add(I))));break checkRoots}}}}}}if(q.points.length>0){q.status="Intersection"
}return q};Intersection.intersectBezier2Circle=function(e,d,b,f,a){return Intersection.intersectBezier2Ellipse(e,d,b,f,a,a)};Intersection.intersectBezier2Ellipse=function(r,p,o,k,d,c){var n,m;var e,g,j;var u=new Intersection("No Intersection");n=p.multiply(-2);e=r.add(n.add(o));n=r.multiply(-2);m=p.multiply(2);g=n.add(m);j=new Point2D(r.x,r.y);var h=d*d;var l=c*c;var q=new Polynomial(l*e.x*e.x+h*e.y*e.y,2*(l*e.x*g.x+h*e.y*g.y),l*(2*e.x*j.x+g.x*g.x)+h*(2*e.y*j.y+g.y*g.y)-2*(l*k.x*e.x+h*k.y*e.y),2*(l*g.x*(j.x-k.x)+h*g.y*(j.y-k.y)),l*(j.x*j.x+k.x*k.x)+h*(j.y*j.y+k.y*k.y)-2*(l*k.x*j.x+h*k.y*j.y)-h*l).getRoots();
for(var f=0;f<q.length;f++){var s=q[f];if(0<=s&&s<=1){u.points.push(e.multiply(s*s).add(g.multiply(s).add(j)))}}if(u.points.length>0){u.status="Intersection"}return u};Intersection.intersectBezier2Line=function(f,e,d,x,v){var u,s;var k,l,o;var g;var m;var p=x.min(v);var q=x.max(v);var h=new Intersection("No Intersection");u=e.multiply(-2);k=f.add(u.add(d));u=f.multiply(-2);s=e.multiply(2);l=u.add(s);o=new Point2D(f.x,f.y);m=new Vector2D(x.y-v.y,v.x-x.x);g=x.x*v.y-v.x*x.y;roots=new Polynomial(m.dot(k),m.dot(l),m.dot(o)+g).getRoots();
for(var r=0;r<roots.length;r++){var j=roots[r];if(0<=j&&j<=1){var c=f.lerp(e,j);var y=e.lerp(d,j);var w=c.lerp(y,j);if(x.x==v.x){if(p.y<=w.y&&w.y<=q.y){h.status="Intersection";h.appendPoint(w)}}else{if(x.y==v.y){if(p.x<=w.x&&w.x<=q.x){h.status="Intersection";h.appendPoint(w)}}else{if(w.gte(p)&&w.lte(q)){h.status="Intersection";h.appendPoint(w)}}}}}return h};Intersection.intersectBezier2Polygon=function(j,g,f,h){var k=new Intersection("No Intersection");var c=h.length;for(var e=0;e<c;e++){var b=h[e];
var a=h[(e+1)%c];var d=Intersection.intersectBezier2Line(j,g,f,b,a);k.appendPoints(d.points)}if(k.points.length>0){k.status="Intersection"}return k};Intersection.intersectBezier2Rectangle=function(n,m,l,b,a){var d=b.min(a);var k=b.max(a);var c=new Point2D(k.x,d.y);var j=new Point2D(d.x,k.y);var h=Intersection.intersectBezier2Line(n,m,l,d,c);var g=Intersection.intersectBezier2Line(n,m,l,c,k);var f=Intersection.intersectBezier2Line(n,m,l,k,j);var e=Intersection.intersectBezier2Line(n,m,l,j,d);var o=new Intersection("No Intersection");
o.appendPoints(h.points);o.appendPoints(g.points);o.appendPoints(f.points);o.appendPoints(e.points);if(o.points.length>0){o.status="Intersection"}return o};Intersection.intersectBezier3Bezier3=function(ae,ac,ab,aa,I,G,F,E){var aq,ap,ao,am;var e,f,g,h;var S,T,U,V;var y=new Intersection("No Intersection");aq=ae.multiply(-1);ap=ac.multiply(3);ao=ab.multiply(-3);am=aq.add(ap.add(ao.add(aa)));e=new Vector2D(am.x,am.y);aq=ae.multiply(3);ap=ac.multiply(-6);ao=ab.multiply(3);am=aq.add(ap.add(ao));f=new Vector2D(am.x,am.y);
aq=ae.multiply(-3);ap=ac.multiply(3);ao=aq.add(ap);g=new Vector2D(ao.x,ao.y);h=new Vector2D(ae.x,ae.y);aq=I.multiply(-1);ap=G.multiply(3);ao=F.multiply(-3);am=aq.add(ap.add(ao.add(E)));S=new Vector2D(am.x,am.y);aq=I.multiply(3);ap=G.multiply(-6);ao=F.multiply(3);am=aq.add(ap.add(ao));T=new Vector2D(am.x,am.y);aq=I.multiply(-3);ap=G.multiply(3);ao=aq.add(ap);U=new Vector2D(ao.x,ao.y);V=new Vector2D(I.x,I.y);var Y=h.x*h.x;var X=h.x*h.x*h.x;var D=h.y*h.y;var B=h.y*h.y*h.y;var R=g.x*g.x;var Q=g.x*g.x*g.x;
var w=g.y*g.y;var v=g.y*g.y*g.y;var M=f.x*f.x;var L=f.x*f.x*f.x;var u=f.y*f.y;var t=f.y*f.y*f.y;var A=e.x*e.x;var z=e.x*e.x*e.x;var o=e.y*e.y;var n=e.y*e.y*e.y;var r=V.x*V.x;var q=V.x*V.x*V.x;var ah=V.y*V.y;var ag=V.y*V.y*V.y;var m=U.x*U.x;var l=U.x*U.x*U.x;var W=U.y*U.y;var an=T.x*T.x;var al=T.x*T.x*T.x;var O=T.y*T.y;var af=S.x*S.x;var ad=S.x*S.x*S.x;var J=S.y*S.y;var H=S.y*S.y*S.y;var N=new Polynomial(-z*H+n*ad-3*e.x*o*af*S.y+3*A*e.y*S.x*J,-6*e.x*T.x*o*S.x*S.y+6*A*e.y*T.y*S.x*S.y+3*T.x*n*af-3*z*T.y*J-3*e.x*o*T.y*af+3*A*T.x*e.y*J,-6*U.x*e.x*o*S.x*S.y-6*e.x*T.x*o*T.y*S.x+6*A*T.x*e.y*T.y*S.y+3*U.x*n*af+3*an*n*S.x+3*U.x*A*e.y*J-3*e.x*U.y*o*af-3*e.x*an*o*S.y+A*e.y*S.x*(6*U.y*S.y+3*O)+z*(-U.y*J-2*O*S.y-S.y*(2*U.y*S.y+O)),g.x*f.y*e.x*e.y*S.x*S.y-g.y*f.x*e.x*e.y*S.x*S.y+6*U.x*T.x*n*S.x+3*g.x*f.x*e.x*e.y*J+6*h.x*e.x*o*S.x*S.y-3*g.x*f.x*o*S.x*S.y-3*g.y*f.y*e.x*e.y*af-6*h.y*A*e.y*S.x*S.y-6*V.x*e.x*o*S.x*S.y+3*g.y*f.y*A*S.x*S.y-2*f.x*u*e.x*S.x*S.y-6*U.x*e.x*T.x*o*S.y-6*U.x*e.x*o*T.y*S.x-6*e.x*U.y*T.x*o*S.x+6*U.x*A*e.y*T.y*S.y+2*M*f.y*e.y*S.x*S.y+al*n-3*h.x*n*af+3*h.y*z*J+3*V.x*n*af+t*e.x*af-L*e.y*J-3*h.x*A*e.y*J+3*h.y*e.x*o*af-2*g.x*f.y*A*J+g.x*f.y*o*af-g.y*f.x*A*J+2*g.y*f.x*o*af+3*V.x*A*e.y*J-f.x*u*e.y*af-3*V.y*e.x*o*af+M*f.y*e.x*J-3*e.x*an*o*T.y+A*e.y*S.x*(6*V.y*S.y+6*U.y*T.y)+A*T.x*e.y*(6*U.y*S.y+3*O)+z*(-2*U.y*T.y*S.y-V.y*J-T.y*(2*U.y*S.y+O)-S.y*(2*V.y*S.y+2*U.y*T.y)),6*g.x*f.x*e.x*e.y*T.y*S.y+g.x*f.y*e.x*T.x*e.y*S.y+g.x*f.y*e.x*e.y*T.y*S.x-g.y*f.x*e.x*T.x*e.y*S.y-g.y*f.x*e.x*e.y*T.y*S.x-6*g.y*f.y*e.x*T.x*e.y*S.x-6*h.x*T.x*n*S.x+6*V.x*T.x*n*S.x+6*h.y*z*T.y*S.y+2*t*e.x*T.x*S.x-2*L*e.y*T.y*S.y+6*h.x*e.x*T.x*o*S.y+6*h.x*e.x*o*T.y*S.x+6*h.y*e.x*T.x*o*S.x-3*g.x*f.x*T.x*o*S.y-3*g.x*f.x*o*T.y*S.x+2*g.x*f.y*T.x*o*S.x+4*g.y*f.x*T.x*o*S.x-6*h.x*A*e.y*T.y*S.y-6*h.y*A*T.x*e.y*S.y-6*h.y*A*e.y*T.y*S.x-4*g.x*f.y*A*T.y*S.y-6*V.x*e.x*T.x*o*S.y-6*V.x*e.x*o*T.y*S.x-2*g.y*f.x*A*T.y*S.y+3*g.y*f.y*A*T.x*S.y+3*g.y*f.y*A*T.y*S.x-2*f.x*u*e.x*T.x*S.y-2*f.x*u*e.x*T.y*S.x-2*f.x*u*T.x*e.y*S.x-6*V.y*e.x*T.x*o*S.x-6*U.x*e.x*U.y*o*S.x-6*U.x*e.x*T.x*o*T.y+6*V.x*A*e.y*T.y*S.y+2*M*f.y*e.x*T.y*S.y+2*M*f.y*T.x*e.y*S.y+2*M*f.y*e.y*T.y*S.x+3*U.x*an*n+3*m*n*S.x-3*e.x*U.y*an*o-3*m*e.x*o*S.y+A*T.x*e.y*(6*V.y*S.y+6*U.y*T.y)+A*e.y*S.x*(6*V.y*T.y+3*W)+U.x*A*e.y*(6*U.y*S.y+3*O)+z*(-2*V.y*T.y*S.y-S.y*(2*V.y*T.y+W)-U.y*(2*U.y*S.y+O)-T.y*(2*V.y*S.y+2*U.y*T.y)),g.x*U.x*f.y*e.x*e.y*S.y+g.x*f.y*e.x*U.y*e.y*S.x+g.x*f.y*e.x*T.x*e.y*T.y-g.y*f.x*U.x*e.x*e.y*S.y-g.y*f.x*e.x*U.y*e.y*S.x-g.y*f.x*e.x*T.x*e.y*T.y-6*g.y*U.x*f.y*e.x*e.y*S.x-6*h.x*U.x*n*S.x+6*V.x*U.x*n*S.x+2*U.x*t*e.x*S.x+6*h.x*U.x*e.x*o*S.y+6*h.x*e.x*U.y*o*S.x+6*h.x*e.x*T.x*o*T.y+6*h.y*U.x*e.x*o*S.x-3*g.x*f.x*U.x*o*S.y-3*g.x*f.x*U.y*o*S.x-3*g.x*f.x*T.x*o*T.y+2*g.x*U.x*f.y*o*S.x+4*g.y*f.x*U.x*o*S.x-6*h.y*U.x*A*e.y*S.y-6*h.y*A*U.y*e.y*S.x-6*h.y*A*T.x*e.y*T.y-6*V.x*U.x*e.x*o*S.y-6*V.x*e.x*U.y*o*S.x-6*V.x*e.x*T.x*o*T.y+3*g.y*U.x*f.y*A*S.y-3*g.y*f.y*e.x*an*e.y+3*g.y*f.y*A*U.y*S.x+3*g.y*f.y*A*T.x*T.y-2*f.x*U.x*u*e.x*S.y-2*f.x*U.x*u*e.y*S.x-2*f.x*u*e.x*U.y*S.x-2*f.x*u*e.x*T.x*T.y-6*V.y*U.x*e.x*o*S.x-6*U.x*e.x*U.y*T.x*o+6*V.y*A*U.y*e.y*S.x+2*M*U.x*f.y*e.y*S.y+2*M*f.y*U.y*e.y*S.x+2*M*f.y*T.x*e.y*T.y-3*h.x*an*n+3*V.x*an*n+3*m*T.x*n+t*e.x*an+3*h.y*e.x*an*o+g.x*f.y*an*o+2*g.y*f.x*an*o-f.x*u*an*e.y-3*V.y*e.x*an*o-3*m*e.x*o*T.y+M*f.y*e.x*(2*U.y*S.y+O)+g.x*f.x*e.x*e.y*(6*U.y*S.y+3*O)+U.x*A*e.y*(6*V.y*S.y+6*U.y*T.y)+L*e.y*(-2*U.y*S.y-O)+h.y*z*(6*U.y*S.y+3*O)+g.y*f.x*A*(-2*U.y*S.y-O)+g.x*f.y*A*(-4*U.y*S.y-2*O)+h.x*A*e.y*(-6*U.y*S.y-3*O)+A*T.x*e.y*(6*V.y*T.y+3*W)+V.x*A*e.y*(6*U.y*S.y+3*O)+z*(-2*V.y*U.y*S.y-T.y*(2*V.y*T.y+W)-V.y*(2*U.y*S.y+O)-U.y*(2*V.y*S.y+2*U.y*T.y)),-h.x*g.x*f.y*e.x*e.y*S.y+h.x*g.y*f.x*e.x*e.y*S.y+6*h.x*g.y*f.y*e.x*e.y*S.x-6*h.y*g.x*f.x*e.x*e.y*S.y-h.y*g.x*f.y*e.x*e.y*S.x+h.y*g.y*f.x*e.x*e.y*S.x+g.x*g.y*f.x*f.y*e.x*S.y-g.x*g.y*f.x*f.y*e.y*S.x+g.x*V.x*f.y*e.x*e.y*S.y+g.x*V.y*f.y*e.x*e.y*S.x+g.x*U.x*f.y*e.x*e.y*T.y+g.x*f.y*e.x*U.y*T.x*e.y-V.x*g.y*f.x*e.x*e.y*S.y-6*V.x*g.y*f.y*e.x*e.y*S.x-g.y*f.x*V.y*e.x*e.y*S.x-g.y*f.x*U.x*e.x*e.y*T.y-g.y*f.x*e.x*U.y*T.x*e.y-6*g.y*U.x*f.y*e.x*T.x*e.y-6*h.x*V.x*n*S.x-6*h.x*U.x*T.x*n-2*h.x*t*e.x*S.x+6*V.x*U.x*T.x*n+2*V.x*t*e.x*S.x+2*U.x*t*e.x*T.x+2*h.y*L*e.y*S.y-6*h.x*h.y*e.x*o*S.x+3*h.x*g.x*f.x*o*S.y-2*h.x*g.x*f.y*o*S.x-4*h.x*g.y*f.x*o*S.x+3*h.y*g.x*f.x*o*S.x+6*h.x*h.y*A*e.y*S.y+6*h.x*V.x*e.x*o*S.y-3*h.x*g.y*f.y*A*S.y+2*h.x*f.x*u*e.x*S.y+2*h.x*f.x*u*e.y*S.x+6*h.x*V.y*e.x*o*S.x+6*h.x*U.x*e.x*o*T.y+6*h.x*e.x*U.y*T.x*o+4*h.y*g.x*f.y*A*S.y+6*h.y*V.x*e.x*o*S.x+2*h.y*g.y*f.x*A*S.y-3*h.y*g.y*f.y*A*S.x+2*h.y*f.x*u*e.x*S.x+6*h.y*U.x*e.x*T.x*o-3*g.x*V.x*f.x*o*S.y+2*g.x*V.x*f.y*o*S.x+g.x*g.y*u*e.x*S.x-3*g.x*f.x*V.y*o*S.x-3*g.x*f.x*U.x*o*T.y-3*g.x*f.x*U.y*T.x*o+2*g.x*U.x*f.y*T.x*o+4*V.x*g.y*f.x*o*S.x+4*g.y*f.x*U.x*T.x*o-2*h.x*M*f.y*e.y*S.y-6*h.y*V.x*A*e.y*S.y-6*h.y*V.y*A*e.y*S.x-6*h.y*U.x*A*e.y*T.y-2*h.y*M*f.y*e.x*S.y-2*h.y*M*f.y*e.y*S.x-6*h.y*A*U.y*T.x*e.y-g.x*g.y*M*e.y*S.y-2*g.x*w*e.x*e.y*S.x+3*V.x*g.y*f.y*A*S.y-2*V.x*f.x*u*e.x*S.y-2*V.x*f.x*u*e.y*S.x-6*V.x*V.y*e.x*o*S.x-6*V.x*U.x*e.x*o*T.y-6*V.x*e.x*U.y*T.x*o+3*g.y*V.y*f.y*A*S.x+3*g.y*U.x*f.y*A*T.y+3*g.y*f.y*A*U.y*T.x-2*f.x*V.y*u*e.x*S.x-2*f.x*U.x*u*e.x*T.y-2*f.x*U.x*u*T.x*e.y-2*f.x*u*e.x*U.y*T.x-6*V.y*U.x*e.x*T.x*o-w*f.x*f.y*e.x*S.x+2*V.x*M*f.y*e.y*S.y+6*V.y*A*U.y*T.x*e.y+2*R*g.y*e.x*e.y*S.y+R*f.x*f.y*e.y*S.y+2*M*V.y*f.y*e.y*S.x+2*M*U.x*f.y*e.y*T.y+2*M*f.y*U.y*T.x*e.y+l*n+3*Y*n*S.x-3*D*z*S.y+3*r*n*S.x+v*A*S.x-Q*o*S.y-g.x*w*A*S.y+R*g.y*o*S.x-3*Y*e.x*o*S.y+3*D*A*e.y*S.x-R*u*e.x*S.y+w*M*e.y*S.x-3*m*e.x*U.y*o-3*r*e.x*o*S.y+3*ah*A*e.y*S.x+g.x*f.x*e.x*e.y*(6*V.y*S.y+6*U.y*T.y)+L*e.y*(-2*V.y*S.y-2*U.y*T.y)+h.y*z*(6*V.y*S.y+6*U.y*T.y)+g.y*f.x*A*(-2*V.y*S.y-2*U.y*T.y)+M*f.y*e.x*(2*V.y*S.y+2*U.y*T.y)+g.x*f.y*A*(-4*V.y*S.y-4*U.y*T.y)+h.x*A*e.y*(-6*V.y*S.y-6*U.y*T.y)+V.x*A*e.y*(6*V.y*S.y+6*U.y*T.y)+U.x*A*e.y*(6*V.y*T.y+3*W)+z*(-2*V.y*U.y*T.y-ah*S.y-U.y*(2*V.y*T.y+W)-V.y*(2*V.y*S.y+2*U.y*T.y)),-h.x*g.x*f.y*e.x*e.y*T.y+h.x*g.y*f.x*e.x*e.y*T.y+6*h.x*g.y*f.y*e.x*T.x*e.y-6*h.y*g.x*f.x*e.x*e.y*T.y-h.y*g.x*f.y*e.x*T.x*e.y+h.y*g.y*f.x*e.x*T.x*e.y+g.x*g.y*f.x*f.y*e.x*T.y-g.x*g.y*f.x*f.y*T.x*e.y+g.x*V.x*f.y*e.x*e.y*T.y+g.x*V.y*f.y*e.x*T.x*e.y+g.x*U.x*f.y*e.x*U.y*e.y-V.x*g.y*f.x*e.x*e.y*T.y-6*V.x*g.y*f.y*e.x*T.x*e.y-g.y*f.x*V.y*e.x*T.x*e.y-g.y*f.x*U.x*e.x*U.y*e.y-6*h.x*V.x*T.x*n-2*h.x*t*e.x*T.x+2*V.x*t*e.x*T.x+2*h.y*L*e.y*T.y-6*h.x*h.y*e.x*T.x*o+3*h.x*g.x*f.x*o*T.y-2*h.x*g.x*f.y*T.x*o-4*h.x*g.y*f.x*T.x*o+3*h.y*g.x*f.x*T.x*o+6*h.x*h.y*A*e.y*T.y+6*h.x*V.x*e.x*o*T.y-3*h.x*g.y*f.y*A*T.y+2*h.x*f.x*u*e.x*T.y+2*h.x*f.x*u*T.x*e.y+6*h.x*V.y*e.x*T.x*o+6*h.x*U.x*e.x*U.y*o+4*h.y*g.x*f.y*A*T.y+6*h.y*V.x*e.x*T.x*o+2*h.y*g.y*f.x*A*T.y-3*h.y*g.y*f.y*A*T.x+2*h.y*f.x*u*e.x*T.x-3*g.x*V.x*f.x*o*T.y+2*g.x*V.x*f.y*T.x*o+g.x*g.y*u*e.x*T.x-3*g.x*f.x*V.y*T.x*o-3*g.x*f.x*U.x*U.y*o+4*V.x*g.y*f.x*T.x*o-2*h.x*M*f.y*e.y*T.y-6*h.y*V.x*A*e.y*T.y-6*h.y*V.y*A*T.x*e.y-6*h.y*U.x*A*U.y*e.y-2*h.y*M*f.y*e.x*T.y-2*h.y*M*f.y*T.x*e.y-g.x*g.y*M*e.y*T.y-2*g.x*w*e.x*T.x*e.y+3*V.x*g.y*f.y*A*T.y-2*V.x*f.x*u*e.x*T.y-2*V.x*f.x*u*T.x*e.y-6*V.x*V.y*e.x*T.x*o-6*V.x*U.x*e.x*U.y*o+3*g.y*V.y*f.y*A*T.x+3*g.y*U.x*f.y*A*U.y-2*f.x*V.y*u*e.x*T.x-2*f.x*U.x*u*e.x*U.y-w*f.x*f.y*e.x*T.x+2*V.x*M*f.y*e.y*T.y-3*g.y*m*f.y*e.x*e.y+6*V.y*U.x*A*U.y*e.y+2*R*g.y*e.x*e.y*T.y+R*f.x*f.y*e.y*T.y+2*M*V.y*f.y*T.x*e.y+2*M*U.x*f.y*U.y*e.y-3*h.x*m*n+3*V.x*m*n+3*Y*T.x*n-3*D*z*T.y+3*r*T.x*n+m*t*e.x+v*A*T.x-Q*o*T.y+3*h.y*m*e.x*o-g.x*w*A*T.y+g.x*m*f.y*o+2*g.y*f.x*m*o+R*g.y*T.x*o-f.x*m*u*e.y-3*V.y*m*e.x*o-3*Y*e.x*o*T.y+3*D*A*T.x*e.y-R*u*e.x*T.y+w*M*T.x*e.y-3*r*e.x*o*T.y+3*ah*A*T.x*e.y+M*f.y*e.x*(2*V.y*T.y+W)+g.x*f.x*e.x*e.y*(6*V.y*T.y+3*W)+L*e.y*(-2*V.y*T.y-W)+h.y*z*(6*V.y*T.y+3*W)+g.y*f.x*A*(-2*V.y*T.y-W)+g.x*f.y*A*(-4*V.y*T.y-2*W)+h.x*A*e.y*(-6*V.y*T.y-3*W)+V.x*A*e.y*(6*V.y*T.y+3*W)+z*(-2*V.y*W-ah*T.y-V.y*(2*V.y*T.y+W)),-h.x*g.x*f.y*e.x*U.y*e.y+h.x*g.y*f.x*e.x*U.y*e.y+6*h.x*g.y*U.x*f.y*e.x*e.y-6*h.y*g.x*f.x*e.x*U.y*e.y-h.y*g.x*U.x*f.y*e.x*e.y+h.y*g.y*f.x*U.x*e.x*e.y-g.x*g.y*f.x*U.x*f.y*e.y+g.x*g.y*f.x*f.y*e.x*U.y+g.x*V.x*f.y*e.x*U.y*e.y+6*g.x*f.x*V.y*e.x*U.y*e.y+g.x*V.y*U.x*f.y*e.x*e.y-V.x*g.y*f.x*e.x*U.y*e.y-6*V.x*g.y*U.x*f.y*e.x*e.y-g.y*f.x*V.y*U.x*e.x*e.y-6*h.x*V.x*U.x*n-2*h.x*U.x*t*e.x+6*h.y*V.y*z*U.y+2*V.x*U.x*t*e.x+2*h.y*L*U.y*e.y-2*L*V.y*U.y*e.y-6*h.x*h.y*U.x*e.x*o+3*h.x*g.x*f.x*U.y*o-2*h.x*g.x*U.x*f.y*o-4*h.x*g.y*f.x*U.x*o+3*h.y*g.x*f.x*U.x*o+6*h.x*h.y*A*U.y*e.y+6*h.x*V.x*e.x*U.y*o-3*h.x*g.y*f.y*A*U.y+2*h.x*f.x*U.x*u*e.y+2*h.x*f.x*u*e.x*U.y+6*h.x*V.y*U.x*e.x*o+4*h.y*g.x*f.y*A*U.y+6*h.y*V.x*U.x*e.x*o+2*h.y*g.y*f.x*A*U.y-3*h.y*g.y*U.x*f.y*A+2*h.y*f.x*U.x*u*e.x-3*g.x*V.x*f.x*U.y*o+2*g.x*V.x*U.x*f.y*o+g.x*g.y*U.x*u*e.x-3*g.x*f.x*V.y*U.x*o+4*V.x*g.y*f.x*U.x*o-6*h.x*V.y*A*U.y*e.y-2*h.x*M*f.y*U.y*e.y-6*h.y*V.x*A*U.y*e.y-6*h.y*V.y*U.x*A*e.y-2*h.y*M*U.x*f.y*e.y-2*h.y*M*f.y*e.x*U.y-g.x*g.y*M*U.y*e.y-4*g.x*V.y*f.y*A*U.y-2*g.x*w*U.x*e.x*e.y+3*V.x*g.y*f.y*A*U.y-2*V.x*f.x*U.x*u*e.y-2*V.x*f.x*u*e.x*U.y-6*V.x*V.y*U.x*e.x*o-2*g.y*f.x*V.y*A*U.y+3*g.y*V.y*U.x*f.y*A-2*f.x*V.y*U.x*u*e.x-w*f.x*U.x*f.y*e.x+6*V.x*V.y*A*U.y*e.y+2*V.x*M*f.y*U.y*e.y+2*R*g.y*e.x*U.y*e.y+R*f.x*f.y*U.y*e.y+2*M*V.y*U.x*f.y*e.y+2*M*V.y*f.y*e.x*U.y+3*Y*U.x*n-3*D*z*U.y+3*r*U.x*n+v*U.x*A-Q*U.y*o-3*ah*z*U.y-g.x*w*A*U.y+R*g.y*U.x*o-3*Y*e.x*U.y*o+3*D*U.x*A*e.y-R*u*e.x*U.y+w*M*U.x*e.y-3*r*e.x*U.y*o+3*ah*U.x*A*e.y,h.x*h.y*g.x*f.y*e.x*e.y-h.x*h.y*g.y*f.x*e.x*e.y+h.x*g.x*g.y*f.x*f.y*e.y-h.y*g.x*g.y*f.x*f.y*e.x-h.x*g.x*V.y*f.y*e.x*e.y+6*h.x*V.x*g.y*f.y*e.x*e.y+h.x*g.y*f.x*V.y*e.x*e.y-h.y*g.x*V.x*f.y*e.x*e.y-6*h.y*g.x*f.x*V.y*e.x*e.y+h.y*V.x*g.y*f.x*e.x*e.y-g.x*V.x*g.y*f.x*f.y*e.y+g.x*g.y*f.x*V.y*f.y*e.x+g.x*V.x*V.y*f.y*e.x*e.y-V.x*g.y*f.x*V.y*e.x*e.y-2*h.x*V.x*t*e.x+2*h.y*L*V.y*e.y-3*h.x*h.y*g.x*f.x*o-6*h.x*h.y*V.x*e.x*o+3*h.x*h.y*g.y*f.y*A-2*h.x*h.y*f.x*u*e.x-2*h.x*g.x*V.x*f.y*o-h.x*g.x*g.y*u*e.x+3*h.x*g.x*f.x*V.y*o-4*h.x*V.x*g.y*f.x*o+3*h.y*g.x*V.x*f.x*o+6*h.x*h.y*V.y*A*e.y+2*h.x*h.y*M*f.y*e.y+2*h.x*g.x*w*e.x*e.y+2*h.x*V.x*f.x*u*e.y+6*h.x*V.x*V.y*e.x*o-3*h.x*g.y*V.y*f.y*A+2*h.x*f.x*V.y*u*e.x+h.x*w*f.x*f.y*e.x+h.y*g.x*g.y*M*e.y+4*h.y*g.x*V.y*f.y*A-3*h.y*V.x*g.y*f.y*A+2*h.y*V.x*f.x*u*e.x+2*h.y*g.y*f.x*V.y*A+g.x*V.x*g.y*u*e.x-3*g.x*V.x*f.x*V.y*o-2*h.x*M*V.y*f.y*e.y-6*h.y*V.x*V.y*A*e.y-2*h.y*V.x*M*f.y*e.y-2*h.y*R*g.y*e.x*e.y-h.y*R*f.x*f.y*e.y-2*h.y*M*V.y*f.y*e.x-2*g.x*V.x*w*e.x*e.y-g.x*g.y*M*V.y*e.y+3*V.x*g.y*V.y*f.y*A-2*V.x*f.x*V.y*u*e.x-V.x*w*f.x*f.y*e.x+3*D*g.x*f.x*e.x*e.y+3*g.x*f.x*ah*e.x*e.y+2*V.x*M*V.y*f.y*e.y-3*Y*g.y*f.y*e.x*e.y+2*R*g.y*V.y*e.x*e.y+R*f.x*V.y*f.y*e.y-3*r*g.y*f.y*e.x*e.y-X*n+B*z+q*n-ag*z-3*h.x*r*n-h.x*v*A+3*Y*V.x*n+h.y*Q*o+3*h.y*ah*z+V.x*v*A+Y*t*e.x-3*D*V.y*z-D*L*e.y+r*t*e.x-Q*V.y*o-L*ah*e.y-h.x*R*g.y*o+h.y*g.x*w*A-3*h.x*D*A*e.y-h.x*w*M*e.y+h.y*R*u*e.x-g.x*w*V.y*A+3*Y*h.y*e.x*o+Y*g.x*f.y*o+2*Y*g.y*f.x*o-2*D*g.x*f.y*A-D*g.y*f.x*A+R*V.x*g.y*o-3*h.x*ah*A*e.y+3*h.y*r*e.x*o+g.x*r*f.y*o-2*g.x*ah*f.y*A+V.x*w*M*e.y-g.y*f.x*ah*A-Y*f.x*u*e.y-3*Y*V.y*e.x*o+3*D*V.x*A*e.y+D*M*f.y*e.x-R*V.y*u*e.x+2*r*g.y*f.x*o+3*V.x*ah*A*e.y-r*f.x*u*e.y-3*r*V.y*e.x*o+M*ah*f.y*e.x);
var C=N.getRootsInInterval(0,1);for(var ak=0;ak<C.length;ak++){var Z=C[ak];var p=new Polynomial(e.x,f.x,g.x,h.x-V.x-Z*U.x-Z*Z*T.x-Z*Z*Z*S.x).getRoots();var P=new Polynomial(e.y,f.y,g.y,h.y-V.y-Z*U.y-Z*Z*T.y-Z*Z*Z*S.y).getRoots();if(p.length>0&&P.length>0){var x=0.0001;checkRoots:for(var aj=0;aj<p.length;aj++){var K=p[aj];if(0<=K&&K<=1){for(var ai=0;ai<P.length;ai++){if(Math.abs(K-P[ai])<x){y.points.push(S.multiply(Z*Z*Z).add(T.multiply(Z*Z).add(U.multiply(Z).add(V))));break checkRoots}}}}}}if(y.points.length>0){y.status="Intersection"
}return y};Intersection.intersectBezier3Circle=function(f,e,d,b,g,a){return Intersection.intersectBezier3Ellipse(f,e,d,b,g,a,a)};Intersection.intersectBezier3Ellipse=function(h,g,f,e,n,l,k){var B,A,z,y;var s,u,v,w;var p=new Intersection("No Intersection");B=h.multiply(-1);A=g.multiply(3);z=f.multiply(-3);y=B.add(A.add(z.add(e)));s=new Vector2D(y.x,y.y);B=h.multiply(3);A=g.multiply(-6);z=f.multiply(3);y=B.add(A.add(z));u=new Vector2D(y.x,y.y);B=h.multiply(-3);A=g.multiply(3);z=B.add(A);v=new Vector2D(z.x,z.y);
w=new Vector2D(h.x,h.y);var r=l*l;var j=k*k;var m=new Polynomial(s.x*s.x*j+s.y*s.y*r,2*(s.x*u.x*j+s.y*u.y*r),2*(s.x*v.x*j+s.y*v.y*r)+u.x*u.x*j+u.y*u.y*r,2*s.x*j*(w.x-n.x)+2*s.y*r*(w.y-n.y)+2*(u.x*v.x*j+u.y*v.y*r),2*u.x*j*(w.x-n.x)+2*u.y*r*(w.y-n.y)+v.x*v.x*j+v.y*v.y*r,2*v.x*j*(w.x-n.x)+2*v.y*r*(w.y-n.y),w.x*w.x*j-2*w.y*n.y*r-2*w.x*n.x*j+w.y*w.y*r+n.x*n.x*j+n.y*n.y*r-r*j);var o=m.getRootsInInterval(0,1);for(var x=0;x<o.length;x++){var q=o[x];p.points.push(s.multiply(q*q*q).add(u.multiply(q*q).add(v.multiply(q).add(w))))
}if(p.points.length>0){p.status="Intersection"}return p};Intersection.intersectBezier3Line=function(h,g,f,e,G,E){var C,A,y,x;var o,p,q,s;var j;var r;var u=G.min(E);var w=G.max(E);var k=new Intersection("No Intersection");C=h.multiply(-1);A=g.multiply(3);y=f.multiply(-3);x=C.add(A.add(y.add(e)));o=new Vector2D(x.x,x.y);C=h.multiply(3);A=g.multiply(-6);y=f.multiply(3);x=C.add(A.add(y));p=new Vector2D(x.x,x.y);C=h.multiply(-3);A=g.multiply(3);y=C.add(A);q=new Vector2D(y.x,y.y);s=new Vector2D(h.x,h.y);
r=new Vector2D(G.y-E.y,E.x-G.x);j=G.x*E.y-E.x*G.y;roots=new Polynomial(r.dot(o),r.dot(p),r.dot(q),r.dot(s)+j).getRoots();for(var v=0;v<roots.length;v++){var l=roots[v];if(0<=l&&l<=1){var H=h.lerp(g,l);var F=g.lerp(f,l);var D=f.lerp(e,l);var B=H.lerp(F,l);var z=F.lerp(D,l);var m=B.lerp(z,l);if(G.x==E.x){if(u.y<=m.y&&m.y<=w.y){k.status="Intersection";k.appendPoint(m)}}else{if(G.y==E.y){if(u.x<=m.x&&m.x<=w.x){k.status="Intersection";k.appendPoint(m)}}else{if(m.gte(u)&&m.lte(w)){k.status="Intersection";
k.appendPoint(m)}}}}}return k};Intersection.intersectBezier3Polygon=function(k,h,g,f,j){var l=new Intersection("No Intersection");var c=j.length;for(var e=0;e<c;e++){var b=j[e];var a=j[(e+1)%c];var d=Intersection.intersectBezier3Line(k,h,g,f,b,a);l.appendPoints(d.points)}if(l.points.length>0){l.status="Intersection"}return l};Intersection.intersectBezier3Rectangle=function(o,n,m,l,b,a){var d=b.min(a);var k=b.max(a);var c=new Point2D(k.x,d.y);var j=new Point2D(d.x,k.y);var h=Intersection.intersectBezier3Line(o,n,m,l,d,c);
var g=Intersection.intersectBezier3Line(o,n,m,l,c,k);var f=Intersection.intersectBezier3Line(o,n,m,l,k,j);var e=Intersection.intersectBezier3Line(o,n,m,l,j,d);var p=new Intersection("No Intersection");p.appendPoints(h.points);p.appendPoints(g.points);p.appendPoints(f.points);p.appendPoints(e.points);if(p.points.length>0){p.status="Intersection"}return p};Intersection.intersectCircleCircle=function(j,f,g,e){var q;var c=f+e;var l=Math.abs(f-e);var o=j.distanceFrom(g);if(o>c){q=new Intersection("Outside")
}else{if(o<l){q=new Intersection("Inside")}else{q=new Intersection("Intersection");var n=(f*f-e*e+o*o)/(2*o);var k=Math.sqrt(f*f-n*n);var d=j.lerp(g,n/o);var m=k/o;q.points.push(new Point2D(d.x-m*(g.y-j.y),d.y+m*(g.x-j.x)));q.points.push(new Point2D(d.x+m*(g.y-j.y),d.y-m*(g.x-j.x)))}}return q};Intersection.intersectCircleEllipse=function(e,b,a,d,c){return Intersection.intersectEllipseEllipse(e,b,b,a,d,c)};Intersection.intersectCircleLine=function(n,d,j,g){var q;var p=(g.x-j.x)*(g.x-j.x)+(g.y-j.y)*(g.y-j.y);
var o=2*((g.x-j.x)*(j.x-n.x)+(g.y-j.y)*(j.y-n.y));var l=n.x*n.x+n.y*n.y+j.x*j.x+j.y*j.y-2*(n.x*j.x+n.y*j.y)-d*d;var f=o*o-4*p*l;if(f<0){q=new Intersection("Outside")}else{if(f==0){q=new Intersection("Tangent")}else{var m=Math.sqrt(f);var k=(-o+m)/(2*p);var h=(-o-m)/(2*p);if((k<0||k>1)&&(h<0||h>1)){if((k<0&&h<0)||(k>1&&h>1)){q=new Intersection("Outside")}else{q=new Intersection("Inside")}}else{q=new Intersection("Intersection");if(0<=k&&k<=1){q.points.push(j.lerp(g,k))}if(0<=h&&h<=1){q.points.push(j.lerp(g,h))
}}}}return q};Intersection.intersectCirclePolygon=function(h,a,j){var k=new Intersection("No Intersection");var e=j.length;var f;for(var g=0;g<e;g++){var d=j[g];var b=j[(g+1)%e];f=Intersection.intersectCircleLine(h,a,d,b);k.appendPoints(f.points)}if(k.points.length>0){k.status="Intersection"}else{k.status=f.status}return k};Intersection.intersectCircleRectangle=function(m,a,d,b){var f=d.min(b);var n=d.max(b);var e=new Point2D(n.x,f.y);var l=new Point2D(f.x,n.y);var k=Intersection.intersectCircleLine(m,a,f,e);
var j=Intersection.intersectCircleLine(m,a,e,n);var h=Intersection.intersectCircleLine(m,a,n,l);var g=Intersection.intersectCircleLine(m,a,l,f);var o=new Intersection("No Intersection");o.appendPoints(k.points);o.appendPoints(j.points);o.appendPoints(h.points);o.appendPoints(g.points);if(o.points.length>0){o.status="Intersection"}else{o.status=k.status}return o};Intersection.intersectEllipseEllipse=function(p,s,e,o,r,d){var u=[e*e,0,s*s,-2*e*e*p.x,-2*s*s*p.y,e*e*p.x*p.x+s*s*p.y*p.y-s*s*e*e];var t=[d*d,0,r*r,-2*d*d*o.x,-2*r*r*o.y,d*d*o.x*o.x+r*r*o.y*o.y-r*r*d*d];
var c=Intersection.bezout(u,t);var k=c.getRoots();var v=0.001;var n=(u[0]*u[0]+2*u[1]*u[1]+u[2]*u[2])*v;var l=(t[0]*t[0]+2*t[1]*t[1]+t[2]*t[2])*v;var j=new Intersection("No Intersection");for(var g=0;g<k.length;g++){var m=new Polynomial(u[0],u[3]+k[g]*u[1],u[5]+k[g]*(u[4]+k[g]*u[2]));var f=m.getRoots();for(var h=0;h<f.length;h++){var q=(u[0]*f[h]+u[1]*k[g]+u[3])*f[h]+(u[2]*k[g]+u[4])*k[g]+u[5];if(Math.abs(q)<n){q=(t[0]*f[h]+t[1]*k[g]+t[3])*f[h]+(t[2]*k[g]+t[4])*k[g]+t[5];if(Math.abs(q)<l){j.appendPoint(new Point2D(f[h],k[g]))
}}}}if(j.points.length>0){j.status="Intersection"}return j};Intersection.intersectEllipseLine=function(r,h,g,y,w){var l;var x=new Vector2D(y.x,y.y);var o=Vector2D.fromPoints(y,w);var u=new Vector2D(r.x,r.y);var n=x.subtract(u);var f=new Vector2D(o.x/(h*h),o.y/(g*g));var e=new Vector2D(n.x/(h*h),n.y/(g*g));var v=o.dot(f);var s=o.dot(e);var r=n.dot(e)-1;var q=s*s-v*r;if(q<0){l=new Intersection("Outside")}else{if(q>0){var p=Math.sqrt(q);var k=(-s-p)/v;var j=(-s+p)/v;if((k<0||1<k)&&(j<0||1<j)){if((k<0&&j<0)||(k>1&&j>1)){l=new Intersection("Outside")
}else{l=new Intersection("Inside")}}else{l=new Intersection("Intersection");if(0<=k&&k<=1){l.appendPoint(y.lerp(w,k))}if(0<=j&&j<=1){l.appendPoint(y.lerp(w,j))}}}else{var m=-s/v;if(0<=m&&m<=1){l=new Intersection("Intersection");l.appendPoint(y.lerp(w,m))}else{l=new Intersection("Outside")}}}return l};Intersection.intersectEllipsePolygon=function(g,b,a,k){var l=new Intersection("No Intersection");var d=k.length;for(var f=0;f<d;f++){var j=k[f];var h=k[(f+1)%d];var e=Intersection.intersectEllipseLine(g,b,a,j,h);
l.appendPoints(e.points)}if(l.points.length>0){l.status="Intersection"}return l};Intersection.intersectEllipseRectangle=function(n,b,a,e,d){var g=e.min(d);var o=e.max(d);var f=new Point2D(o.x,g.y);var m=new Point2D(g.x,o.y);var l=Intersection.intersectEllipseLine(n,b,a,g,f);var k=Intersection.intersectEllipseLine(n,b,a,f,o);var j=Intersection.intersectEllipseLine(n,b,a,o,m);var h=Intersection.intersectEllipseLine(n,b,a,m,g);var p=new Intersection("No Intersection");p.appendPoints(l.points);p.appendPoints(k.points);
p.appendPoints(j.points);p.appendPoints(h.points);if(p.points.length>0){p.status="Intersection"}return p};Intersection.intersectLineLine=function(e,c,j,h){var k;var f=(h.x-j.x)*(e.y-j.y)-(h.y-j.y)*(e.x-j.x);var g=(c.x-e.x)*(e.y-j.y)-(c.y-e.y)*(e.x-j.x);var d=(h.y-j.y)*(c.x-e.x)-(h.x-j.x)*(c.y-e.y);if(d!=0){var b=f/d;var a=g/d;if(0<=b&&b<=1&&0<=a&&a<=1){k=new Intersection("Intersection");k.points.push(new Point2D(e.x+b*(c.x-e.x),e.y+b*(c.y-e.y)))}else{k=new Intersection("No Intersection")}}else{if(f==0||g==0){k=new Intersection("Coincident")
}else{k=new Intersection("Parallel")}}return k};Intersection.intersectLinePolygon=function(b,a,h){var j=new Intersection("No Intersection");var c=h.length;for(var e=0;e<c;e++){var g=h[e];var f=h[(e+1)%c];var d=Intersection.intersectLineLine(b,a,g,f);j.appendPoints(d.points)}if(j.points.length>0){j.status="Intersection"}return j};Intersection.intersectLineRectangle=function(b,a,d,c){var f=d.min(c);var m=d.max(c);var e=new Point2D(m.x,f.y);var l=new Point2D(f.x,m.y);var k=Intersection.intersectLineLine(f,e,b,a);
var j=Intersection.intersectLineLine(e,m,b,a);var h=Intersection.intersectLineLine(m,l,b,a);var g=Intersection.intersectLineLine(l,f,b,a);var n=new Intersection("No Intersection");n.appendPoints(k.points);n.appendPoints(j.points);n.appendPoints(h.points);n.appendPoints(g.points);if(n.points.length>0){n.status="Intersection"}return n};Intersection.intersectPolygonPolygon=function(f,e){var c=new Intersection("No Intersection");var h=f.length;for(var g=0;g<h;g++){var d=f[g];var b=f[(g+1)%h];var a=Intersection.intersectLinePolygon(d,b,e);
c.appendPoints(a.points)}if(c.points.length>0){c.status="Intersection"}return c};Intersection.intersectPolygonRectangle=function(l,b,a){var d=b.min(a);var k=b.max(a);var c=new Point2D(k.x,d.y);var j=new Point2D(d.x,k.y);var h=Intersection.intersectLinePolygon(d,c,l);var g=Intersection.intersectLinePolygon(c,k,l);var f=Intersection.intersectLinePolygon(k,j,l);var e=Intersection.intersectLinePolygon(j,d,l);var m=new Intersection("No Intersection");m.appendPoints(h.points);m.appendPoints(g.points);m.appendPoints(f.points);
m.appendPoints(e.points);if(m.points.length>0){m.status="Intersection"}return m};Intersection.intersectRayRay=function(d,b,h,g){var j;var e=(g.x-h.x)*(d.y-h.y)-(g.y-h.y)*(d.x-h.x);var f=(b.x-d.x)*(d.y-h.y)-(b.y-d.y)*(d.x-h.x);var c=(g.y-h.y)*(b.x-d.x)-(g.x-h.x)*(b.y-d.y);if(c!=0){var a=e/c;j=new Intersection("Intersection");j.points.push(new Point2D(d.x+a*(b.x-d.x),d.y+a*(b.y-d.y)))}else{if(e==0||f==0){j=new Intersection("Coincident")}else{j=new Intersection("Parallel")}}return j};Intersection.intersectRectangleRectangle=function(b,a,m,k){var d=b.min(a);
var l=b.max(a);var c=new Point2D(l.x,d.y);var j=new Point2D(d.x,l.y);var h=Intersection.intersectLineRectangle(d,c,m,k);var g=Intersection.intersectLineRectangle(c,l,m,k);var f=Intersection.intersectLineRectangle(l,j,m,k);var e=Intersection.intersectLineRectangle(j,d,m,k);var n=new Intersection("No Intersection");n.appendPoints(h.points);n.appendPoints(g.points);n.appendPoints(f.points);n.appendPoints(e.points);if(n.points.length>0){n.status="Intersection"}return n};Intersection.bezout=function(o,m){var j=o[0]*m[1]-m[0]*o[1];
var h=o[0]*m[2]-m[0]*o[2];var g=o[0]*m[3]-m[0]*o[3];var f=o[0]*m[4]-m[0]*o[4];var e=o[0]*m[5]-m[0]*o[5];var b=o[1]*m[2]-m[1]*o[2];var a=o[1]*m[4]-m[1]*o[4];var p=o[1]*m[5]-m[1]*o[5];var n=o[2]*m[3]-m[2]*o[3];var d=o[3]*m[4]-m[3]*o[4];var c=o[3]*m[5]-m[3]*o[5];var l=p+d;var k=a-n;return new Polynomial(j*b-h*h,j*k+g*b-2*h*f,j*l+g*k-f*f-2*h*e,j*c+g*l-2*f*e,g*c-e*e)};function IntersectionParams(a,b){if(arguments.length>0){this.init(a,b)}}IntersectionParams.prototype.init=function(a,b){this.name=a;this.params=b
};function Point2D(a,b){if(arguments.length>0){this.init(a,b)}}Point2D.prototype.init=function(a,b){this.x=a;this.y=b};Point2D.prototype.add=function(a){return new Point2D(this.x+a.x,this.y+a.y)};Point2D.prototype.addEquals=function(a){this.x+=a.x;this.y+=a.y;return this};Point2D.prototype.scalarAdd=function(a){return new Point2D(this.x+a,this.y+a)};Point2D.prototype.scalarAddEquals=function(a){this.x+=a;this.y+=a;return this};Point2D.prototype.subtract=function(a){return new Point2D(this.x-a.x,this.y-a.y)
};Point2D.prototype.subtractEquals=function(a){this.x-=a.x;this.y-=a.y;return this};Point2D.prototype.scalarSubtract=function(a){return new Point2D(this.x-a,this.y-a)};Point2D.prototype.scalarSubtractEquals=function(a){this.x-=a;this.y-=a;return this};Point2D.prototype.multiply=function(a){return new Point2D(this.x*a,this.y*a)};Point2D.prototype.multiplyEquals=function(a){this.x*=a;this.y*=a;return this};Point2D.prototype.divide=function(a){return new Point2D(this.x/a,this.y/a)};Point2D.prototype.divideEquals=function(a){this.x/=a;
this.y/=a;return this};Point2D.prototype.eq=function(a){return(this.x==a.x&&this.y==a.y)};Point2D.prototype.lt=function(a){return(this.x<a.x&&this.y<a.y)};Point2D.prototype.lte=function(a){return(this.x<=a.x&&this.y<=a.y)};Point2D.prototype.gt=function(a){return(this.x>a.x&&this.y>a.y)};Point2D.prototype.gte=function(a){return(this.x>=a.x&&this.y>=a.y)};Point2D.prototype.lerp=function(b,a){return new Point2D(this.x+(b.x-this.x)*a,this.y+(b.y-this.y)*a)};Point2D.prototype.distanceFrom=function(c){var b=this.x-c.x;
var a=this.y-c.y;return Math.sqrt(b*b+a*a)};Point2D.prototype.min=function(a){return new Point2D(Math.min(this.x,a.x),Math.min(this.y,a.y))};Point2D.prototype.max=function(a){return new Point2D(Math.max(this.x,a.x),Math.max(this.y,a.y))};Point2D.prototype.toString=function(){return this.x+","+this.y};Point2D.prototype.setXY=function(a,b){this.x=a;this.y=b};Point2D.prototype.setFromPoint=function(a){this.x=a.x;this.y=a.y};Point2D.prototype.swap=function(b){var a=this.x;var c=this.y;this.x=b.x;this.y=b.y;
b.x=a;b.y=c};Polynomial.TOLERANCE=0.000001;Polynomial.ACCURACY=6;function Polynomial(){this.init(arguments)}Polynomial.prototype.init=function(a){this.coefs=new Array();for(var b=a.length-1;b>=0;b--){this.coefs.push(a[b])}};Polynomial.prototype.eval=function(b){var a=0;for(var c=this.coefs.length-1;c>=0;c--){a=a*b+this.coefs[c]}return a};Polynomial.prototype.multiply=function(d){var a=new Polynomial();for(var c=0;c<=this.getDegree()+d.getDegree();c++){a.coefs.push(0)}for(var c=0;c<=this.getDegree();
c++){for(var b=0;b<=d.getDegree();b++){a.coefs[c+b]+=this.coefs[c]*d.coefs[b]}}return a};Polynomial.prototype.divide_scalar=function(a){for(var b=0;b<this.coefs.length;b++){this.coefs[b]/=a}};Polynomial.prototype.simplify=function(){for(var a=this.getDegree();a>=0;a--){if(Math.abs(this.coefs[a])<=Polynomial.TOLERANCE){this.coefs.pop()}else{break}}};Polynomial.prototype.bisection=function(min,max){var minValue=this.eval(min);var maxValue=this.eval(max);var result;if(Math.abs(minValue)<=Polynomial.TOLERANCE){result=min
}else{if(Math.abs(maxValue)<=Polynomial.TOLERANCE){result=max}else{if(minValue*maxValue<=0){var tmp1=Math.log(max-min);var tmp2=Math.log(10)*Polynomial.ACCURACY;var iters=Math.ceil((tmp1+tmp2)/Math.log(2));for(var i=0;i<iters;i++){result=0.5*(min+max);var value=this.eval(result);if(Math.abs(value)<=Polynomial.TOLERANCE){break}if(value*minValue<0){max=result;maxValue=value}else{min=result;minValue=value}}}}}return result};Polynomial.prototype.toString=function(){var b=new Array();var d=new Array();
for(var e=this.coefs.length-1;e>=0;e--){var f=this.coefs[e];if(f!=0){var c=(f<0)?" - ":" + ";f=Math.abs(f);if(e>0){if(f==1){f="x"}else{f+="x"}}if(e>1){f+="^"+e}d.push(c);b.push(f)}}d[0]=(d[0]==" + ")?"":"-";var a="";for(var e=0;e<b.length;e++){a+=d[e]+b[e]}return a};Polynomial.prototype.getDegree=function(){return this.coefs.length-1};Polynomial.prototype.getDerivative=function(){var a=new Polynomial();for(var b=1;b<this.coefs.length;b++){a.coefs.push(b*this.coefs[b])}return a};Polynomial.prototype.getRoots=function(){var a;
this.simplify();switch(this.getDegree()){case 0:a=new Array();break;case 1:a=this.getLinearRoot();break;case 2:a=this.getQuadraticRoots();break;case 3:a=this.getCubicRoots();break;case 4:a=this.getQuarticRoots();break;default:a=new Array()}return a};Polynomial.prototype.getRootsInInterval=function(e,a){var c=new Array();var b;if(this.getDegree()==1){b=this.bisection(e,a);if(b!=null){c.push(b)}}else{var f=this.getDerivative();var d=f.getRootsInInterval(e,a);if(d.length>0){b=this.bisection(e,d[0]);
if(b!=null){c.push(b)}for(i=0;i<=d.length-2;i++){b=this.bisection(d[i],d[i+1]);if(b!=null){c.push(b)}}b=this.bisection(d[d.length-1],a);if(b!=null){c.push(b)}}else{b=this.bisection(e,a);if(b!=null){c.push(b)}}}return c};Polynomial.prototype.getLinearRoot=function(){var b=new Array();var c=this.coefs[1];if(c!=0){b.push(-this.coefs[0]/c)}return b};Polynomial.prototype.getQuadraticRoots=function(){var h=new Array();if(this.getDegree()==2){var g=this.coefs[2];var f=this.coefs[1]/g;var l=this.coefs[0]/g;
var k=f*f-4*l;if(k>0){var j=Math.sqrt(k);h.push(0.5*(-f+j));h.push(0.5*(-f-j))}else{if(k==0){h.push(0.5*-f)}}}return h};Polynomial.prototype.getCubicRoots=function(){var m=new Array();if(this.getDegree()==3){var k=this.coefs[3];var l=this.coefs[2]/k;var n=this.coefs[1]/k;var p=this.coefs[0]/k;var v=(3*n-l*l)/3;var u=(2*l*l*l-9*n*l+27*p)/27;var j=l/3;var f=u*u/4+v*v*v/27;var o=u/2;if(Math.abs(f)<=Polynomial.TOLERANCE){disrim=0}if(f>0){var s=Math.sqrt(f);var t;var q;t=-o+s;if(t>=0){q=Math.pow(t,1/3)
}else{q=-Math.pow(-t,1/3)}t=-o-s;if(t>=0){q+=Math.pow(t,1/3)}else{q-=Math.pow(-t,1/3)}m.push(q-j)}else{if(f<0){var g=Math.sqrt(-v/3);var r=Math.atan2(Math.sqrt(-f),-o)/3;var d=Math.cos(r);var c=Math.sin(r);var h=Math.sqrt(3);m.push(2*g*d-j);m.push(-g*(d+h*c)-j);m.push(-g*(d-h*c)-j)}else{var t;if(o>=0){t=-Math.pow(o,1/3)}else{t=Math.pow(-o,1/3)}m.push(2*t-j);m.push(-t-j)}}}return m};Polynomial.prototype.getQuarticRoots=function(){var l=new Array();if(this.getDegree()==4){var c=this.coefs[4];var h=this.coefs[3]/c;
var j=this.coefs[2]/c;var k=this.coefs[1]/c;var n=this.coefs[0]/c;var b=new Polynomial(1,-j,h*k-4*n,-h*h*n+4*j*n-k*k).getCubicRoots();var t=b[0];var a=h*h/4-j+t;if(Math.abs(a)<=Polynomial.TOLERANCE){a=0}if(a>0){var r=Math.sqrt(a);var o=3*h*h/4-r*r-2*j;var m=(4*h*j-8*k-h*h*h)/(4*r);var q=o+m;var g=o-m;if(Math.abs(q)<=Polynomial.TOLERANCE){q=0}if(Math.abs(g)<=Polynomial.TOLERANCE){g=0}if(q>=0){var p=Math.sqrt(q);l.push(-h/4+(r+p)/2);l.push(-h/4+(r-p)/2)}if(g>=0){var p=Math.sqrt(g);l.push(-h/4+(p-r)/2);
l.push(-h/4-(p+r)/2)}}else{if(a<0){}else{var m=t*t-4*n;if(m>=-Polynomial.TOLERANCE){if(m<0){m=0}m=2*Math.sqrt(m);o=3*h*h/4-2*j;if(o+m>=Polynomial.TOLERANCE){var s=Math.sqrt(o+m);l.push(-h/4+s/2);l.push(-h/4-s/2)}if(o-m>=Polynomial.TOLERANCE){var s=Math.sqrt(o-m);l.push(-h/4+s/2);l.push(-h/4-s/2)}}}}}return l};function Vector2D(a,b){if(arguments.length>0){this.init(a,b)}}Vector2D.prototype.init=function(a,b){this.x=a;this.y=b};Vector2D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)
};Vector2D.prototype.dot=function(a){return this.x*a.x+this.y*a.y};Vector2D.prototype.cross=function(a){return this.x*a.y-this.y*a.x};Vector2D.prototype.unit=function(){return this.divide(this.length())};Vector2D.prototype.unitEquals=function(){this.divideEquals(this.length());return this};Vector2D.prototype.add=function(a){return new Vector2D(this.x+a.x,this.y+a.y)};Vector2D.prototype.addEquals=function(a){this.x+=a.x;this.y+=a.y;return this};Vector2D.prototype.subtract=function(a){return new Vector2D(this.x-a.x,this.y-a.y)
};Vector2D.prototype.subtractEquals=function(a){this.x-=a.x;this.y-=a.y;return this};Vector2D.prototype.multiply=function(a){return new Vector2D(this.x*a,this.y*a)};Vector2D.prototype.multiplyEquals=function(a){this.x*=a;this.y*=a;return this};Vector2D.prototype.divide=function(a){return new Vector2D(this.x/a,this.y/a)};Vector2D.prototype.divideEquals=function(a){this.x/=a;this.y/=a;return this};Vector2D.prototype.perp=function(){return new Vector2D(-this.y,this.x)};Vector2D.fromPoints=function(b,a){return new Vector2D(a.x-b.x,a.y-b.y)
};Shape.prototype=new EventHandler();Shape.prototype.constructor=Shape;Shape.superclass=EventHandler.prototype;function Shape(a){if(arguments.length>0){this.init(a)}}Shape.prototype.init=function(a){this.svgNode=a;this.locked=false;this.visible=true;this.selected=false;this.callback=null;this.lastUpdate=null};Shape.prototype.show=function(a){var b=(a)?"inline":"none";this.visible=a;this.svgNode.setAttributeNS(null,"display",b)};Shape.prototype.refresh=function(){};Shape.prototype.update=function(){this.refresh();
if(this.owner){this.owner.update(this)}if(this.callback!=null){this.callback(this)}};Shape.prototype.translate=function(a){};Shape.prototype.select=function(a){this.selected=a};Shape.prototype.registerHandles=function(){};Shape.prototype.unregisterHandles=function(){};Shape.prototype.selectHandles=function(a){};Shape.prototype.showHandles=function(a){};Shape.prototype.mousedown=function(a){if(!this.locked){if(a.shiftKey){if(this.selected){mouser.unregisterShape(this)}else{mouser.registerShape(this);
this.showHandles(true);this.selectHandles(true);this.registerHandles()}}else{if(this.selected){this.selectHandles(true);this.registerHandles()}else{mouser.unregisterShapes();mouser.registerShape(this);this.showHandles(true);this.selectHandles(false)}}}};Circle.prototype=new Shape();Circle.prototype.constructor=Circle;Circle.superclass=Shape.prototype;function Circle(a){if(arguments.length>0){this.init(a)}}Circle.prototype.init=function(c){if(c.localName=="circle"){Circle.superclass.init.call(this,c);
var a=parseFloat(c.getAttributeNS(null,"cx"));var d=parseFloat(c.getAttributeNS(null,"cy"));var b=parseFloat(c.getAttributeNS(null,"r"));this.center=new Handle(a,d,this);this.last=new Point2D(a,d);this.radius=new Handle(a+b,d,this)}else{throw new Error("Circle.init: Invalid SVG Node: "+c.localName)}};Circle.prototype.realize=function(){if(this.svgNode!=null){this.center.realize();this.radius.realize();this.center.show(false);this.radius.show(false);this.svgNode.addEventListener("mousedown",this,false)
}};Circle.prototype.translate=function(a){this.center.translate(a);this.radius.translate(a);this.refresh()};Circle.prototype.refresh=function(){var a=this.radius.point.distanceFrom(this.center.point);this.svgNode.setAttributeNS(null,"cx",this.center.point.x);this.svgNode.setAttributeNS(null,"cy",this.center.point.y);this.svgNode.setAttributeNS(null,"r",a)};Circle.prototype.registerHandles=function(){mouser.register(this.center);mouser.register(this.radius)};Circle.prototype.unregisterHandles=function(){mouser.unregister(this.center);
mouser.unregister(this.radius)};Circle.prototype.selectHandles=function(a){this.center.select(a);this.radius.select(a)};Circle.prototype.showHandles=function(a){this.center.show(a);this.radius.show(a)};Circle.prototype.getIntersectionParams=function(){return new IntersectionParams("Circle",[this.center.point,parseFloat(this.svgNode.getAttributeNS(null,"r"))])};Ellipse.prototype=new Shape();Ellipse.prototype.constructor=Ellipse;Ellipse.superclass=Shape.prototype;function Ellipse(a){if(arguments.length>0){this.init(a)
}}Ellipse.prototype.init=function(b){if(b==null||b.localName!="ellipse"){throw new Error("Ellipse.init: Invalid localName: "+b.localName)}Ellipse.superclass.init.call(this,b);var a=parseFloat(b.getAttributeNS(null,"cx"));var e=parseFloat(b.getAttributeNS(null,"cy"));var d=parseFloat(b.getAttributeNS(null,"rx"));var c=parseFloat(b.getAttributeNS(null,"ry"));this.center=new Handle(a,e,this);this.radiusX=new Handle(a+d,e,this);this.radiusY=new Handle(a,e+c,this)};Ellipse.prototype.realize=function(){this.center.realize();
this.radiusX.realize();this.radiusY.realize();this.center.show(false);this.radiusX.show(false);this.radiusY.show(false);this.svgNode.addEventListener("mousedown",this,false)};Ellipse.prototype.refresh=function(){var b=Math.abs(this.center.point.x-this.radiusX.point.x);var a=Math.abs(this.center.point.y-this.radiusY.point.y);this.svgNode.setAttributeNS(null,"cx",this.center.point.x);this.svgNode.setAttributeNS(null,"cy",this.center.point.y);this.svgNode.setAttributeNS(null,"rx",b);this.svgNode.setAttributeNS(null,"ry",a)
};Ellipse.prototype.registerHandles=function(){mouser.register(this.center);mouser.register(this.radiusX);mouser.register(this.radiusY)};Ellipse.prototype.unregisterHandles=function(){mouser.unregister(this.center);mouser.unregister(this.radiusX);mouser.unregister(this.radiusY)};Ellipse.prototype.selectHandles=function(a){this.center.select(a);this.radiusX.select(a);this.radiusY.select(a)};Ellipse.prototype.showHandles=function(a){this.center.show(a);this.radiusX.show(a);this.radiusY.show(a)};Ellipse.prototype.getIntersectionParams=function(){return new IntersectionParams("Ellipse",[this.center.point,parseFloat(this.svgNode.getAttributeNS(null,"rx")),parseFloat(this.svgNode.getAttributeNS(null,"ry"))])
};Handle.prototype=new Shape();Handle.prototype.constructor=Handle;Handle.superclass=Shape.prototype;Handle.NO_CONSTRAINTS=0;Handle.CONSTRAIN_X=1;Handle.CONSTRAIN_Y=2;function Handle(b,c,a){if(arguments.length>0){this.init(b,c,a)}}Handle.prototype.init=function(b,c,a){Handle.superclass.init.call(this,null);this.point=new Point2D(b,c);this.owner=a;this.constrain=Handle.NO_CONSTRAINTS};Handle.prototype.realize=function(){if(this.svgNode==null){var b="http://www.w3.org/2000/svg";var c=svgDocument.createElementNS(b,"rect");
var a;if(this.owner!=null&&this.owner.svgNode!=null){a=this.owner.svgNode.parentNode}else{a=svgDocument.documentElement}c.setAttributeNS(null,"x",this.point.x-2);c.setAttributeNS(null,"y",this.point.y-2);c.setAttributeNS(null,"width",4);c.setAttributeNS(null,"height",4);c.setAttributeNS(null,"stroke","black");c.setAttributeNS(null,"fill","white");c.addEventListener("mousedown",this,false);a.appendChild(c);this.svgNode=c;this.show(this.visible)}};Handle.prototype.unrealize=function(){this.svgNode.removeEventListener("mousedown",this,false);
this.svgNode.parentNode.removeChild(this.svgNode)};Handle.prototype.translate=function(a){if(this.constrain==Handle.CONSTRAIN_X){this.point.x+=a.x}else{if(this.constrain==Handle.CONSTRAIN_Y){this.point.y+=a.y}else{this.point.addEquals(a)}}this.refresh()};Handle.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"x",this.point.x-2);this.svgNode.setAttributeNS(null,"y",this.point.y-2)};Handle.prototype.select=function(a){Handle.superclass.select.call(this,a);if(a){this.svgNode.setAttributeNS(null,"fill","black")
}else{this.svgNode.setAttributeNS(null,"fill","white")}};Handle.prototype.mousedown=function(b){if(!this.locked){if(b.shiftKey){if(this.selected){mouser.unregister(this)}else{mouser.register(this);mouser.beginDrag(b)}}else{if(!this.selected){var a=this.owner;mouser.unregisterAll();mouser.register(this)}mouser.beginDrag(b)}}};Lever.prototype=new Shape();Lever.prototype.constructor=Lever;Lever.superclass=Shape.prototype;function Lever(c,e,b,d,a){if(arguments.length>0){this.init(c,e,b,d,a)}}Lever.prototype.init=function(c,e,b,d,a){Lever.superclass.init.call(this,null);
this.point=new Handle(c,e,this);this.lever=new LeverHandle(b,d,this);this.owner=a};Lever.prototype.realize=function(){if(this.svgNode==null){var c="http://www.w3.org/2000/svg";var a=svgDocument.createElementNS(c,"line");var b;if(this.owner!=null&&this.owner.svgNode!=null){b=this.owner.svgNode.parentNode}else{b=svgDocument.documentElement}a.setAttributeNS(null,"x1",this.point.point.x);a.setAttributeNS(null,"y1",this.point.point.y);a.setAttributeNS(null,"x2",this.lever.point.x);a.setAttributeNS(null,"y2",this.lever.point.y);
a.setAttributeNS(null,"stroke","black");b.appendChild(a);this.svgNode=a;this.point.realize();this.lever.realize();this.show(this.visible)}};Lever.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"x1",this.point.point.x);this.svgNode.setAttributeNS(null,"y1",this.point.point.y);this.svgNode.setAttributeNS(null,"x2",this.lever.point.x);this.svgNode.setAttributeNS(null,"y2",this.lever.point.y)};LeverHandle.prototype=new Handle();LeverHandle.prototype.constructor=LeverHandle;LeverHandle.superclass=Handle.prototype;
function LeverHandle(b,c,a){if(arguments.length>0){this.init(b,c,a)}}LeverHandle.prototype.realize=function(){if(this.svgNode==null){var b="http://www.w3.org/2000/svg";var c=svgDocument.createElementNS(b,"circle");var a;if(this.owner!=null&&this.owner.svgNode!=null){a=this.owner.svgNode.parentNode}else{a=svgDocument.documentElement}c.setAttributeNS(null,"cx",this.point.x);c.setAttributeNS(null,"cy",this.point.y);c.setAttributeNS(null,"r",2.5);c.setAttributeNS(null,"fill","black");c.addEventListener("mousedown",this,false);
a.appendChild(c);this.svgNode=c;this.show(this.visible)}};LeverHandle.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"cx",this.point.x);this.svgNode.setAttributeNS(null,"cy",this.point.y)};LeverHandle.prototype.select=function(a){LeverHandle.superclass.select.call(this,a);this.svgNode.setAttributeNS(null,"fill","black")};Line.prototype=new Shape();Line.prototype.constructor=Line;Line.superclass=Shape.prototype;function Line(a){if(arguments.length>0){this.init(a)}}Line.prototype.init=function(e){if(e==null||e.localName!="line"){throw new Error("Line.init: Invalid localName: "+e.localName)
}Line.superclass.init.call(this,e);var b=parseFloat(e.getAttributeNS(null,"x1"));var d=parseFloat(e.getAttributeNS(null,"y1"));var a=parseFloat(e.getAttributeNS(null,"x2"));var c=parseFloat(e.getAttributeNS(null,"y2"));this.p1=new Handle(b,d,this);this.p2=new Handle(a,c,this)};Line.prototype.realize=function(){this.p1.realize();this.p2.realize();this.p1.show(false);this.p2.show(false);this.svgNode.addEventListener("mousedown",this,false)};Line.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"x1",this.p1.point.x);
this.svgNode.setAttributeNS(null,"y1",this.p1.point.y);this.svgNode.setAttributeNS(null,"x2",this.p2.point.x);this.svgNode.setAttributeNS(null,"y2",this.p2.point.y)};Line.prototype.registerHandles=function(){mouser.register(this.p1);mouser.register(this.p2)};Line.prototype.unregisterHandles=function(){mouser.unregister(this.p1);mouser.unregister(this.p2)};Line.prototype.selectHandles=function(a){this.p1.select(a);this.p2.select(a)};Line.prototype.showHandles=function(a){this.p1.show(a);this.p2.show(a)
};Line.prototype.cut=function(b){var d=this.p1.point.lerp(this.p2.point,b);var c=this.svgNode.cloneNode(true);this.p2.point.setFromPoint(d);this.p2.update();if(this.svgNode.nextSibling!=null){this.svgNode.parentNode.insertBefore(c,this.svgNode.nextSibling)}else{this.svgNode.parentNode.appendChild(c)}var a=new Line(c);a.realize();a.p1.point.setFromPoint(d);a.p1.update()};Line.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.p1.point,this.p2.point])};function Token(a,b){if(arguments.length>0){this.init(a,b)
}}Token.prototype.init=function(a,b){this.type=a;this.text=b};Token.prototype.typeis=function(a){return this.type==a};Path.prototype=new Shape();Path.prototype.constructor=Path;Path.superclass=Shape.prototype;Path.COMMAND=0;Path.NUMBER=1;Path.EOD=2;Path.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]};
function Path(a){if(arguments.length>0){this.init(a)}}Path.prototype.init=function(a){if(a==null||a.localName!="path"){throw new Error("Path.init: Invalid localName: "+a.localName)}Path.superclass.init.call(this,a);this.segments=null;this.parseData(a.getAttributeNS(null,"d"))};Path.prototype.realize=function(){for(var a=0;a<this.segments.length;a++){this.segments[a].realize()}this.svgNode.addEventListener("mousedown",this,false)};Path.prototype.unrealize=function(){for(var a=0;a<this.segments.length;
a++){this.segments[a].unrealize()}this.svgNode.removeEventListener("mousedown",this,false)};Path.prototype.refresh=function(){var b=new Array();for(var a=0;a<this.segments.length;a++){b.push(this.segments[a].toString())}this.svgNode.setAttributeNS(null,"d",b.join(" "))};Path.prototype.registerHandles=function(){for(var a=0;a<this.segments.length;a++){this.segments[a].registerHandles()}};Path.prototype.unregisterHandles=function(){for(var a=0;a<this.segments.length;a++){this.segments[a].unregisterHandles()
}};Path.prototype.selectHandles=function(a){for(var b=0;b<this.segments.length;b++){this.segments[b].selectHandles(a)}};Path.prototype.showHandles=function(b){for(var a=0;a<this.segments.length;a++){this.segments[a].showHandles(b)}};Path.prototype.appendPathSegment=function(a){a.previous=this.segments[this.segments.length-1];this.segments.push(a)};Path.prototype.parseData=function(m){var n=this.tokenize(m);var k=0;var b=n[k];var j="BOD";this.segments=new Array();while(!b.typeis(Path.EOD)){var l;var e=new Array();
if(j=="BOD"){if(b.text=="M"||b.text=="m"){k++;l=Path.PARAMS[b.text].length;j=b.text}else{throw new Error("Path data must begin with a moveto command")}}else{if(b.typeis(Path.NUMBER)){l=Path.PARAMS[j].length}else{k++;l=Path.PARAMS[b.text].length;j=b.text}}if((k+l)<n.length){for(var f=k;f<k+l;f++){var c=n[f];if(c.typeis(Path.NUMBER)){e[e.length]=c.text}else{throw new Error("Parameter type is not a number: "+j+","+c.text)}}var h;var a=this.segments.length;var g=(a==0)?null:this.segments[a-1];switch(j){case"A":h=new AbsoluteArcPath(e,this,g);
break;case"C":h=new AbsoluteCurveto3(e,this,g);break;case"c":h=new RelativeCurveto3(e,this,g);break;case"H":h=new AbsoluteHLineto(e,this,g);break;case"L":h=new AbsoluteLineto(e,this,g);break;case"l":h=new RelativeLineto(e,this,g);break;case"M":h=new AbsoluteMoveto(e,this,g);break;case"m":h=new RelativeMoveto(e,this,g);break;case"Q":h=new AbsoluteCurveto2(e,this,g);break;case"q":h=new RelativeCurveto2(e,this,g);break;case"S":h=new AbsoluteSmoothCurveto3(e,this,g);break;case"s":h=new RelativeSmoothCurveto3(e,this,g);
break;case"T":h=new AbsoluteSmoothCurveto2(e,this,g);break;case"t":h=new RelativeSmoothCurveto2(e,this,g);break;case"Z":h=new RelativeClosePath(e,this,g);break;case"z":h=new RelativeClosePath(e,this,g);break;default:throw new Error("Unsupported segment type: "+j)}this.segments.push(h);k+=l;b=n[k];if(j=="M"){j="L"}if(j=="m"){j="l"}}else{throw new Error("Path data ended before all parameters were found")}}};Path.prototype.tokenize=function(b){var a=new Array();while(b!=""){if(b.match(/^([ \t\r\n,]+)/)){b=b.substr(RegExp.$1.length)
}else{if(b.match(/^([aAcChHlLmMqQsStTvVzZ])/)){a[a.length]=new Token(Path.COMMAND,RegExp.$1);b=b.substr(RegExp.$1.length)}else{if(b.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/)){a[a.length]=new Token(Path.NUMBER,parseFloat(RegExp.$1));b=b.substr(RegExp.$1.length)}else{throw new Error("Unrecognized segment command: "+b)}}}}a[a.length]=new Token(Path.EOD,null);return a};Path.prototype.intersectShape=function(c){var b=new Intersection("No Intersection");for(var d=0;d<this.segments.length;
d++){var a=Intersection.intersectShapes(this.segments[d],c);b.appendPoints(a.points)}if(b.points.length>0){b.status="Intersection"}return b};Path.prototype.getIntersectionParams=function(){return new IntersectionParams("Path",[])};function AbsolutePathSegment(d,c,a,b){if(arguments.length>0){this.init(d,c,a,b)}}AbsolutePathSegment.prototype.init=function(f,e,a,c){this.command=f;this.owner=a;this.previous=c;this.handles=new Array();var b=0;while(b<e.length){var d=new Handle(e[b],e[b+1],a);this.handles.push(d);
b+=2}};AbsolutePathSegment.prototype.realize=function(){for(var a=0;a<this.handles.length;a++){var b=this.handles[a];b.realize();b.show(false)}};AbsolutePathSegment.prototype.unrealize=function(){for(var a=0;a<this.handles.length;a++){this.handles[a].unrealize()}};AbsolutePathSegment.prototype.registerHandles=function(){for(var a=0;a<this.handles.length;a++){mouser.register(this.handles[a])}};AbsolutePathSegment.prototype.unregisterHandles=function(){for(var a=0;a<this.handles.length;a++){mouser.unregister(this.handles[a])
}};AbsolutePathSegment.prototype.selectHandles=function(a){for(var b=0;b<this.handles.length;b++){this.handles[b].select(a)}};AbsolutePathSegment.prototype.showHandles=function(b){for(var a=0;a<this.handles.length;a++){this.handles[a].show(b)}};AbsolutePathSegment.prototype.toString=function(){var b=new Array();var c="";if(this.previous==null||this.previous.constructor!=this.constuctor){c=this.command}for(var a=0;a<this.handles.length;a++){b.push(this.handles[a].point.toString())}return c+b.join(" ")
};AbsolutePathSegment.prototype.getLastPoint=function(){return this.handles[this.handles.length-1].point};AbsolutePathSegment.prototype.getIntersectionParams=function(){return null};AbsoluteArcPath.prototype=new AbsolutePathSegment();AbsoluteArcPath.prototype.constructor=AbsoluteArcPath;AbsoluteArcPath.superclass=AbsolutePathSegment.prototype;function AbsoluteArcPath(c,a,b){if(arguments.length>0){this.init("A",c,a,b)}}AbsoluteArcPath.prototype.init=function(f,e,c,d){var b=new Array();var g=e.pop();
var a=e.pop();b.push(a,g);AbsoluteArcPath.superclass.init.call(this,f,b,c,d);this.rx=parseFloat(e.shift());this.ry=parseFloat(e.shift());this.angle=parseFloat(e.shift());this.arcFlag=parseFloat(e.shift());this.sweepFlag=parseFloat(e.shift())};AbsoluteArcPath.prototype.toString=function(){var a=new Array();var b="";if(this.previous.constructor!=this.constuctor){b=this.command}return b+[this.rx,this.ry,this.angle,this.arcFlag,this.sweepFlag,this.handles[0].point.toString()].join(",")};AbsoluteArcPath.prototype.getIntersectionParams=function(){return new IntersectionParams("Ellipse",[this.getCenter(),this.rx,this.ry])
};AbsoluteArcPath.prototype.getCenter=function(){var r=this.previous.getLastPoint();var m=this.handles[0].point;var g=this.rx;var f=this.ry;var x=this.angle*Math.PI/180;var y=Math.cos(x);var n=Math.sin(x);var k=0.000001;var t=r.subtract(m).divide(2);var u=t.x*y+t.y*n;var e=t.x*-n+t.y*y;var h=u*u;var a=e*e;var l=(h/(g*g))+(a/(f*f));if(l>1){var p=Math.sqrt(l);g*=p;f*=p}var q=g*g;var b=f*f;var j=q*a;var v=b*h;var p=(q*b-j-v)/(j+v);if(Math.abs(p)<k){p=0}var w=Math.sqrt(p);if(this.arcFlag==this.sweepFlag){w=-w
}var z=r.add(m).divide(2);var d=w*g*e/f;var o=w*-f*u/g;return new Point2D(d*y-o*n+z.x,d*n+o*y+z.y)};AbsoluteCurveto2.prototype=new AbsolutePathSegment();AbsoluteCurveto2.prototype.constructor=AbsoluteCurveto2;AbsoluteCurveto2.superclass=AbsolutePathSegment.prototype;function AbsoluteCurveto2(c,a,b){if(arguments.length>0){this.init("Q",c,a,b)}}AbsoluteCurveto2.prototype.getControlPoint=function(){return this.handles[0].point};AbsoluteCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point])
};AbsoluteCurveto3.prototype=new AbsolutePathSegment();AbsoluteCurveto3.prototype.constructor=AbsoluteCurveto3;AbsoluteCurveto3.superclass=AbsolutePathSegment.prototype;function AbsoluteCurveto3(c,a,b){if(arguments.length>0){this.init("C",c,a,b)}}AbsoluteCurveto3.prototype.getLastControlPoint=function(){return this.handles[1].point};AbsoluteCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point,this.handles[2].point])
};AbsoluteHLineto.prototype=new AbsolutePathSegment();AbsoluteHLineto.prototype.constructor=AbsoluteHLineto;AbsoluteHLineto.superclass=AbsolutePathSegment.prototype;function AbsoluteHLineto(c,a,b){if(arguments.length>0){this.init("H",c,a,b)}}AbsoluteHLineto.prototype.init=function(f,e,b,d){var c=d.getLastPoint();var a=new Array();a.push(e.pop(),c.y);AbsoluteHLineto.superclass.init.call(this,f,a,b,d)};AbsoluteHLineto.prototype.toString=function(){var a=new Array();var b="";if(this.previous.constructor!=this.constuctor){b=this.command
}return b+this.handles[0].point.x};AbsoluteLineto.prototype=new AbsolutePathSegment();AbsoluteLineto.prototype.constructor=AbsoluteLineto;AbsoluteLineto.superclass=AbsolutePathSegment.prototype;function AbsoluteLineto(c,a,b){if(arguments.length>0){this.init("L",c,a,b)}}AbsoluteLineto.prototype.toString=function(){var a=new Array();var b="";if(this.previous.constructor!=this.constuctor){if(this.previous.constructor!=AbsoluteMoveto){b=this.command}}return b+this.handles[0].point.toString()};AbsoluteLineto.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.previous.getLastPoint(),this.handles[0].point])
};AbsoluteMoveto.prototype=new AbsolutePathSegment();AbsoluteMoveto.prototype.constructor=AbsoluteMoveto;AbsoluteMoveto.superclass=AbsolutePathSegment.prototype;function AbsoluteMoveto(c,a,b){if(arguments.length>0){this.init("M",c,a,b)}}AbsoluteMoveto.prototype.toString=function(){return"M"+this.handles[0].point.toString()};AbsoluteSmoothCurveto2.prototype=new AbsolutePathSegment();AbsoluteSmoothCurveto2.prototype.constructor=AbsoluteSmoothCurveto2;AbsoluteSmoothCurveto2.superclass=AbsolutePathSegment.prototype;
function AbsoluteSmoothCurveto2(c,a,b){if(arguments.length>0){this.init("T",c,a,b)}}AbsoluteSmoothCurveto2.prototype.getControlPoint=function(){var c=this.previous.getLastPoint();var a;if(this.previous.command.match(/^[QqTt]$/)){var b=this.previous.getControlPoint();var d=b.subtract(c);a=c.subtract(d)}else{a=c}return a};AbsoluteSmoothCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.getControlPoint(),this.handles[0].point])
};AbsoluteSmoothCurveto3.prototype=new AbsolutePathSegment();AbsoluteSmoothCurveto3.prototype.constructor=AbsoluteSmoothCurveto3;AbsoluteSmoothCurveto3.superclass=AbsolutePathSegment.prototype;function AbsoluteSmoothCurveto3(c,a,b){if(arguments.length>0){this.init("S",c,a,b)}}AbsoluteSmoothCurveto3.prototype.getFirstControlPoint=function(){var c=this.previous.getLastPoint();var a;if(this.previous.command.match(/^[SsCc]$/)){var b=this.previous.getLastControlPoint();var d=b.subtract(c);a=c.subtract(d)
}else{a=c}return a};AbsoluteSmoothCurveto3.prototype.getLastControlPoint=function(){return this.handles[0].point};AbsoluteSmoothCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.getFirstControlPoint(),this.handles[0].point,this.handles[1].point])};RelativePathSegment.prototype=new AbsolutePathSegment();RelativePathSegment.prototype.constructor=RelativePathSegment;RelativePathSegment.superclass=AbsolutePathSegment.prototype;
function RelativePathSegment(d,c,a,b){if(arguments.length>0){this.init(d,c,a,b)}}RelativePathSegment.prototype.init=function(g,f,a,c){this.command=g;this.owner=a;this.previous=c;this.handles=new Array();var e;if(this.previous){e=this.previous.getLastPoint()}else{e=new Point2D(0,0)}var b=0;while(b<f.length){var d=new Handle(e.x+f[b],e.y+f[b+1],a);this.handles.push(d);b+=2}};RelativePathSegment.prototype.toString=function(){var c=new Array();var e="";var d;if(this.previous){d=this.previous.getLastPoint()
}else{d=new Point2D(0,0)}if(this.previous==null||this.previous.constructor!=this.constructor){e=this.command}for(var b=0;b<this.handles.length;b++){var a=this.handles[b].point.subtract(d);c.push(a.toString())}return e+c.join(" ")};RelativeClosePath.prototype=new RelativePathSegment();RelativeClosePath.prototype.constructor=RelativeClosePath;RelativeClosePath.superclass=RelativePathSegment.prototype;function RelativeClosePath(c,a,b){if(arguments.length>0){this.init("z",c,a,b)}}RelativeClosePath.prototype.getLastPoint=function(){var b=this.previous;
var a;while(b){if(b.command.match(/^[mMzZ]$/)){a=b.getLastPoint();break}b=b.previous}return a};RelativeClosePath.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.previous.getLastPoint(),this.getLastPoint()])};RelativeCurveto2.prototype=new RelativePathSegment();RelativeCurveto2.prototype.constructor=RelativeCurveto2;RelativeCurveto2.superclass=RelativePathSegment.prototype;function RelativeCurveto2(c,a,b){if(arguments.length>0){this.init("q",c,a,b)}}RelativeCurveto2.prototype.getControlPoint=function(){return this.handles[0].point
};RelativeCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point])};RelativeCurveto3.prototype=new RelativePathSegment();RelativeCurveto3.prototype.constructor=RelativeCurveto3;RelativeCurveto3.superclass=RelativePathSegment.prototype;function RelativeCurveto3(c,a,b){if(arguments.length>0){this.init("c",c,a,b)}}RelativeCurveto3.prototype.getLastControlPoint=function(){return this.handles[1].point
};RelativeCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point,this.handles[2].point])};RelativeLineto.prototype=new RelativePathSegment();RelativeLineto.prototype.constructor=RelativeLineto;RelativeLineto.superclass=RelativePathSegment.prototype;function RelativeLineto(c,a,b){if(arguments.length>0){this.init("l",c,a,b)}}RelativeLineto.prototype.toString=function(){var b=new Array();var d="";
var c;var a;if(this.previous){c=this.previous.getLastPoint()}else{c=new Point(0,0)}a=this.handles[0].point.subtract(c);if(this.previous.constructor!=this.constuctor){if(this.previous.constructor!=RelativeMoveto){cmd=this.command}}return cmd+a.toString()};RelativeLineto.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.previous.getLastPoint(),this.handles[0].point])};RelativeMoveto.prototype=new RelativePathSegment();RelativeMoveto.prototype.constructor=RelativeMoveto;
RelativeMoveto.superclass=RelativePathSegment.prototype;function RelativeMoveto(c,a,b){if(arguments.length>0){this.init("m",c,a,b)}}RelativeMoveto.prototype.toString=function(){return"m"+this.handles[0].point.toString()};RelativeSmoothCurveto2.prototype=new RelativePathSegment();RelativeSmoothCurveto2.prototype.constructor=RelativeSmoothCurveto2;RelativeSmoothCurveto2.superclass=RelativePathSegment.prototype;function RelativeSmoothCurveto2(c,a,b){if(arguments.length>0){this.init("t",c,a,b)}}RelativeSmoothCurveto2.prototype.getControlPoint=function(){var c=this.previous.getLastPoint();
var a;if(this.previous.command.match(/^[QqTt]$/)){var b=this.previous.getControlPoint();var d=b.subtract(c);a=c.subtract(d)}else{a=c}return a};RelativeSmoothCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.getControlPoint(),this.handles[0].point])};RelativeSmoothCurveto3.prototype=new RelativePathSegment();RelativeSmoothCurveto3.prototype.constructor=RelativeSmoothCurveto3;RelativeSmoothCurveto3.superclass=RelativePathSegment.prototype;
function RelativeSmoothCurveto3(c,a,b){if(arguments.length>0){this.init("s",c,a,b)}}RelativeSmoothCurveto3.prototype.getFirstControlPoint=function(){var c=this.previous.getLastPoint();var a;if(this.previous.command.match(/^[SsCc]$/)){var b=this.previous.getLastControlPoint();var d=b.subtract(c);a=c.subtract(d)}else{a=c}return a};RelativeSmoothCurveto3.prototype.getLastControlPoint=function(){return this.handles[0].point};RelativeSmoothCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.getFirstControlPoint(),this.handles[0].point,this.handles[1].point])
};Polygon.prototype=new Shape();Polygon.prototype.constructor=Polygon;Polygon.superclass=Shape.prototype;function Polygon(a){if(arguments.length>0){this.init(a)}}Polygon.prototype.init=function(d){if(d.localName=="polygon"){Polygon.superclass.init.call(this,d);var c=d.getAttributeNS(null,"points").split(/[\s,]+/);this.handles=new Array();for(var b=0;b<c.length;b+=2){var a=parseFloat(c[b]);var e=parseFloat(c[b+1]);this.handles.push(new Handle(a,e,this))}}else{throw new Error("Polygon.init: Invalid SVG Node: "+d.localName)
}};Polygon.prototype.realize=function(){if(this.svgNode!=null){for(var a=0;a<this.handles.length;a++){this.handles[a].realize();this.handles[a].show(false)}this.svgNode.addEventListener("mousedown",this,false)}};Polygon.prototype.refresh=function(){var b=new Array();for(var a=0;a<this.handles.length;a++){b.push(this.handles[a].point.toString())}this.svgNode.setAttributeNS(null,"points",b.join(" "))};Polygon.prototype.registerHandles=function(){for(var a=0;a<this.handles.length;a++){mouser.register(this.handles[a])
}};Polygon.prototype.unregisterHandles=function(){for(var a=0;a<this.handles.length;a++){mouser.unregister(this.handles[a])}};Polygon.prototype.selectHandles=function(a){for(var b=0;b<this.handles.length;b++){this.handles[b].select(a)}};Polygon.prototype.showHandles=function(b){for(var a=0;a<this.handles.length;a++){this.handles[a].show(b)}};Polygon.prototype.pointInPolygon=function(a){var e=this.handles.length;var b=0;var c;var g=this.handles[0].point;for(var d=1;d<=e;d++){var f=this.handles[d%e].point;
if(a.y>Math.min(g.y,f.y)){if(a.y<=Math.max(g.y,f.y)){if(a.x<=Math.max(g.x,f.x)){if(g.y!=f.y){c=(a.y-g.y)*(f.x-g.x)/(f.y-g.y)+g.x;if(g.x==f.x||a.x<=c){b++}}}}}g=f}return(b%2==1)};Polygon.prototype.getIntersectionParams=function(){var b=new Array();for(var a=0;a<this.handles.length;a++){b.push(this.handles[a].point)}return new IntersectionParams("Polygon",[b])};Polygon.prototype.getArea=function(){var e=0;var d=this.handles.length;var g=0;var f=0;for(var c=0;c<d;c++){var b=this.handles[c].point;var a=this.handles[(c+1)%d].point;
e+=(b.x*a.y-a.x*b.y)}return e/2};Polygon.prototype.getCentroid=function(){var e=this.handles.length;var d=6*this.getArea();var a=0;var c=0;for(var b=0;b<e;b++){var g=this.handles[b].point;var f=this.handles[(b+1)%e].point;var h=(g.x*f.y-f.x*g.y);a+=(g.x+f.x)*h;c+=(g.y+f.y)*h}return new Point2D(a/d,c/d)};Polygon.prototype.isClockwise=function(){return this.getArea()<0};Polygon.prototype.isCounterClockwise=function(){return this.getArea()>0};Polygon.prototype.isConcave=function(){var d=0;var b=0;var a=this.handles.length;
for(var c=0;c<a;c++){var k=this.handles[c].point;var j=this.handles[(c+1)%a].point;var g=this.handles[(c+2)%a].point;var h=Vector2D.fromPoints(k,j);var f=Vector2D.fromPoints(j,g);var e=h.cross(f);if(e<0){b++}else{d++}}return(b!=0&&d!=0)};Polygon.prototype.isConvex=function(){return !this.isConcave()};Rectangle.prototype=new Shape();Rectangle.prototype.constructor=Rectangle;Rectangle.superclass=Shape.prototype;function Rectangle(a){if(arguments.length>0){this.init(a)}}Rectangle.prototype.init=function(d){if(d.localName=="rect"){Rectangle.superclass.init.call(this,d);
var b=parseFloat(d.getAttributeNS(null,"x"));var e=parseFloat(d.getAttributeNS(null,"y"));var c=parseFloat(d.getAttributeNS(null,"width"));var a=parseFloat(d.getAttributeNS(null,"height"));this.p1=new Handle(b,e,this);this.p2=new Handle(b+c,e+a,this)}else{throw new Error("Rectangle.init: Invalid SVG Node: "+d.localName)}};Rectangle.prototype.realize=function(){if(this.svgNode!=null){this.p1.realize();this.p2.realize();this.p1.show(false);this.p2.show(false);this.svgNode.addEventListener("mousedown",this,false)
}};Rectangle.prototype.refresh=function(){var b=this.p1.point.min(this.p2.point);var a=this.p1.point.max(this.p2.point);this.svgNode.setAttributeNS(null,"x",b.x);this.svgNode.setAttributeNS(null,"y",b.y);this.svgNode.setAttributeNS(null,"width",a.x-b.x);this.svgNode.setAttributeNS(null,"height",a.y-b.y)};Rectangle.prototype.registerHandles=function(){mouser.register(this.p1);mouser.register(this.p2)};Rectangle.prototype.unregisterHandles=function(){mouser.unregister(this.p1);mouser.unregister(this.p2)
};Rectangle.prototype.selectHandles=function(a){this.p1.select(a);this.p2.select(a)};Rectangle.prototype.showHandles=function(a){this.p1.show(a);this.p2.show(a)};Rectangle.prototype.getIntersectionParams=function(){return new IntersectionParams("Rectangle",[this.p1.point,this.p2.point])};
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(d){var b=["DOMMouseScroll","mousewheel"];
if(d.event.fixHooks){for(var a=b.length;a;){d.event.fixHooks[b[--a]]=d.event.mouseHooks}}d.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=b.length;e;){this.addEventListener(b[--e],c,false)}}else{this.onmousewheel=c}},teardown:function(){if(this.removeEventListener){for(var e=b.length;e;){this.removeEventListener(b[--e],c,false)}}else{this.onmousewheel=null}}};d.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)
}});function c(k){var h=k||window.event,g=[].slice.call(arguments,1),l=0,j=true,f=0,e=0;k=d.event.fix(h);k.type="mousewheel";if(h.wheelDelta){l=h.wheelDelta/120}if(h.detail){l=-h.detail/3}e=l;if(h.axis!==undefined&&h.axis===h.HORIZONTAL_AXIS){e=0;f=-1*l}if(h.wheelDeltaY!==undefined){e=h.wheelDeltaY/120}if(h.wheelDeltaX!==undefined){f=-1*h.wheelDeltaX/120}g.unshift(k,l,f,e);return(d.event.dispatch||d.event.handle).apply(this,g)}})(jQuery);(function($){var reg={format:{},renderer:{},layout:{},exporter:{},core:{},collection:{}};
var subreg={format:{},renderer:{},layout:{},exporter:{}};var quiet=false;var debug=false;var console={debug:function(){if(quiet||!debug||$.browser.msie){return}if(window.console!=null&&window.console.debug!=null){window.console.debug.apply(window.console,arguments)}else{if(window.console!=null&&window.console.log!=null){window.console.log.apply(window.console,arguments)}}},log:function(){if(quiet||$.browser.msie){return}if(window.console!=null&&window.console.log!=null){window.console.log.apply(window.console,arguments)
}},warn:function(){if(quiet||$.browser.msie){return}if(window.console!=null&&window.console.warn!=null){window.console.warn.apply(window.console,arguments)}else{console.log.apply(window.console,arguments)}},error:function(){if(quiet||$.browser.msie){return}if(window.console!=null&&window.console.error!=null){window.console.error.apply(window.console,arguments);if(window.console.trace!=null){window.console.trace()}}else{console.log.apply(window.console,arguments);throw"Cytoscape Web encountered the previously logged error";
if(window.console.trace!=null){window.console.trace()}}}};function isString(obj){return obj!=null&&typeof obj==typeof""}function isFunction(obj){return obj!=null&&typeof obj==typeof function(){}}function isArray(obj){return obj!=null&&obj instanceof Array}function isPlainObject(obj){return obj!=null&&typeof obj==typeof{}&&!isArray(obj)}function isNumber(obj){return obj!=null&&typeof obj==typeof 1&&!isNaN(obj)}function isColor(obj){return obj!=null&&typeof obj==typeof""&&$.Color(obj).toString()!=""
}function isBoolean(obj){return obj!=null&&typeof obj==typeof true}$.fn.cytoscapeweb=function(opts){if(opts=="get"){var data=$(this).data("cytoscapeweb");return data.cy}else{if(isFunction(opts)){var ready=opts;var data=$(this).data("cytoscapeweb");if(data!=null&&data.cy!=null&&data.ready){ready.apply(data.cy,[])}else{if(data==null){data={}}if(data.readies==null){data.readies=[]}data.readies.push(ready);$(this).data("cytoscapeweb",data)}}else{if(isPlainObject(opts)){return $(this).each(function(){var options=$.extend({},opts,{container:$(this)});
$.cytoscapeweb(options)})}else{var rets=[];var args=[];for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}$(this).each(function(){var data=$(this).data("cytoscapeweb");var cy=data.cy;var fnName=opts;if(cy!=null&&isFunction(cy[fnName])){var ret=cy[fnName].apply(cy,args);rets.push(ret)}});if(rets.length==1){rets=rets[0]}else{if(rets.length==0){rets=$(this)}}return rets}}}};$.cytoscapeweb=function(opts){if(isPlainObject(opts)){var defaults={layout:{name:"grid"},renderer:{name:"svg"},style:{}};
var options=$.extend(true,{},defaults,opts);if(options.container==null){console.error("Cytoscape Web must be called on an element; specify `container` in options or call on selector directly with jQuery, e.g. $('#foo').cy({...});");return}else{if($(options.container).size()>1){console.error("Cytoscape Web can not be called on multiple elements in the functional call style; use the jQuery selector style instead, e.g. $('.foo').cy({...});");return}}var structs={renderer:null,style:options.style,nodes:{},edges:{},nodeToEdges:{},edgeSiblings:{},continuousMapperBounds:{nodes:{},edges:{}},continuousMapperUpdates:[],once:[],live:{},selectors:{},listeners:{},animation:{elements:null}};
function parallelEdgeIds(node1Id,node2Id){var id1=node1Id<node2Id?node1Id:node2Id;var id2=id1==node1Id?node2Id:node1Id;return{id1:id1,id2:id2}}function addParallelEdgeToMap(element){var ids=parallelEdgeIds(element._private.data.source,element._private.data.target);var id1=ids.id1;var id2=ids.id2;if(structs.edgeSiblings[id1]==null){structs.edgeSiblings[id1]={}}if(structs.edgeSiblings[id1][id2]==null){structs.edgeSiblings[id1][id2]={}}var siblings=structs.edgeSiblings[id1][id2];siblings[element._private.data.id]=element
}function removeParallelEdgeFromMap(element){var ids=parallelEdgeIds(element._private.data.source,element._private.data.target);var id1=ids.id1;var id2=ids.id2;if(structs.edgeSiblings[id1]!=null&&structs.edgeSiblings[id1][id2]!=null){delete structs.edgeSiblings[id1][id2][element._private.data.id]}}function getParallelEdgesForEdge(element){var ids=parallelEdgeIds(element._private.data.source,element._private.data.target);var id1=ids.id1;var id2=ids.id2;return structs.edgeSiblings[id1][id2]}function getEdgesBetweenNodes(node1,node2){var ids=parallelEdgeIds(node1._private.data.id,node2._private.data.id);
var id1=ids.id1;var id2=ids.id2;return structs.edgeSiblings[id1][id2]}function copy(obj){if(obj==null){return obj}if(isArray(obj)){return $.extend(true,[],obj)}else{if(isPlainObject(obj)){return $.extend(true,{},obj)}else{return obj}}}function getContinuousMapperUpdates(){return structs.continuousMapperUpdates}function clearContinuousMapperUpdates(){structs.continuousMapperUpdates=[]}function addContinuousMapperBounds(element,name,val){var group=element._private.group;if(isNumber(val)){if(structs.continuousMapperBounds[group][name]==null){structs.continuousMapperBounds[group][name]={min:val,max:val,vals:[]}
}var bounds=structs.continuousMapperBounds[group][name];var vals=bounds.vals;var inserted=false;var oldMin=null,oldMax=null;if(vals.length>0){oldMin=vals[0];oldMax=vals[vals.length-1]}for(var i=0;i<vals.length;i++){if(val<=vals[i]){vals.splice(i,0,val);inserted=true;break}}if(!inserted){vals.push(val)}bounds.min=vals[0];bounds.max=vals[vals.length-1];if(oldMin!=bounds.min||oldMax!=bounds.max){structs.continuousMapperUpdates.push({group:element.group(),element:element})}}}function updateContinuousMapperBounds(element,name,oldVal,newVal){var group=element._private.group;
var bounds=structs.continuousMapperBounds[group][name];if(bounds==null){addContinuousMapperBounds(element,name,newVal);return}var vals=bounds.vals;var oldMin=null,oldMax=null;if(vals.length>0){oldMin=vals[0];oldMax=vals[vals.length-1]}removeContinuousMapperBounds(element,name,oldVal);addContinuousMapperBounds(element,name,newVal);if(oldMin!=bounds.min||oldMax!=bounds.max){structs.continuousMapperUpdates.push({group:element.group(),element:element})}}function removeContinuousMapperBounds(element,name,val){var group=element._private.group;
var bounds=structs.continuousMapperBounds[group][name];if(bounds==null){return}var oldMin=null,oldMax=null;var vals=bounds.vals;if(vals.length>0){oldMin=vals[0];oldMax=vals[vals.length-1]}for(var i=0;i<vals.length;i++){if(val==vals[i]){vals.splice(i,1);break}}if(vals.length>0){bounds.min=vals[0];bounds.max=vals[vals.length-1]}else{bounds.min=null;bounds.max=null}if(oldMin!=bounds.min||oldMax!=bounds.max){structs.continuousMapperUpdates.push({group:element.group(),element:element})}}var idFactory={prefix:{nodes:"n",edges:"e"},id:{nodes:0,edges:0},generate:function(group,tryThisId){var id=tryThisId!=null?tryThisId:this.prefix[group]+this.id[group];
while(structs[group][id]!=null){id=this.prefix[group]+(++this.id[group])}return id}};function isElementOrCollection(e){return e instanceof CyElement||e instanceof CyCollection}var CyElement=function(params){var self=this;if(params.group!="nodes"&&params.group!="edges"){console.error("An element must be of type `nodes` or `edges`; you specified `%s`",params.group);return}this._private={data:copy(params.data)||{},position:copy(params.position)||{},listeners:{},group:params.group,bypass:copy(params.bypass)||{},style:{},removed:true,selected:params.selected?true:false,locked:params.locked?true:false,grabbed:false,grabbable:params.grabbable||params.grabbable===undefined?true:false,classes:{},animation:{current:[],queue:[]},renderer:{},scratch:{}};
if(params.renderedPosition!=null){this._private.position=renderer.modelPoint(params.renderedPosition)}if(isString(params.classes)){$.each(params.classes.split(/\s+/),function(i,cls){if(cls!=""){self._private.classes[cls]=true}})}this.restore()};CyElement.prototype.scratch=function(name,val){var self=this;var fields=name.split(".");function set(){var obj=self._private.scratch;$.each(fields,function(i,field){if(i==fields.length-1){return}obj=obj[field]});var lastField=fields[fields.length-1];obj[lastField]=val
}function get(){var obj=self._private.scratch;$.each(fields,function(i,field){obj=obj[field]});return obj}if(val===undefined){return get()}else{set()}return this};CyElement.prototype.removeScratch=function(name){var self=this;eval("delete self._private.scratch."+name+";");return this};CyElement.prototype.json=function(){var p=this._private;var json=copy({data:p.data,position:p.position,group:p.group,bypass:p.bypass,removed:p.removed,selected:p.selected,locked:p.locked,grabbed:p.grabbed,grabbable:p.grabbable,classes:"",scratch:p.scratch});
var classes=[];$.each(p.classes,function(cls,bool){classes.push(cls)});$.each(classes,function(i,cls){json.classes+=cls+(i<classes.length-1?" ":"")});return json};CyElement.prototype.element=function(){return this};CyElement.prototype.collection=function(){return new CyCollection([this])};CyElement.prototype.grabbed=function(){return this._private.grabbed};CyElement.prototype.group=function(){return this._private.group};CyElement.prototype.addClass=function(classes){classes=classes.split(/\s+/);var self=this;
var added=false;$.each(classes,function(i,cls){if(cls==null||cls==""){return}added=added||self._private.classes[cls]===undefined;self._private.classes[cls]=true});if(added){self.rtrigger("class")}return self};CyElement.prototype.hasClass=function(className){return this._private.classes[className]==true};CyElement.prototype.toggleClass=function(classes,toggle){classes=classes.split(/\s+/);var self=this;var toggled=false;function remove(cls){toggled=toggled||self._private.classes[cls]!==undefined;delete self._private.classes[cls]
}function add(cls){toggled=toggled||self._private.classes[cls]===undefined;self._private.classes[cls]=true}$.each(classes,function(i,cls){if(toggle===undefined){if(self.hasClass(cls)){remove(cls)}else{add(cls)}}else{if(toggle){add(cls)}else{remove(cls)}}});if(toggled){self.rtrigger("class")}return self};CyElement.prototype.removeClass=function(classes){classes=classes.split(/\s+/);var self=this;var removed=false;$.each(classes,function(i,cls){removed=removed||self._private.classes[cls]!==undefined;
delete self._private.classes[cls]});if(removed){self.rtrigger("class")}return self};CyElement.prototype.removed=function(){return this._private.removed};CyElement.prototype.restore=function(){if(!this.removed()){}if(this._private.data.id==null){this._private.data.id=idFactory.generate(this._private.group)}else{if(structs[this._private.group][this._private.data.id]!=null){console.error("Can not create element: an element in the visualisation in group `%s` already has ID `%s`",this._private.group,this._private.data.id);
return this}}if(this.isEdge()){var fields=["source","target"];for(var i=0;i<fields.length;i++){var field=fields[i];var val=this._private.data[field];if(val==null||val==""){console.error("Can not create edge with id `%s` since it has no `%s` attribute set in `data` (must be non-empty value)",this._private.data.id,field);return this}else{if(structs.nodes[val]==null){console.error("Can not create edge with id `%s` since it specifies non-existant node as its `%s` attribute with id `%s`",this._private.data.id,field,val);
return this}}}addParallelEdgeToMap(this)}this._private.removed=false;structs[this._private.group][this._private.data.id]=this;if(this._private.group=="edges"){if(structs.nodeToEdges[this._private.data.source]==null){structs.nodeToEdges[this._private.data.source]={}}if(structs.nodeToEdges[this._private.data.target]==null){structs.nodeToEdges[this._private.data.target]={}}structs.nodeToEdges[this._private.data.source][this._private.data.id]=this;structs.nodeToEdges[this._private.data.target][this._private.data.id]=this
}else{if(this._private.group=="nodes"){structs.nodeToEdges[this._private.data.id]={}}}var self=this;$.each(this._private.data,function(name,val){addContinuousMapperBounds(self,name,val)});this.rtrigger("add");return this};CyElement.prototype.remove=function(){if(!this._private.removed){delete structs[this._private.group][this._private.data.id];this._private.removed=true;var group=this._private.group;var self=this;if(this._private.group=="edges"){delete structs.nodeToEdges[this._private.data.source][this._private.data.id];
delete structs.nodeToEdges[this._private.data.target][this._private.data.id];removeParallelEdgeFromMap(this)}else{if(this._private.group=="nodes"){$.each(structs.nodeToEdges[this._private.data.id],function(id,edge){edge.remove()});structs.nodeToEdges[this._private.data.id]={}}}$.each(this._private.data,function(attr,val){removeContinuousMapperBounds(self,attr,val)});notify({type:"remove",collection:[this]});this.rtrigger("remove")}return this};function switchFunction(params){return function(fn){if(isFunction(fn)){this.bind(params.event,fn)
}else{if(this._private[params.field]!=params.value){this._private[params.field]=params.value;this.rtrigger(params.event)}}return this}}CyElement.prototype.locked=function(){return this._private.locked};CyElement.prototype.lock=switchFunction({event:"lock",field:"locked",value:true});CyElement.prototype.unlock=switchFunction({event:"unlock",field:"locked",value:false});CyElement.prototype.grabbable=function(){return this._private.grabbable};CyElement.prototype.grabify=switchFunction({event:"grabify",field:"grabbable",value:true});
CyElement.prototype.ungrabify=switchFunction({event:"ungrabify",field:"grabbable",value:false});function setterGetterFunction(params){return function(key,val){if(isFunction(key)){var handler=key;this.bind(params.event,handler)}else{if(isFunction(val)){var data=key;var handler=val;this.bind(params.event,data,handler)}else{if(isString(key)){if(val===undefined){return copy(this._private[params.field][key])}else{this._private[params.field][key]=copy(val);this.rtrigger(params.event)}}else{if(isPlainObject(key)){var map=key;
var current=this._private[params.field];this._private[params.field]=$.extend(true,{},current,map);this.rtrigger(params.event)}else{if(key===undefined){return copy(this._private[params.field])}}}}}return this}}function removerFunction(params){return function(key){var self=this;if(key===undefined){this._private[params.field]={}}else{var keys=key.split(/\s+/);for(var i=0;i<keys.length;i++){delete this._private[params.field][keys[i]]}}if(params.event!=null){this.rtrigger(params.event)}return this}}CyElement.prototype.removeBypass=removerFunction({field:"bypass",event:"bypass"});
CyElement.prototype.bypass=setterGetterFunction({field:"bypass",event:"bypass"});CyElement.prototype.data=function(attr,val){var ret;var self=this;if(attr===undefined){return copy(this._private.data)}if(attr=="id"&&val!==undefined){console.error("Can not change ID of element with group `%s` and ID `%s`",this._private.group,this._private.data.id);return this}else{if(isFunction(attr)){var handler=attr;this.bind("data",handler);ret=this}else{if(isFunction(val)){var data=attr;var handler=val;this.bind("data",data,handler);
ret=this}else{if(isPlainObject(attr)){var newValObj=attr;for(var field in newValObj){var val=newValObj[field];if(field=="id"||(this._private.group=="edges"&&(field=="source"||field=="target"))){console.error("Can not change immutable field `%s` for element with group `%s` and ID `%s` to `%o`",field,this._private.group,this._private.data.id,val)}else{updateContinuousMapperBounds(self,field,self._private.data[field],val);self._private.data[field]=copy(val)}}this.rtrigger("data");ret=this}else{if(val===undefined){ret=this._private.data[attr];
ret=(typeof ret=="object"?copy(ret):ret)}else{if(attr=="id"){console.error("Can not change `%s` of element with ID %s --- you can not change IDs",attr,this._private.data.id);return this}if(this._private.group=="edges"){if(attr=="source"||attr=="target"){console.error("Can not change `%s` of edge with ID %s --- you can not change IDs",attr,this._private.data.id);return this}}var oldVal=this._private.data[attr];this._private.data[attr]=(typeof val=="object"?copy(val):val);ret=this;updateContinuousMapperBounds(this,attr,oldVal,val);
this.rtrigger("data")}}}}}return ret};CyElement.prototype.removeData=function(field){if(field==undefined){var oldData=this._private.data;var self=this;$.each(this._private.data,function(attr,val){removeContinuousMapperBounds(self,attr,val)});if(this.isNode()){this._private.data={id:oldData.id}}else{if(this.isEdge()){this._private.data={id:oldData.id,source:oldData.source,target:oldData.target}}}}else{if(field=="id"){console.error("You can not delete the `id` data field; tried to delete on element with group `%s` and ID `%s`",this._private.group,this._private.data.id);
return this}if(this.isEdge()&&(field=="source"||field=="target")){console.error("You can not delete the `%s` data field; tried to delete on edge `%s`",field,this._private.data.id);return this}removeContinuousMapperBounds(this,field,this._private.data[field]);delete this._private.data[field]}this.rtrigger("data");return this};CyElement.prototype.target=function(){if(this.isNode()){console.error("Can not call `target` on node `%s`; only edges have targets",this._private.data.id);return this}return structs.nodes[this._private.data.target]
};CyElement.prototype.source=function(){if(this.isNode()){console.error("Can not call `source` on node `%s`; only edges have sources",this._private.data.id);return this}return structs.nodes[this._private.data.source]};CyElement.prototype.connectedNodes=function(){if(this.isNode()){console.error("Can not call `connectedNodes` on node `%s`; only edges have a source and target",this._private.data.id);return this}var source=structs.nodes[this._private.data.source];var target=structs.nodes[this._private.data.target];
return source.collection().add(target)};CyElement.prototype.edgesWith=function(otherNode){if(otherNode.isEdge()){console.error("Can not call `edgesWith` on edge `%s`; only nodes have edges",this._private.data.id);return this}var nodes=otherNode.collection();var elements=[];for(var i=0;i<nodes.size();i++){var map=getEdgesBetweenNodes(this,nodes[i]);for(var i in map){var element=map[i];elements.push(element)}}return new CyCollection(elements)};CyElement.prototype.parallelEdges=function(selector){if(this.isNode()){console.error("Can not call `parallelEdges` on node `%s`; only edges have sources",this._private.data.id);
return this}var map=getParallelEdgesForEdge(this);var elements=[];for(var i in map){var element=map[i];elements.push(element)}var collection=new CyCollection(elements);if(isString(selector)){collection=new CySelector(selector).filter(collection)}return collection};CyElement.prototype.position=function(val){var self=this;if(val===undefined){if(this.isNode()){return copy(this._private.position)}else{console.warn("Can not get position for edge with ID `%s`; edges have no position",this._private.data.id);
return null}}else{if(isFunction(val)){var fn=val;this.bind("position",fn)}else{if(this.isEdge()){console.warn("Can not move edge with ID `%s`; edges can not be moved",this._private.data.id)}else{if(this.locked()){console.warn("Can not move locked node with ID `%s`",this._private.data.id)}else{if(isString(val)){var param=arguments[0];var value=arguments[1];if(value===undefined){return this._private.position[param]}else{this._private.position[param]=copy(value)}}else{if(isPlainObject(val)){$.each(val,function(k,v){self._private.position[k]=copy(v)
});this.rtrigger("position")}else{console.error("Can not set position on node `%s` with non-object `%o`",this._private.data.id,val)}}}}}}return this};CyElement.prototype.positions=function(fn){var positionOpts=fn.apply(this,[0,this]);if(isPlainObject(positionOpts)){this.position(positionOpts)}};CyElement.prototype.animated=function(){return this._private.animation.current.length>0};CyElement.prototype.clearQueue=function(){this._private.animation.queue=[]};CyElement.prototype.delay=function(time){this.animate({delay:time},{duration:time});
return this};CyElement.prototype.animate=function(properties,params){var self=this;var callTime=+new Date;var startPosition=copy(self._private.position);var startStyle=copy(self.style());if(self.animated()&&(params.queue===undefined||params.queue)){enqueue()}else{run()}params=$.extend({},{duration:400},params);switch(params.duration){case"slow":params.duration=600;break;case"fast":params.duration=200;break}if(properties==null||(properties.position==null&&properties.bypass==null&&properties.delay==null)){return
}var q;function enqueue(){q=self._private.animation.queue;add()}function run(){q=self._private.animation.current;add()}function add(){q.push({properties:properties,params:params,callTime:callTime,startPosition:startPosition,startStyle:startStyle});structs.animation.elements=structs.animation.elements.add(self)}return this};CyElement.prototype.stop=function(clearQueue,jumpToEnd){var self=this;$.each(self._private.animation.current,function(i,animation){if(jumpToEnd){$.each(animation.properties,function(propertyName,property){$.each(property,function(field,value){self._private[propertyName][field]=value
})})}});self._private.animation.current=[];if(clearQueue){self._private.animation.queue=[]}notify({collection:self.collection(),type:"draw"});return this};function startAnimationLoop(){var stepDelay=10;var useTimeout=false;var useRequestAnimationFrame=true;structs.animation.elements=new CyCollection();var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(requestAnimationFrame==null||!useRequestAnimationFrame){requestAnimationFrame=function(fn){window.setTimeout(function(){fn(+new Date)
},stepDelay)}}var containerDom=cy.container()[0];function globalAnimationStep(){function exec(){requestAnimationFrame(function(now){handleElements(now);globalAnimationStep()},containerDom)}if(useTimeout){setTimeout(function(){exec()},stepDelay)}else{exec()}}globalAnimationStep();function handleElements(now){structs.animation.elements.each(function(i,ele){try{ele=ele.element();var current=ele._private.animation.current;var queue=ele._private.animation.queue;if(current.length==0){var q=queue;var next=q.length>0?q.shift():null;
if(next!=null){next.callTime=+new Date;current.push(next)}}$.each(current,function(i,ani){step(ele,ani,now)});var completes=[];for(var i=0;i<current.length;i++){if(current[i].done){completes.push(current[i].params.complete);current.splice(i,1);i--}}$.each(completes,function(i,fn){if(isFunction(complete)){complete.apply(ele)}})}catch(e){}});if(structs.animation.elements.size()>0){notify({type:"draw",collection:structs.animation.elements})}structs.animation.elements=structs.animation.elements.filter(function(){var ele=this;
var queue=ele._private.animation.queue;var current=ele._private.animation.current;return current.length>0||queue.length>0})}function step(self,animation,now){var properties=animation.properties;var params=animation.params;var startTime=animation.callTime;var percent;if(params.duration==0){percent=1}else{percent=Math.min(1,(now-startTime)/params.duration)}function update(p){if(p.end!=null){var start=p.start;var end=p.end;$.each(end,function(name,val){if(valid(start[name],end[name])){self._private[p.field][name]=ease(start[name],end[name],percent)
}})}}if(properties.delay==null){update({end:properties.position,start:animation.startPosition,field:"position"});update({end:properties.bypass,start:animation.startStyle,field:"bypass"})}if(isFunction(params.step)){params.step.apply(self,[now])}if(percent>=1){animation.done=true}return percent}function valid(start,end){if(start==null||end==null){return false}if(isNumber(start)&&isNumber(end)){return true}else{if(isColor(start)&&isColor(end)){return true}}return false}function ease(start,end,percent){if(isNumber(start)&&isNumber(end)){return start+(end-start)*percent
}else{if(isColor(start)&&isColor(end)){var c1=$.Color(start).fix().toRGB();var c2=$.Color(end).fix().toRGB();function ch(ch1,ch2){var diff=ch2-ch1;var min=ch1;return Math.round(percent*diff+min)}var r=ch(c1.red(),c2.red());var g=ch(c1.green(),c2.green());var b=ch(c1.blue(),c2.blue());return $.Color([r,g,b],"RGB").toHEX().toString()}}return undefined}}CyElement.prototype.show=function(){renderer.showElements(this.collection());return this};CyElement.prototype.hide=function(){renderer.hideElements(this.collection());
return this};CyElement.prototype.visible=function(){return renderer.elementIsVisible(this)};CyElement.prototype.renderedPosition=function(coord,val){if(this.isEdge()){$.cytoscapeweb("warn","Can not access rendered position for edge `"+this._private.data.id+"`; edges have no position");return null}var pos=renderer.renderedPosition(this);if(coord===undefined){return pos}else{if(isString(coord)){if(val===undefined){return pos[coord]}else{pos[coord]=val;this.position(renderer.modelPoint(pos))}}else{if(isPlainObject(coord)){pos=$.extend(true,{},pos,coord);
this.position(renderer.modelPoint(pos))}}}return this};CyElement.prototype.renderedDimensions=function(dimension){var dim=renderer.renderedDimensions(this);if(dimension===undefined){return dim}else{return dim[dimension]}};CyElement.prototype.style=function(){return copy(this._private.style)};function bind(opts){return function(events,data,callback){var self=this;if(callback===undefined){callback=data;data=undefined}var defaults={one:false,data:data};var options=$.extend({},defaults,opts);$.each(events.split(/\s+/),function(i,event){if(event==""){return this
}if(self._private.listeners[event]==null){self._private.listeners[event]=[]}options.callback=callback;self._private.listeners[event].push(options)});return this}}CyElement.prototype.bind=bind({one:false});CyElement.prototype.one=bind({one:true});CyElement.prototype.live=function(){console.error("You can not call `live` on an element");return this};CyElement.prototype.die=function(){console.error("You can not call `die` on an element");return this};CyElement.prototype.on=function(events,data,callback){return this.bind(events,data,callback)
};CyElement.prototype.off=function(events,callback){return this.unbind(events,callback)};CyElement.prototype.unbind=function(events,callback){var self=this;if(events===undefined){self._private.listeners={};return this}$.each(events.split(/\s+/),function(j,event){if(event==""){return this}var listeners=self._private.listeners[event];if(listeners!=null){for(var i=0;i<listeners.length;i++){var listener=listeners[i];if(callback==null||callback==listener.callback){listeners.splice(i,1);i--}}}});return this
};CyElement.prototype.rtrigger=function(event,data){if(!this.removed()){notify({type:event,collection:[this]})}this.trigger(event,data)};CyElement.prototype.trigger=function(event,data){var self=this;var type=isPlainObject(event)?event.type:event;var listeners=this._private.listeners[type];function fire(listener,eventData){if(listener!=null&&isFunction(listener.callback)){var eventData=isPlainObject(event)?event:jQuery.Event(type);eventData.data=listener.data;eventData.cy=eventData.cytoscapeweb=cy;
var args=[eventData];if(data!=null){$.each(data,function(i,arg){args.push(arg)})}listener.callback.apply(self,args)}}if(listeners!=null){$.each(listeners,function(i,listener){fire(listener)});for(var i=0;i<listeners.length;i++){if(listeners[i].one){listeners.splice(i,1);i--}else{if(listeners[i].once){var listener=listeners[i];listener.collection.each(function(j,ele){if(!ele.same(self)){ele.unbind(type,listener.callback)}});for(var j=0;j<structs.once.length;j++){if(listener==structs.once[j]){structs.once.splice(j,1);
j--}}listeners.splice(i,1);i--}}}}if(structs.live[type]!=null){$.each(structs.live[type],function(key,callbackDefns){var selector=new CySelector(key);var filtered=selector.filter(self.collection());if(filtered.size()>0){$.each(callbackDefns,function(i,listener){fire(listener)})}})}cytrigger("cy",event,data);return this};CyElement.prototype.selected=function(){return this._private.selected};CyElement.prototype.select=switchFunction({event:"select",field:"selected",value:true});CyElement.prototype.unselect=switchFunction({event:"unselect",field:"selected",value:false});
CyElement.prototype.source=function(){if(this._private.group=="nodes"){console.error("Can call `source` only on edges---tried to call on node `%s`",this._private.data.id);return this}return structs.nodes[this._private.data.source]};CyElement.prototype.target=function(){if(this._private.group=="nodes"){console.error("Can call `target` only on edges---tried to call on node `%s`",this._private.data.id);return this}return structs.nodes[this._private.data.target]};CyElement.prototype.isNode=function(){return this._private.group=="nodes"
};CyElement.prototype.isEdge=function(){return this._private.group=="edges"};CyElement.prototype.same=function(element){return this==element.element()};CyElement.prototype.is=function(selector){return new CySelector(selector).filter(this.collection()).size()>0};CyElement.prototype.allAre=function(selector){return this.is(selector)};CyElement.prototype.allAreNeighbours=CyElement.prototype.allAreNeighbors=function(collection){collection=collection.collection();var adjacents=this.neighborhood();if(this.isNode()){var self=this;
adjacents.edges().each(function(i,edge){if(edge._private.data.source==edge._private.data.target){adjacents=adjacents.add(self)}})}var ret=true;for(var i=0;i<collection.size();i++){var element=collection[i];var inCollection=false;for(var j=0;j<adjacents.size();j++){var adjacent=adjacents[j];if(element==adjacent){inCollection=true;break}}ret=ret&&inCollection;if(ret==false){break}}return ret};CyElement.prototype.closedNeighbourhood=CyElement.prototype.closedNeighborhood=function(selector){return new CySelector(selector).filter(this.neighborhood().add(this))
};CyElement.prototype.openNeighbourhood=CyElement.prototype.openNeighborhood=function(selector){return this.neighborhood(selector)};CyElement.prototype.neighbourhood=CyElement.prototype.neighborhood=function(selector){var collection;if(this.group()=="nodes"){var node=this;var neighbors=[];var nodes={};$.each(structs.nodeToEdges[this._private.data.id],function(id,edge){neighbors.push(edge);$.each([edge._private.data.source,edge._private.data.target],function(i,nodeId){if(nodes[nodeId]==null){if((nodeId!=node._private.data.id)){nodes[nodeId]=true;
neighbors.push(structs.nodes[nodeId])}}})});collection=new CyCollection(neighbors)}else{if(this.group()=="edges"){var neighbors=[];var nodes={};var edge=this;$.each([edge._private.data.source,edge._private.data.target],function(i,nodeId){if(nodes[nodeId]==null){nodes[nodeId]=true;neighbors.push(structs.nodes[nodeId])}});collection=new CyCollection(neighbors)}}if(isString(selector)){collection=CySelector(selector).filter(collection)}return collection};function degreeFunction(callback){return function(){if(this._private.group=="nodes"&&!this._private.removed){var degree=0;
var edges=structs.nodeToEdges[this._private.data.id];var node=this;if(edges!=null){$.each(edges,function(i,edge){degree+=callback(node,edge)})}return degree}else{return null}}}CyElement.prototype.degree=degreeFunction(function(node,edge){if(edge._private.data.source==edge._private.data.target){return 2}else{return 1}});CyElement.prototype.indegree=degreeFunction(function(node,edge){if(node._private.data.id==edge._private.data.target){return 1}else{return 0}});CyElement.prototype.outdegree=degreeFunction(function(node,edge){if(node._private.data.id==edge._private.data.source){return 1
}else{return 0}});function listenerAlias(params){return function(data,callback){if(isFunction(callback)){return this.bind(params.name,data,callback)}else{if(isFunction(data)){var handler=data;return this.bind(params.name,handler)}else{return this.rtrigger(params.name,data)}}}}CyElement.prototype.mousedown=listenerAlias({name:"mousedown"});CyElement.prototype.mouseup=listenerAlias({name:"mouseup"});CyElement.prototype.mouseover=listenerAlias({name:"mouseover"});CyElement.prototype.mouseout=listenerAlias({name:"mouseout"});
CyElement.prototype.mousemove=listenerAlias({name:"mousemove"});CyElement.prototype.click=listenerAlias({name:"click"});CyElement.prototype.touchstart=listenerAlias({name:"touchstart"});CyElement.prototype.touchmove=listenerAlias({name:"touchmove"});CyElement.prototype.touchend=listenerAlias({name:"touchend"});CyElement.prototype.grab=listenerAlias({name:"grab"});CyElement.prototype.drag=listenerAlias({name:"drag"});CyElement.prototype.free=listenerAlias({name:"free"});var CyCollection=function(elements){if(elements==null){elements=[]
}for(var i=0;i<elements.length;i++){this[i]=elements[i]}this.length=elements.length};var rendererFunctions=["remove","data","bypass","position","select","unselect","lock","unlock","mouseover","mouseout","mousemove","mousedown","mouseup","click","touchstart","touchmove","touchend","grabify","ungrabify"];var getters=["data","bypass","position"];$.each(CyElement.prototype,function(name,func){CyCollection.prototype[name]=function(){var rets=[];var returnsSelf=true;var returnsCollection=true;var collection=new CyCollection();
var isRendererFn=$.inArray(name,rendererFunctions)>=0;var hasPassedFn=isFunction(arguments[0]);var isGetter=$.inArray(name,getters)>=0&&(arguments[0]===undefined||(isString(arguments[0])&&arguments[1]===undefined));var joinNotifications=isRendererFn&&!hasPassedFn&&!isGetter;if(joinNotifications){notificationsEnabled(false)}for(var i=0;i<this.size();i++){var element=this[i];var ret=func.apply(element,arguments);if(ret!==undefined){rets.push(ret)}returnsSelf=returnsSelf&&(ret==element);returnsCollection=returnsCollection&&(ret instanceof CyCollection||ret instanceof CyElement);
if(returnsCollection){collection=collection.add(ret)}if(!returnsSelf&&!returnsCollection){break}}if(joinNotifications){notificationsEnabled(true);notify({type:name,collection:this})}if(!returnsSelf&&!returnsCollection){return rets[0]}if(returnsSelf||rets.length==0){return this}else{if(returnsCollection){return collection}}return rets}});CyCollection.prototype.toArray=function(){var array=[];for(var i=0;i<this.size();i++){array.push(this.eq(i))}return array};CyCollection.prototype.slice=function(start,end){var array=[];
if(end==null){end=this.size()}if(start<0){start=this.size()+start}for(var i=start;i>=0&&i<end&&i<this.size();i++){array.push(this.eq(i))}return new CyCollection(array)};CyCollection.prototype.size=function(){return this.length};CyCollection.prototype.eq=function(i){return this[i]};CyCollection.prototype.empty=function(){return this.size()==0};CyCollection.prototype.live=function(){console.error("`live` can be called only on collections made from top-level selectors")};CyCollection.prototype.die=function(){console.error("`die` can be called only on collections made from top-level selectors")
};CyCollection.prototype.each=function(fn){for(var i=0;i<this.size();i++){if(isFunction(fn)){fn.apply(this.eq(i),[i,this.eq(i)])}}return this};CyCollection.prototype.add=function(toAdd){if(toAdd==null){return this}if(isString(toAdd)){var selector=toAdd;toAdd=elementsCollection({selector:selector})}var elements=[];var ids={nodes:{},edges:{}};function add(element){if(element==null){return}if(ids[element._private.group][element._private.data.id]==null){elements.push(element);ids[element._private.group][element._private.data.id]=true
}}this.each(function(i,element){add(element)});var collection=toAdd.collection();collection.each(function(i,element){add(element)});return new CyCollection(elements)};CyCollection.prototype.not=function(toRemove){if(toRemove==null){return this}else{if(isString(toRemove)){toRemove=new CySelector(toRemove).filter(this)}var elements=[];var collection=toRemove.collection();this.each(function(i,element){var remove=false;for(var j=0;j<collection.size();j++){var c=collection.eq(j);if(c._private.group==element._private.group&&c._private.data.id==element._private.data.id){remove=true;
break}}if(!remove){elements.push(element)}});return new CyCollection(elements)}};CyCollection.prototype.filter=function(filterFn){if(isFunction(filterFn)){var elements=[];this.each(function(i,element){if(!$.isFunction(filterFn)||filterFn.apply(element,[i,element])){elements.push(element)}});return new CyCollection(elements)}else{if(isString(filterFn)){return new CySelector(filterFn).filter(this)}}console.error("You must pass a function or a selector to `filter`")};CyCollection.prototype.nodes=function(selector){var nodes=this.filter(function(i,element){return element.group()=="nodes"
});return new CySelector(selector).filter(nodes)};CyCollection.prototype.edges=function(selector){var edges=this.filter(function(i,element){return element.group()=="edges"});return new CySelector(selector).filter(edges)};CyCollection.prototype.positions=function(fn){var collection=this;noNotifications(function(){collection.each(function(i,element){var positionOpts=fn.apply(element,[i,element]);if(isPlainObject(positionOpts)){element.position(positionOpts)}})});notify({type:"position",collection:this})
};CyCollection.prototype.allSame=function(collection){collection=collection.collection();if(collection.size()!=this.size()){return false}var ret=true;for(var i=0;i<collection.size();i++){var collectionElement=collection.eq(i);var hasCollectionElement=false;for(var j=0;j<this.size();j++){var thisElement=this.eq(j);hasCollectionElement=thisElement.same(collectionElement);if(hasCollectionElement){break}}ret=ret&&hasCollectionElement;if(!ret){break}}return ret};CyCollection.prototype.anySame=function(collection){collection=collection.collection();
var ret=false;for(var i=0;i<collection.size();i++){var collectionElement=collection.eq(i);for(var j=0;j<this.size();j++){var thisElement=this.eq(j);ret=ret||thisElement.same(collectionElement);if(ret){break}}if(ret){break}}return ret};CyCollection.prototype.show=function(){renderer.showElements(this);return this};CyCollection.prototype.hide=function(){renderer.hideElements(this);return this};CyCollection.prototype.once=function(event,data,handler){var self=this;if(handler===undefined){handler=data;
data=undefined}var events=event.split(/\s+/);$.each(events,function(i,type){var listener={once:true,callback:handler,collection:new CyCollection()};structs.once.push(listener);self.each(function(i,ele){if(ele._private.listeners[type]==null){ele._private.listeners[type]=[]}ele._private.listeners[type].push(listener);listener.collection=listener.collection.add(ele)})});return this};CyCollection.prototype.rtrigger=function(event,data){var collection=this;noNotifications(function(){collection.each(function(i,element){element.rtrigger(event,data)
})});notify({type:event,collection:this});return this};CyCollection.prototype.collection=function(){return this};function degreeBoundsFunction(degreeFn,callback){return function(){var ret=null;var degrees=this[degreeFn]();this.each(function(i,ele){var degree=ele[degreeFn]();if(degree!=null&&(ret==null||callback(degree,ret))){ret=degree}});return ret}}CyCollection.prototype.minDegree=degreeBoundsFunction("degree",function(degree,min){return degree<min});CyCollection.prototype.maxDegree=degreeBoundsFunction("degree",function(degree,max){return degree>max
});CyCollection.prototype.minIndegree=degreeBoundsFunction("indegree",function(indegree,min){return indegree<min});CyCollection.prototype.maxIndegree=degreeBoundsFunction("indegree",function(indegree,max){return indegree>max});CyCollection.prototype.minOutdegree=degreeBoundsFunction("outdegree",function(outdegree,min){return outdegree<min});CyCollection.prototype.maxOutdegree=degreeBoundsFunction("outdegree",function(outdegree,max){return outdegree>max});CyCollection.prototype.totalDegree=function(){var total=0;
this.each(function(i,ele){if(ele.isNode()){total+=ele.degree()}});return total};CyCollection.prototype.allAreNeighbours=CyCollection.prototype.allAreNeighbors=function(collection){collection=collection.collection();var ret=true;for(var i=0;i<this.size();i++){var element=this.eq(i);ret=ret&&element.allAreNeighbors(collection);if(ret==false){break}}return ret};CyCollection.prototype.allAre=function(selector){return new CySelector(selector).filter(this).size()==this.size()};CyCollection.prototype.is=function(selector){return new CySelector(selector).filter(this).size()>0
};CyCollection.prototype.toggleClass=function(className,toggle){var collection=this;var classes=className.split(/\s+/);var changed=new CyCollection();classes.each(function(i,cls){collection.each(function(j,ele){function add(){ele.addClass(cls);changed.add(ele)}function remove(){ele.removeClass(cls);changed.add(ele)}function has(){ele.hasClass(cls)}if(toggle===undefined){if(has()){remove()}else{add()}}else{if(toggle&&!has()){add()}else{if(!toggle&&has()){remove()}}}})})};CyCollection.prototype.addClass=function(className){var collection=this;
noNotifications(function(){collection.each(function(i,element){element.addClass(className)})});notify({type:"class",collection:collection});return this};CyCollection.prototype.removeClass=function(className){var collection=this;noNotifications(function(){collection.each(function(i,element){element.removeClass(className)})});notify({type:"class",collection:collection});return this};CyCollection.prototype.removeData=function(field){var collection=this;noNotifications(function(){collection.each(function(i,element){element.removeData(field)
})});notify({type:"data",collection:collection});return this};CyCollection.prototype.removeBypass=function(field){var collection=this;noNotifications(function(){collection.each(function(i,element){element.removeBypass(field)})});notify({type:"bypass",collection:collection});return this};CyCollection.prototype.remove=function(){var collection=this;var elementsRemoved=collection.add(collection.neighborhood().edges());noNotifications(function(){collection.edges().each(function(i,element){element.remove()
});collection.nodes().each(function(i,element){element.remove()})});notify({type:"remove",collection:elementsRemoved});return this};CyCollection.prototype.restore=function(){var collection=this.filter(":removed");noNotifications(function(){collection.nodes().each(function(i,element){element.restore()});collection.edges().each(function(i,element){element.restore()})});notify({type:"add",collection:collection});return this};CyCollection.prototype.element=function(){return this[0]};CyCollection.prototype.stop=function(){var args=arguments;
this.each(function(i,ele){ele.stop.apply(ele,args)});notify({type:"draw",collection:this});return this};$.each(reg.collection,function(name,func){if(CyCollection.prototype[name]==null){CyCollection.prototype[name]=func}else{console.error("Can not override collection function `%s`; already has default implementation",name)}});$.each(CyCollection.prototype,function(name,func){if(CyElement.prototype[name]==null){CyElement.prototype[name]=function(){var collection=this.collection();return func.apply(collection,arguments)
}}});var CySelector=function(onlyThisGroup,selector){if(selector===undefined&&onlyThisGroup!==undefined){selector=onlyThisGroup;onlyThisGroup=undefined}var self=this;self._private={selectorText:null,invalid:true};if(selector==null||selector.match(/^\s*$/)){if(onlyThisGroup==null){self.length=0}else{self[0]={classes:[],colonSelectors:[],data:[],group:onlyThisGroup,ids:[],meta:[]};self.length=1}}else{if(isString(selector)){var str=selector;self._private.selectorText=selector;var queryRegex="(node|edge|)(((:[a-z]+)|(\\[.+\\])|(\\{.+\\})|(\\.[\\w_-]+)|(#[\\w_-]+))*)";
var qnnRegex="(((node|edge)(((:[a-z]+)|(\\[.+\\])|(\\{.+\\})|(\\.[\\w_-]+)|(#[\\w_-]+))*))|((((:[a-z]+)|(\\[.+\\])|(\\{.+\\})|(\\.[\\w_-]+)|(#[\\w_-]+))+)))";var remaining=str;var queries=[];while(true){match=remaining.match(new RegExp("^("+qnnRegex+")(\\s*,\\s*(.+))?$"));if(match!=null){queries.push(match[1]);var rmatch=remaining.match(new RegExp("^"+qnnRegex+"\\s*,\\s*(.+)$"));if(rmatch!=null){remaining=rmatch[rmatch.length-1]}else{break}}else{break}}for(var i=0;i<queries.length;i++){if(queries[i]==null||queries[i]==""){queries.splice(i,1);
i--}}self.length=queries.length;for(var i=0;i<queries.length;i++){var query=queries[i];var q=query.match(new RegExp("^"+queryRegex+"$"));self[i]={};if(q==null){console.error("Invalid selector `%s` in parent selector `%s`",query,str);return}var group=q[1]==""?undefined:q[1]+"s";self[i].group=group;if(onlyThisGroup==null){}else{if(onlyThisGroup!=null&&(group==null||group==onlyThisGroup)){self[i].group=onlyThisGroup}else{console.error("Invalid group `%s` in selector `%s` in parent selector `%s` with implicit group `%s`",group,query,str,onlyThisGroup);
return}}var selectors=q[2];var dataSelectors=selectors.match(/(\[.+?\])/g);var split=selectors.split(/\[.+?\]/);var selectorsWithoutData="";$.each(split,function(i,str){selectorsWithoutData+=str});var metaSelectors=selectorsWithoutData.match(/(\{.+?\})/g);split=selectorsWithoutData.split(/(\{.+?\})/g);var selectorsWoMetaAndData="";$.each(split,function(i,str){selectorsWoMetaAndData+=str});var colonSelectors=selectorsWoMetaAndData.match(/(:[a-z]+)/g);var classSelectors=selectorsWoMetaAndData.match(/(\.[\w_-]+)/g);
var idSelectors=selectorsWoMetaAndData.match(/(#[\w_-]+)/g);for(var j=0;colonSelectors!=null&&j<colonSelectors.length;j++){var selector=colonSelectors[j];if(selector.match(/^:selected|:unselected|:locked|:unlocked|:visible|:hidden|:grabbed|:free|:removed|:inside|:grabbable|:ungrabbable|:animated$/)){}else{console.error("Invalid colon style selector `%s` in parent selector `%s`",selector,str)}}self[i].colonSelectors=colonSelectors||[];self[i].classes=[];for(var j=0;classSelectors!=null&&j<classSelectors.length;
j++){var sel=classSelectors[j];var cls=sel.substring(1);self[i].classes.push(cls)}self[i].ids=[];for(var j=0;idSelectors!=null&&j<idSelectors.length;j++){var sel=idSelectors[j];var id=sel.substring(1);self[i].ids.push(id)}function addOperandSelectors(params){self[i][params.name]=[];for(var j=0;params.selectors!=null&&j<params.selectors.length;j++){var bracket=params.selectors[j];var b=bracket.replace(params.openParen,"").replace(params.closeParen,"");var match=b.match(/^\s*(\w+)\s*((?:@?)(?:=|!=||>=||<=|<|>|\*=|\^=|\$=|\$=)){0,1}\s*([\w._-]+|'.+'|".+"){0,1}?\s*$/);
var boolMatch=b.match(/^\s*(\!|\?|\^|\^\^)\s*([\w._-]+)\s*$/);if(match==null&&boolMatch==null){console.error("Invalid operand selector `%s` in parent selector `%s`",bracket,str);return}var field,operator,value;var isBool=false;if(match!=null){field=match[1];operator=match[2];value=match[3]}else{if(boolMatch!=null){field=boolMatch[2];operator=boolMatch[1];value="true";switch(operator){case"?":operator="=";break;case"!":operator="!=";break;case"^":operator="===";value="undefined";break}isBool=true}}if(!params.validField(field)){console.error("Invalid selector `%s`; field `%s` is not valid",str,value);
return}if(operator==null&&value!=null){console.error("Invalid selector `%s`; operator must be specified for value `%s`",str,value);return}if(value==null&&operator!=null){console.error("Invalid selector `%s`; value must be specified for operator `%s`",str,operator);return}if(value!=null&&operator!=null&&!isBool){var valueAsNumber=parseFloat(value);var valueIsNumber=!isNaN(valueAsNumber);if(!valueIsNumber){if(value.match(/^'.+'$/)||value.match(/^".+"$/)){}else{console.error("Invalid selector `%s`; string value must be enclosed in quotes `%s`",str,value);
return}}}self[i][params.name].push({field:field,operator:operator,value:value})}return true}var dataValid=addOperandSelectors({name:"data",selectors:dataSelectors,openParen:"[",closeParen:"]",validField:function(field){return true}});if(!dataValid){return}var metaValid=addOperandSelectors({name:"meta",selectors:metaSelectors,openParen:"{",closeParen:"}",validField:function(field){switch(field){case"degree":case"indegree":case"outdegree":return true;default:return false}}});if(!metaValid){return}}}else{console.error("A selector must be created from a string; found %o",selector);
return}}self._private.invalid=false};CySelector.prototype.size=function(){return this.length};CySelector.prototype.eq=function(i){return this[i]};CySelector.prototype.filter=function(collection,addLiveFunction){var self=this;if(self._private.invalid){return new CyCollection()}var selectorFunction=function(i,element){for(var j=0;j<self.length;j++){var query=self[j];if(query.group!=null&&query.group!=element._private.group){continue}var allColonSelectorsMatch=true;for(var k=0;k<query.colonSelectors.length;
k++){var sel=query.colonSelectors[k];switch(sel){case":selected":allColonSelectorsMatch=element.selected();break;case":unselected":allColonSelectorsMatch=!element.selected();break;case":locked":allColonSelectorsMatch=element.locked();break;case":unlocked":allColonSelectorsMatch=!element.locked();break;case":visible":allColonSelectorsMatch=renderer.elementIsVisible(element);break;case":hidden":allColonSelectorsMatch=!renderer.elementIsVisible(element);break;case":grabbed":allColonSelectorsMatch=element.grabbed();
break;case":free":allColonSelectorsMatch=!element.grabbed();break;case":removed":allColonSelectorsMatch=element.removed();break;case":inside":allColonSelectorsMatch=!element.removed();break;case":grabbable":allColonSelectorsMatch=element.grabbable();break;case":ungrabbable":allColonSelectorsMatch=!element.grabbable();break;case":animated":allColonSelectorsMatch=element.animated();break}if(!allColonSelectorsMatch){break}}if(!allColonSelectorsMatch){continue}var allIdsMatch=true;for(var k=0;k<query.ids.length;
k++){var id=query.ids[k];var actualId=element._private.data.id;allIdsMatch=allIdsMatch&&(id==actualId);if(!allIdsMatch){break}}if(!allIdsMatch){continue}var allClassesMatch=true;for(var k=0;k<query.classes.length;k++){var cls=query.classes[k];allClassesMatch=allClassesMatch&&element.hasClass(cls);if(!allClassesMatch){break}}if(!allClassesMatch){continue}function operandsMatch(params){var allDataMatches=true;for(var k=0;k<query[params.name].length;k++){var data=query[params.name][k];var operator=data.operator;
var value=data.value;var field=data.field;var matches;if(operator!=null&&value!=null){var fieldStr=""+params.fieldValue(field);var valStr=""+eval(value);var caseInsensitive=false;if(operator.charAt(0)=="@"){fieldStr=fieldStr.toLowerCase();valStr=valStr.toLowerCase();operator=operator.substring(1);caseInsensitive=true}if(operator=="="){operator="=="}switch(operator){case"*=":matches=fieldStr.search(valStr)>=0;break;case"$=":matches=new RegExp(valStr+"$").exec(fieldStr)!=null;break;case"^=":matches=new RegExp("^"+valStr).exec(fieldStr)!=null;
break;default:if(caseInsensitive){var expr="fieldStr "+operator+" valStr";matches=eval(expr)}else{var expr=params.fieldExpr(field)+" "+operator+" "+value;matches=eval(expr)}}}else{matches=!params.fieldEmpty(field)}if(!matches){allDataMatches=false;break}}return allDataMatches}var allDataMatches=operandsMatch({name:"data",fieldValue:function(field){return element._private.data[field]},fieldExpr:function(field){return"element._private.data."+field},fieldEmpty:function(field){return element._private.data[field]===undefined
}});if(!allDataMatches){continue}var allMetaMatches=operandsMatch({name:"meta",fieldValue:function(field){return element[field]()},fieldExpr:function(field){return"element."+field+"()"},fieldEmpty:function(field){return element[field]()==null}});if(!allMetaMatches){continue}return true}return false};if(self._private.selectorText==null){selectorFunction=function(){return true}}var filteredCollection=collection.filter(selectorFunction);if(addLiveFunction){var key=self.selector();filteredCollection.live=function(events,data,callback){var evts=events.split(/\s+/);
$.each(evts,function(i,event){if(event==""){return}if(callback===undefined){callback=data;data=undefined}if(structs.live[event]==null){structs.live[event]={}}if(structs.live[event][key]==null){structs.live[event][key]=[]}structs.live[event][key].push({callback:callback,data:data})});return this};filteredCollection.die=function(event,callback){if(event==null){$.each(structs.live,function(event){if(structs.live[event]!=null){delete structs.live[event][key]}})}else{var evts=event.split(/\s+/);$.each(evts,function(j,event){if(callback==null){if(structs.live[event]!=null){delete structs.live[event][key]
}}else{if(structs.live[event]!=null&&structs.live[event][key]!=null){for(var i=0;i<structs.live[event][key].length;i++){if(structs.live[event][key][i].callback==callback){structs.live[event][key].splice(i,1);i--}}}}})}return this}}return filteredCollection};CySelector.prototype.selector=function(){var str="";function clean(obj){if(isString(obj)){return obj}return""}for(var i=0;i<this.length;i++){var query=this[i];var group=clean(query.group);str+=group.substring(0,group.length-1);for(var j=0;j<query.data.length;
j++){var data=query.data[j];str+="["+data.field+clean(data.operator)+clean(data.value)+"]"}for(var j=0;j<query.colonSelectors.length;j++){var sel=query.colonSelectors[i];str+=sel}for(var j=0;j<query.ids.length;j++){var sel="#"+query.ids[i];str+=sel}for(var j=0;j<query.classes.length;j++){var sel="."+query.classes[i];str+=sel}if(this.length>1&&i<this.length-1){str+=", "}}return str};var enableNotifications=0;var batchingNotifications=0;var batchedNotifications=[];var batchedNotificationsTypeToIndex={};
function batchNotifications(fn){batchingNotifications++;fn();batchingNotifications--;if(batchingNotifications==0){$.each(batchedNotifications,function(i,params){renderer.notify(params)});batchedNotifications=[];batchedNotificationsTypeToIndex={}}}function noNotifications(fn){notificationsEnabled(false);fn();notificationsEnabled(true)}function notificationsEnabled(enabled){enableNotifications+=enabled?1:-1}function notify(params){if(params.collection instanceof CyElement){var element=params.collection;
params.collection=new CyCollection([element])}else{if(params.collection instanceof Array){var elements=params.collection;params.collection=new CyCollection(elements)}}if(enableNotifications!=0){return}else{if(batchingNotifications>0){if(batchedNotificationsTypeToIndex[params.type]!=null){var index=batchedNotificationsTypeToIndex[params.type];var batchedParams=batchedNotifications[index];var batchedCollection=batchedParams.collection;if(batchedCollection!=null){batchedCollection=batchedCollection.add(params.collection)
}batchedParams=$.extend({},batchedParams,params);batchedParams.collection=batchedCollection;batchedNotifications[index]=batchedParams}else{var index=batchedNotifications.length;batchedNotifications.push(params);batchedNotificationsTypeToIndex[params.type]=index}}else{if(getContinuousMapperUpdates().length!=0){params.updateMappers=true;clearContinuousMapperUpdates()}renderer.notify(params)}}}function elementsCollection(params){var elements=[];var p=$.extend({},{group:null,selector:null,addLiveFunction:false},params);
var group=p.group;var selector=p.selector;var addLiveFunction=p.addLiveFunction;if(group=="nodes"||group=="edges"){$.each(structs[group],function(id,element){elements.push(element)});if(selector==null){selector=""}var collection=new CyCollection(elements);return new CySelector(group,selector).filter(collection,addLiveFunction)}else{$.each(structs.nodes,function(id,element){elements.push(element)});$.each(structs.edges,function(id,element){elements.push(element)});var collection=new CyCollection(elements);
return new CySelector(selector).filter(collection,addLiveFunction)}}function addElement(params){return function(opts){var elements=[];noNotifications(function(){if(opts instanceof CyElement){var element=opts;elements.push(element);element.restore()}else{if(opts instanceof CyCollection){var collection=opts;collection.each(function(i,ele){elements.push(ele)});collection.restore()}else{if(isArray(opts)){$.each(opts,function(i,elementParams){if(params!=null&&params.group!=null){elements.push(new CyElement($.extend({},elementParams,{group:params.group})))
}else{elements.push(new CyElement(elementParams))}})}else{if(isPlainObject(opts)&&(isArray(opts.nodes)||isArray(opts.edges))){$.each(["nodes","edges"],function(i,group){if(isArray(opts[group])){$.each(opts[group],function(i,eleOpts){elements.push(new CyElement($.extend({},eleOpts,{group:group})))})}})}else{if(params!=null&&params.group!=null){elements.push(new CyElement($.extend({},opts,{group:params.group})))}else{elements.push(new CyElement(opts))}}}}}});notify({type:"add",collection:elements});
return new CyCollection(elements)}}var prevLayoutOptions=options.layout;function cybind(target,events,data,handler){var one;if(isPlainObject(target)){one=target.one;target=target.target}if(handler===undefined){handler=data;data=undefined}if(structs.listeners[target]==null){structs.listeners[target]={}}$.each(events.split(/\s+/),function(j,event){if(event==""){return}if(structs.listeners[target][event]==null){structs.listeners[target][event]=[]}structs.listeners[target][event].push({callback:handler,data:data,one:one})
})}function cyunbind(target,events,handler){if(structs.listeners[target]==null){return}if(events===undefined){structs.listeners[target]={};return}$.each(events.split(/\s+/),function(j,event){if(event==""){return}if(handler==null){if(structs.listeners[target][event]==null){return}delete structs.listeners[target][event];return}for(var i=0;i<structs.listeners[target][event].length;i++){var listener=structs.listeners[target][event][i];if(listener.callback==handler){structs.listeners[target][event].splice(i,1);
i--}}})}function cytrigger(target,event,data){var type=isString(event)?event:event.type;if(structs.listeners[target]==null||structs.listeners[target][type]==null){return}for(var i=0;i<structs.listeners[target][type].length;i++){var listener=structs.listeners[target][type][i];var eventObj;if(isPlainObject(event)){eventObj=event;event=eventObj.type}else{eventObj=jQuery.Event(event)}eventObj.data=listener.data;eventObj.cy=eventObj.cytoscapeweb=cy;var args=[eventObj];if(data!=null){$.each(data,function(i,arg){args.push(arg)
})}if(listener.one){structs.listeners[target][type].splice(i,1);i--}listener.callback.apply(cy,args)}}var background={one:function(event,data,handler){cybind({one:true,target:"background"},event,data,handler);return this},bind:function(event,data,handler){cybind("background",event,data,handler);return this},unbind:function(event,handler){cyunbind("background",event,handler);return this},trigger:function(event,data){cytrigger("background",event,data);return this}};var zoomEnabled=true;var panEnabled=true;
var cy={container:function(){return $(options.container)},one:function(event,data,handler){cybind({one:true,target:"cy"},event,data,handler);return this},bind:function(event,data,handler){cybind("cy",event,data,handler);return this},unbind:function(event,handler){cyunbind("cy",event,handler);return this},trigger:function(event,data){cytrigger("cy",event,data);return this},delegate:function(selector,event,data,handler){this.elements(selector).live(event,data,handler);return this},undelegate:function(selector,event,handler){this.elements(selector).die(event,handler);
return this},on:function(event,selector,data,handler){if(data===undefined&&handler===undefined){cybind("cy",event,data,handler)}else{this.elements(selector).live(event,data,handler)}return this},off:function(event,selector,handler){if(selector===undefined&&handler===undefined){cyunbind("cy",event)}else{if(handler===undefined){if(isFunction(selector)){handler=selector;selector=undefined;cyunbind("cy",event,handler)}else{cy.elements(selector).die(event)}}else{cy.elements(selector).die(event,handler)
}}return this},style:function(val){var ret;if(val===undefined){ret=copy(structs.style)}else{structs.style=copy(val);ret=this;notify({type:"style",style:structs.style})}return ret},background:function(){return background},add:addElement(),remove:function(collection){if(typeof collection==typeof""){var selector=collection;var elements=elementsCollection({selector:selector,addLiveFunction:false});return elements.remove()}else{return collection.remove()}},nodes:function(selector){return elementsCollection({group:"nodes",selector:selector,addLiveFunction:true})
},edges:function(selector){return elementsCollection({group:"edges",selector:selector,addLiveFunction:true})},elements:function(selector){return elementsCollection({selector:selector,addLiveFunction:true})},filter:function(selector){if(isString(selector)){return elementsCollection({selector:selector,addLiveFunction:true})}else{if(isFunction(selector)){return elementsCollection().filter(selector)}}},collection:function(){return new CyCollection()},layout:function(params){if(params==null){console.error("Layout options must be specified to run a layout");
return}if(params.name==null){console.error("A `name` must be specified to run a layout");return}var name=params.name.toLowerCase();if(reg.layout[name]==null){console.error("Can not apply layout: No such layout `%s` found; did you include its JS file?",name);return}if(prevLayoutOptions.name!=name||layout==null){layout=new reg.layout[name]();prevLayoutOptions=params}if(isFunction(params.start)){cy.one()}cy.trigger("layoutstart");layout.run($.extend({},params,{renderer:renderer,cy:cy}));return this},panning:function(bool){if(bool!==undefined){panEnabled=bool?true:false
}else{return panEnabled}return cy},zooming:function(bool){if(bool!==undefined){zoomEnabled=bool?true:false}else{return zoomEnabled}return cy},pan:function(params){var ret=renderer.pan(params);if(ret==null){cy.trigger("pan");return cy}return ret},panBy:function(params){var ret=renderer.panBy(params);if(ret==null){cy.trigger("pan");return cy}return ret},fit:function(elements){var ret=renderer.fit({elements:elements,zoom:true});if(ret==null){cy.trigger("zoom");cy.trigger("pan");return cy}return ret},zoom:function(params){var ret=renderer.zoom(params);
if(ret!=null){return ret}else{cy.trigger("zoom");return cy}},center:function(elements){renderer.fit({elements:elements,zoom:false});cy.trigger("pan");return cy},centre:function(){return cy.center.apply(cy,arguments)},reset:function(){renderer.pan({x:0,y:0});renderer.zoom(1);cy.trigger("zoom");cy.trigger("pan");return this},load:function(elements,onload,ondone){cy.elements().remove();if(elements!=null){noNotifications(function(){if(isPlainObject(elements)){$.each(["nodes","edges"],function(i,group){var elementsInGroup=elements[group];
if(elementsInGroup!=null){$.each(elementsInGroup,function(i,params){var element=new CyElement($.extend({},params,{group:group}))})}})}else{if(isArray(elements)){$.each(elements,function(i,params){var element=new CyElement(params)})}}})}notificationsEnabled(false);function callback(){cy.layout({name:options.layout.name,ready:function(){notificationsEnabled(true);notify({type:"load",collection:cy.elements(),style:structs.style});if(isFunction(onload)){onload.apply(cy,[cy])}cy.trigger("layoutready")
},stop:function(){if(isFunction(ondone)){ondone.apply(cy,[cy])}cy.trigger("layoutdone")}})}if(window.chrome){setTimeout(function(){callback()},30)}else{callback()}return this},exportTo:function(params){var format=params.name;var exporterDefn=reg.exporter[format];if(exporterDefn==null){console.error("No exporter with name `%s` found; did you remember to register it?",format)}else{var exporter=new exporterDefn({cy:cy,renderer:renderer});return exporter.run()}}};$.each(reg.core,function(name,func){if(cy[name]==null){cy[name]=func
}else{console.error("Can not override core function `%s`; already has default implementation",name)}});if(reg.renderer[options.renderer.name.toLowerCase()]==null){console.error("Can not initialise: No such renderer `$s` found; did you include its JS file?",options.renderer.name);return}var renderer=new reg.renderer[options.renderer.name.toLowerCase()]($.extend({},options.renderer,{cy:cy,style:options.style,styleCalculator:{calculate:function(element,styleVal){if(isPlainObject(styleVal)){var ret;if(styleVal.customMapper!=null){ret=styleVal.customMapper.apply(element,[element.data()])
}else{if(styleVal.passthroughMapper!=null){var attrName=styleVal.passthroughMapper;ret=element._private.data[attrName]}else{if(styleVal.discreteMapper!=null){var attrName=styleVal.discreteMapper.attr;var entries=styleVal.discreteMapper.entries;var elementVal=element.data(attrName);$.each(entries,function(i,entry){var attrVal=entry.attrVal;var mappedVal=entry.mappedVal;if(attrVal==elementVal){ret=mappedVal}})}else{if(styleVal.continuousMapper!=null){var map=styleVal.continuousMapper;if(map.attr.name==null||typeof map.attr.name!=typeof""){console.error("For style.%s.%s, `attr.name` must be defined as a string since it's a continuous mapper",element.group(),styleName);
return}var attrBounds=structs.continuousMapperBounds[element._private.group][map.attr.name];attrBounds={min:attrBounds==null?0:attrBounds.min,max:attrBounds==null?0:attrBounds.max};if(map.attr.min!=null){attrBounds.min=map.attr.min}if(map.attr.max!=null){attrBounds.max=map.attr.max}if(attrBounds!=null){var data=element.data(map.attr.name);var percent=(data-attrBounds.min)/(attrBounds.max-attrBounds.min);if(attrBounds.max==attrBounds.min){percent=1}if(percent>1){percent=1}else{if(percent<0||data==null||isNaN(percent)){percent=0
}}if(data==null&&styleVal.defaultValue!=null){ret=styleVal.defaultValue}else{if(isNumber(map.mapped.min)&&isNumber(map.mapped.max)){ret=percent*(map.mapped.max-map.mapped.min)+map.mapped.min}else{if(isColor(map.mapped.min)&&isColor(map.mapped.max)){var cmin=$.Color(map.mapped.min).fix().toRGB();var cmax=$.Color(map.mapped.max).fix().toRGB();var red=Math.round(cmin.red()*(1-percent)+cmax.red()*percent);var green=Math.round(cmin.green()*(1-percent)+cmax.green()*percent);var blue=Math.round(cmin.blue()*(1-percent)+cmax.blue()*percent);
ret=$.Color([red,green,blue],"RGB").toHEX().toString()}else{console.error("Unsupported value used in mapper for `style.%s.%s` with min mapped value `%o` and max `%o` (neither number nor colour)",element.group(),map.styleName,map.mapped.min,map.mapped.max);return}}}}else{console.error("Attribute values for `%s.%s` must be numeric for continuous mapper `style.%s.%s` (offending %s: `%s`)",element.group(),map.attr.name,element.group(),styleName,element.group(),element.data("id"));return}}}}}var defaultValue=styleVal.defaultValue;
if(ret==null){ret=defaultValue}}else{ret=styleVal}return ret}}}));var layout;cy.load(options.elements,function(){var data=$(options.container).data("cytoscapeweb");if(data==null){data={}}data.cy=cy;data.ready=true;if(data.readies!=null){$.each(data.readies,function(i,ready){cy.bind("ready",ready)});data.readies=[]}$(options.container).data("cytoscapeweb",data);startAnimationLoop();if(isFunction(options.ready)){options.ready.apply(cy,[cy])}cy.trigger("ready")},function(){if(isFunction(options.done)){options.done.apply(cy,[cy])
}cy.trigger("done")});return cy}else{if(typeof opts==typeof""&&isFunction(console[opts])){var args=[];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}console[opts].apply(console,args)}else{if(opts=="quiet"){quiet=(arguments[1]!=null&&arguments[1]!=false)}else{if(opts=="debugging"){debug=(arguments[1]!=null&&arguments[1]!=false)}else{if(typeof opts==typeof""){var registrant=arguments[0].toLowerCase();var name=arguments[1].toLowerCase();var module=arguments[2];var componentType=arguments[2];
var componentName=arguments[3];var component=arguments[4];if(isString(componentType)){componentType=componentType.toLowerCase();if(isString(componentName)){componentName=componentName.toLowerCase();if(component!==undefined){if(subreg[registrant][name]==null){subreg[registrant][name]={}}if(subreg[registrant][name][componentType]==null){subreg[registrant][name][componentType]={}}subreg[registrant][name][componentType][componentName]=component}else{return subreg[registrant][name][componentType][componentName]
}}}else{if(module===undefined){return reg[registrant][name]}else{reg[registrant][name]=module;module.prototype.name=function(){return name};module.prototype.registrant=function(){return registrant}}}}}}}}};if($.fn.cy==null&&$.cy==null){$.fn.cy=$.fn.cytoscapeweb;$.cy=$.cytoscapeweb}function JsonExporter(options){this.options=options;this.cy=options.cy;this.renderer=options.renderer}JsonExporter.prototype.run=function(){var elements={};this.cy.elements().each(function(i,ele){var group=ele.group();if(elements[group]==null){elements[group]=[]
}elements[group].push(ele.json())});return elements};$.cytoscapeweb("exporter","json",JsonExporter)})(jQuery);$(function(){function a(b){$.cytoscapeweb("debug","Creating null renderer with options (%o)",b)}a.prototype.notify=function(b){$.cytoscapeweb("debug","Notify null renderer with params (%o)",b)};a.prototype.zoom=function(b){$.cytoscapeweb("debug","Zoom null renderer with params (%o)",b)};a.prototype.fit=function(b){$.cytoscapeweb("debug","Fit null renderer with params (%o)",b)};a.prototype.pan=function(b){$.cytoscapeweb("debug","Pan null renderer with params (%o)",b)
};a.prototype.panBy=function(b){$.cytoscapeweb("debug","Relative pan null renderer with params (%o)",b)};a.prototype.showElements=function(b){b.collection().each(function(){this._private.visible=true})};a.prototype.hideElements=function(b){b.collection().each(function(){this._private.visible=false})};a.prototype.elementIsVisible=function(b){return b._private.visible};a.prototype.renderedDimensions=function(){return{}};$.cytoscapeweb("renderer","null",a)});$(function(){var e={minZoom:0.001,maxZoom:1000,maxPan:-1>>>1,minPan:(-(-1>>>1)-1),style:{selectors:{node:{fillColor:"#888",fillOpacity:1,borderColor:"#666",borderOpacity:1,opacity:1,borderWidth:0,borderStyle:"solid",height:10,width:10,shape:"ellipse",cursor:"pointer",visibility:"visible",labelValign:"top",labelHalign:"middle",labelText:{defaultValue:"",passthroughMapper:"label"},labelFillColor:"#000",labelOutlineColor:"#666",labelOutlineWidth:0,labelFontSize:"inherit",labelFontStyle:"normal",labelFontDecoration:"none",labelFontVariant:"italic",labelFontFamily:"Arial",labelFontWeight:"bold",labelOpacity:1,labelOutlineOpacity:1},edge:{lineColor:"#ccc",targetArrowColor:"#ccc",sourceArrowColor:"#ccc",targetArrowShape:"none",sourceArrowShape:"none",opacity:1,width:1,style:"solid",cursor:"pointer",visibility:"visible",labelText:{defaultValue:"",passthroughMapper:"label"},labelFillColor:"#000",labelOutlineColor:"#666",labelOutlineWidth:0,labelFontSize:"inherit",labelFontStyle:"normal",labelFontDecoration:"none",labelFontVariant:"italic",labelFontFamily:"Arial",labelFontWeight:"bold",labelOutlineOpacity:1,labelOpacity:1}},global:{panCursor:"grabbing",selectionFillColor:"#ccc",selectionOpacity:0.5,selectionBorderColor:"#888",selectionBorderWidth:1}}};
var p={};var m=function(s){$.cytoscapeweb("renderer","svg","linestyle",s.name,s);delete s.name};m({name:"solid",array:undefined});m({name:"dot",array:[1,5]});m({name:"longdash",array:[10,2]});m({name:"dash",array:[5,5]});var o=function(s){$.cytoscapeweb("renderer","svg","edgearrowshape",s.name,s);delete s.name};o({name:"triangle",svg:function(t,v,w,s,u){return t.polygon(v,[[0,1],[0.5,0],[1,1]])},centerPoint:{x:0.5,y:0.5}});o({name:"square",svg:function(t,v,w,s,u){return t.polygon(v,[[0,0],[0,1],[1,1],[1,0]])
},centerPoint:{x:0.5,y:0.5}});o({name:"circle",svg:function(t,v,w,s,u){return t.circle(v,0.5,0.5,0.5)},centerPoint:{x:0.5,y:0.5}});var j=function(s){$.cytoscapeweb("renderer","svg","nodeshape",s.name,s);delete s.name};j({name:"ellipse",svg:function(t,v,w,s,u){return t.ellipse(v,s.x,s.y,u.width,u.height)},update:function(t,v,w,s,u){t.change(w._private.renderer.svg,{cx:s.x,cy:s.y,rx:u.width/2,ry:u.height/2})},intersectionShape:Ellipse});j({name:"rectangle",svg:function(t,v,w,s,u){return t.rect(v,s.x-u.width/2,s.y-u.height/2,u.width,u.height)
},update:function(t,v,w,s,u){t.change(w._private.renderer.svg,{x:s.x-u.width/2,y:s.y-u.height/2,width:u.width,height:u.height})},intersectionShape:Rectangle});j({name:"roundrectangle",svg:function(t,v,w,s,u){return t.rect(v,s.x-u.width/2,s.y-u.height/2,u.width,u.height,u.width/4,u.height/4)},update:function(t,v,w,s,u){t.change(w._private.renderer.svg,{x:s.x-u.width/2,y:s.y-u.height/2,width:u.width,height:u.height})},intersectionShape:Rectangle});j({name:"triangle",svg:function(t,v,w,s,u){return t.polygon(v,[[s.x,s.y-u.height/2],[s.x+u.width/2,s.y+u.height/2],[s.x-u.width/2,s.y+u.height/2]])
},update:function(t,v,w,s,u){t.change(w._private.renderer.svg,{points:[[s.x,s.y-u.height/2],[s.x+u.width/2,s.y+u.height/2],[s.x-u.width/2,s.y+u.height/2]]})},intersectionShape:Polygon});function a(s){if(s!=null&&typeof s==typeof""&&(s=="hidden"||s=="visible")){return s}else{$.cytoscapeweb("error","SVG renderer does not recognise %o as a valid visibility",s)}}function l(s){if(s!=null&&typeof s==typeof 1&&!isNaN(s)&&0<=s&&s<=1){return s}else{$.cytoscapeweb("error","SVG renderer does not recognise %o as a valid percent (should be between 0 and 1)",s)
}}function f(s){if(s!=null&&typeof s==typeof""&&$.Color(s)!=""){return $.Color(s).toHEX()}else{$.cytoscapeweb("error","SVG renderer does not recognise %o as a valid colour",s)}}function d(s){if(s!=null&&typeof s==typeof 1&&!isNaN(s)){return s}else{$.cytoscapeweb("error","SVG renderer does not recognise %o as a valid number",s)}}function c(t){var s=$.cytoscapeweb("renderer","svg","nodeshape",t);if(s==null){$.cytoscapeweb("error","SVG renderer does not recognise %s as a valid node shape",t)}return s
}function g(t){var s=$.cytoscapeweb("renderer","svg","linestyle",t);if(s==null){$.cytoscapeweb("error","SVG renderer does not recognise %s as a valid line style",t)}return s}function k(s){if(s=="none"||s==null){return null}return $.cytoscapeweb("renderer","svg","edgearrowshape",s)}function r(s){if(s!=null&&typeof s==typeof""&&(s=="left"||s=="right"||s=="middle")){return s}else{$.cytoscapeweb("error","SVG renderer does not recognise %o as a valid label horizonal alignment",s)}}function h(s){if(s!=null&&typeof s==typeof""&&(s=="top"||s=="bottom"||s=="middle")){return s
}else{$.cytoscapeweb("error","SVG renderer does not recognise %o as a valid label vertical alignment",s)}}function q(s){if(s=="grab"){if($.browser.webkit){return"-webkit-grab"}else{if($.browser.mozilla){return"-moz-grab"}else{return"move"}}}else{if(s=="grabbing"){if($.browser.webkit){return"-webkit-grabbing"}else{if($.browser.mozilla){return"-moz-grabbing"}else{return"move"}}}else{return s}}}function n(s){$.cytoscapeweb("debug","Creating SVG renderer with options (%o)",s);this.options=$.extend({},e,s);
this.setStyle(s.style);this.cy=s.cy;$.cytoscapeweb("debug","SVG renderer is using style (%o)",this.style)}n.prototype.init=function(v){var u=this;this.cy=this.options.cy;var s=this.cy.container();var t=s.svg("get");this.container=s;this.svg=t;if(t!=null){s.svg("destroy")}s.css({padding:"0 !important"});s.svg({onLoad:function(w){if(u.scale==null){u.scale=1}if(u.translation==0){u.translation={x:0,y:0}}s.find("svg").css("overflow","hidden");t=w;u.svg=t;u.svg.change();u.svgBg=t.rect(0,0,"100%","100%",{fill:"white",opacity:0});
u.edgesGroup=t.group();u.nodesGroup=t.group();u.svgRoot=$(u.nodesGroup).parents("svg:first")[0];u.selectedElements=u.cy.collection();u.touchingNodes=u.cy.collection();u.defs=u.svg.defs();u.makeBackgroundInteractive();v()},settings:{height:"100%",width:"100%"}})};n.prototype.offsetFix=function(t){var s=this;if(t.offsetX==null||t.offsetY==null){t.offsetX=t.clientX-s.cy.container().offset().left;t.offsetY=t.clientY-s.cy.container().offset().top}};n.prototype.makeBackgroundInteractive=function(){var B=this;
var K=B.svgRoot;var M=150;B.shiftDown=false;$(window).bind("keydown keyup",function(P){B.shiftDown=P.shiftKey});function t(P){return P.target==K||$(P.target).parents("g:last")[0]==B.edgesGroup||$(P.target)[0]==B.svgBg}$(K).bind("mousedown",function(R){if(R.button!=0){return}if(t(R)){R.preventDefault();B.offsetFix(R);var S=null;var Q={};var T=false;var V=true;var aa=R.pageX;var Y=R.pageY;var P=R.offsetX;var ac=R.offsetY;var ab=0;var Z=0;var U=setTimeout(function(){if(!B.cy.panning()){return}T=true;
V=false;B.svg.change(K,{cursor:q(B.style.global.panCursor)});B.cy.container().scrollLeft(100)},M);var W=function(ai){clearTimeout(U);var ag=ai.pageX-aa;var af=ai.pageY-Y;aa=ai.pageX;Y=ai.pageY;ab+=ag;Z+=af;if(T){B.translation.x+=ag;B.translation.y+=af;B.pan(B.translation)}if(V){if(S==null){S=B.svg.rect(P,ac,0,0,{fill:f(B.style.global.selectionFillColor),opacity:l(B.style.global.selectionOpacity),stroke:f(B.style.global.selectionBorderColor),strokeWidth:d(B.style.global.selectionBorderWidth)})}else{var ah=Math.abs(ab);
var ae=Math.abs(Z);var ad=ab>=0?P:P+ab;var aj=Z>=0?ac:ac+Z;Q={x1:ad,y1:aj,x2:ad+ah,y2:aj+ae};B.svg.change(S,{x:ad,y:aj,width:ah,height:ae})}}};$(window).bind("mousemove",W);var X=function(ad){if(ad.type=="mouseup"&&ad.button!=0){return}clearTimeout(U);$(window).unbind("mousemove",W);$(window).unbind("mouseup",X);$(window).unbind("blur",X);$(K).unbind("mouseup",X);if(T){B.svg.change(K,{cursor:null})}if(V){if(S!=null&&Q.x1!=null&&!isNaN(Q.x1)){B.selectElementsFromIntersection(S,Q);B.svg.remove(S)}else{if(!B.shiftDown){B.unselectAll()
}}}};$(window).bind("mouseup",X);$(window).bind("blur",X);$(K).bind("mouseup",X)}}).bind("mousewheel",function(U,V,R,Q){if(!B.cy.panning()||!B.cy.zooming()){return}B.offsetFix(U.originalEvent);var P={x:U.originalEvent.offsetX,y:U.originalEvent.offsetY};var S=0.5;if($.browser.mozilla||$.browser.msie){S=0.167}var T=B.zoom()*(1+Q*S);B.zoomAboutPoint(P,T);B.cy.trigger("zoom");B.cy.trigger("pan");U.preventDefault()});function F(S,Q){var P,V;var T=B.cy.container().offset();var R=S.originalEvent.touches;
var U=R[Q];P=U.pageX-T.left;V=U.pageY-T.top;return{x:P,y:V}}function G(Q){var R=F(Q,0);var P=F(Q,1);return{x:(R.x+P.x)/2,y:(R.y+P.y)/2}}function w(Q){var R=F(Q,0);var P=F(Q,1);return B.getDistance(R,P)}function L(P){return P.originalEvent.touches==null?0:P.originalEvent.touches.length}function v(P,Q){return L(P)>=Q}function J(P){if(P>=2){N=true;s=true;clearTimeout(u);u=setTimeout(function(){s=false},D)}else{N=false}}var D=100;var N=false;var s=false;var u=null;var H=true;var O,x,C,z,y,I,E,A;$(K).bind("touchstart",function(P){if(!t(P)||B.touchingNodes.size()>0){return
}P.preventDefault();z=F(P,0);if(v(P,2)){O=G(P);x=B.modelPoint(O);C=w(P);y=F(P,1);J(2)}else{J(1);H=true}A=false}).bind("touchmove",function(Q){if(!t(Q)||B.touchingNodes.size()>0){return}H=false;if(v(Q,2)){J(2);E=F(Q,1)}else{J(1)}Q.preventDefault();var W={x:0,y:0};if(v(Q,1)&&B.cy.panning()){I=F(Q,0);if(v(Q,2)&&B.cy.zooming()){var P=w(Q);var R=P/C;O=B.renderedPoint(x);if(R!=1){var V=1.5;var U={x:I.x-z.x,y:I.y-z.y};var T={x:E.x-y.x,y:E.y-y.y};W={x:(U.x+T.x)/2,y:(U.y+T.y)/2};if(R>1){R=(R-1)*V+1}else{R=1-(1-R)*V
}var S=B.zoom()*R;B.zoomAboutPoint(O,S,W);C=P}}else{if(!s){W={x:I.x-z.x,y:I.y-z.y};B.panBy(W)}}z=I;y=E}}).bind("touchend",function(P){if(H&&t(P)){B.unselectAll()}});$(K).bind("mousedown mouseup click mouseover mouseout mousemove touchstart touchmove touchend",function(Q){if(t(Q)){var P=$.extend({},Q,{cyTarget:B.cy});B.cy.background().trigger(P);B.cy.trigger(P)}})};n.prototype.zoomAboutPoint=function(y,z,s){var A=this;var t=A.cy;if(!t.panning()||!t.zooming()){return}var v=A.pan();var x=A.zoom();var w=z;
if(s==null){s={x:0,y:0}}var u={x:-w/x*(y.x-v.x-s.x)+y.x,y:-w/x*(y.y-v.y-s.y)+y.y};A.transform({translation:u,scale:w})};n.prototype.zoom=function(u){var v=this.cy;if(!v.zooming()){return}if(u===undefined){return this.scale}else{if(typeof u==typeof{}){var t=u;var s=t.position;if(t.renderedPosition!==undefined){s=this.modelPoint(t.renderedPosition)}if(s!==undefined){this.zoomAboutPoint(s,u.level)}else{this.transform({scale:t.level})}}else{this.transform({scale:u})}}};n.prototype.fit=function(B){var s=B.elements;
var K=B.zoom;var A=self.cy;if(!A.panning()||(K!==undefined&&!A.zooming())){return}if(s==null||s.size()==0){s=this.cy.elements()}if(s.is(":removed")){$.cytoscapeweb("debug","SVG renderer does not take into account removed elements when fitting");s=s.filter(":inside")}$.cytoscapeweb("debug","Fit SVG renderer to view bounds");var x=this.nodesGroup.getBBox();var E=this.edgesGroup.getBBox();var v,H,t,G;function C(N){var M=N.x;var z=M+N.width;var L=N.y;var w=L+N.height;if(M<v||v==null){v=M}if(z>t||t==null){t=z
}if(L<H||H==null){H=L}if(w>G||G==null){G=w}}s.nodes().each(function(){var w=this._private.renderer.svgGroup.getBBox();C(w)});s.edges().each(function(){var z=this._private.data.source;var L=this._private.data.target;var w=this._private.renderer.svg.getBBox();if(z==L){if(w.x==E.x){v=Math.min(w.x+w.width*0.4,x.x)}if(w.y==E.y){H=Math.min(w.y+w.height*0.4,x.y)}}else{w=this._private.renderer.svgGroup.getBBox();C(w)}});var I=t-v;var D=G-H;var u=this.cy.container().width();var J=this.cy.container().height();
var y=Math.min(u/I,J/D);if(K){this.transform({translation:{x:-v*y-(I*y-u)/2,y:-H*y-(D*y-J)/2},scale:y})}else{var F=this.scale;this.transform({translation:{x:-v*F+u/2-(t-v)/2*F,y:-H*F+J/2-(G-H)/2*F}})}};n.prototype.panBy=function(s){if(!this.cy.panning()){return}$.cytoscapeweb("debug","Relatively pan SVG renderer with position (%o)",s);this.transform({translation:{x:this.translation.x+d(s.x),y:this.translation.y+d(s.y)}})};n.prototype.pan=function(s){if(!this.cy.panning()){return}$.cytoscapeweb("debug","Pan SVG renderer with position (%o)",s);
if(s===undefined){return{x:this.translation.x,y:this.translation.y}}if(s==null||typeof s!=typeof{}){$.cytoscapeweb("error","You can not pan without specifying a proper position object; `%o` is invalid",s);return}this.transform({translation:{x:d(s.x),y:d(s.y)}})};n.prototype.capTransformation=function(x){var s=x.translation;var w=x.scale;var A=this;var t=A.options.maxZoom;var v=A.options.minZoom;var z=A.options.minPan;var u=A.options.maxPan;var y=true;var B=true;if(s!=null){if(s.x<z){s.x=z;B=false
}else{if(s.x>u){s.x=u;B=false}}if(s.y<z){s.y=z;B=false}else{if(s.y>u){s.y=u;B=false}}}else{s=A.translation}if(w!=null){if(w>t){w=t;y=false}else{if(w<v){w=v;y=false}}}else{w=A.scale}return{scale:w,translation:s,valid:y&&B,validScale:y,validTranslation:B}};n.prototype.transform=function(v){var t=this;var s=t.capTransformation(v);if(s.valid){t.translation=s.translation;t.scale=s.scale}else{if(v.capScale){$.cytoscapeweb("debug","Capping zoom level %o to %o",t.scale,s.scale);t.scale=s.scale}if(v.capTranslation){$.cytoscapeweb("debug","Capping translation %o to %o",t.translation,s.translation);
t.translation=s.translation}}function u(w){if(t.svg==null||w==null){return}t.svg.change(w,{transform:"translate("+t.translation.x+","+t.translation.y+") scale("+t.scale+")"})}u(t.nodesGroup);u(t.edgesGroup)};n.prototype.calculateStyleField=function(u,y){var s=this;var w=s.options.styleCalculator;var t=s.style.selectors;var v=undefined;var x=u._private.bypass[y];if(x!==undefined){v=x}else{$.each(t,function(z,A){var B=A[y];if(B!=null&&u.is(z)){v=B}})}return w.calculate(u,v)};n.prototype.calculateStyle=function(v){var s=this;
var z=s.options.styleCalculator;var u=s.style.selectors;var w={};$.each(u,function(A,B){if(v.is(A)){w=$.extend(w,B)}});w=$.extend(w,v._private.bypass);$.each(w,function(A,B){w[A]=z.calculate(v,B)});v._private.style=w;if(v.isEdge()){var x=v.source();var y=v.target();function t(){if(x._private.style.visibility=="visible"&&y._private.style.visibility=="visible"){return a(w.visibility)}else{return"hidden"}}w.visibility=t()}return w};n.prototype.updateNodePositionFromShape=function(t){var v=t._private.style;
var u=t._private.renderer.svgGroup;var s=t._private.position;c(v.shape).update(this.svg,u,t,s,v)};n.prototype.makeSvgEdgeInteractive=function(w){var t=w._private.renderer.svg;var x=w._private.renderer.svgTargetArrow;var v=w._private.renderer.svgSourceArrow;var u=$(t).parents("svg:first")[0];var s=this;$(t).add(x).add(v).bind("mouseup mousedown click touchstart touchmove touchend mouseover mousemove mouseout",function(y){if(s.edgeEventIsValid(w,y)){w.trigger(y)}}).bind("click touchend",function(y){s.selectElement(w)
})};n.prototype.makeSvgNodeLabelInteractive=function(s){};n.prototype.makeSvgNodeInteractive=function(v){var t=v._private.renderer.svg;var u=$(t).parents("svg:first")[0];var s=this;var w=null;$(t).bind("mousedown touchstart",function(y){w=false;v.trigger(y);if(v._private.grabbed||v._private.locked||!v._private.grabbable){y.preventDefault();return}if(y.type=="touchstart"&&y.originalEvent.touches.length>1){return}v._private.grabbed=true;v.trigger($.extend({},y,{type:"grab"}));s.touchingNodes=s.touchingNodes.add(v);
var G,E;if(y.type=="touchstart"){var B=y.originalEvent.touches;var A=B[B.length-1];G=A.pageX;E=A.pageY}else{G=y.pageX;E=y.pageY}var F=true;var C=function(K){w=true;var N,M;if(K.type=="touchmove"){var L=y.originalEvent.touches;var O=L[L.length-1];N=O.pageX;M=O.pageY}else{N=K.pageX;M=K.pageY}var I=(N-G)/s.zoom();var H=(M-E)/s.zoom();G=N;E=M;var J;if(v.selected()){J=s.selectedElements.add(v)}else{J=v.collection()}J.each(function(P,Q){Q._private.position.x+=I;Q._private.position.y+=H});s.updatePosition(J);
if(F){if(K.type!="touchmove"){s.moveToFront(v)}F=false}else{v.trigger($.extend({},K,{type:"position"}));v.trigger($.extend({},K,{type:"drag"}))}};$(window).bind("mousemove touchmove",C);var z=false;var x=0;var D=function(H){if(H.type=="touchend"&&H.originalEvent.touches.length!=0){return}if(!z){z=true}else{return}$(window).unbind("mousemove touchmove",C);$(window).unbind("mouseup touchend blur",D);$(t).unbind("mouseup touchend",D);v._private.grabbed=false;s.touchingNodes=s.touchingNodes.not(v);v.trigger($.extend({},H,{type:"free"}))
};$(window).bind("mouseup touchend blur",D);$(t).bind("mouseup touchend",D);y.preventDefault()}).bind("mouseup touchend",function(x){v.trigger($.extend({},x));if(w==false){w=null;v.trigger($.extend({},x,{type:"click"}));s.selectElement(v)}}).bind("mouseover mouseout mousemove",function(x){if(s.nodeEventIsValid(v,x)){v.trigger($.extend({},x))}})};n.prototype.edgeEventIsValid=function(u,v){var s=$(v.relatedTarget);var t=this;switch(v.type){case"mouseover":case"mouseout":return s.parent().parent().size()>0;
default:return true}};n.prototype.nodeEventIsValid=function(u,v){var s=$(v.relatedTarget);var t=this;switch(v.type){case"mouseover":case"mouseout":return s.parent().parent().size()>0;default:return true}};n.prototype.modelPoint=function(t){var s=this;return{x:(t.x-s.pan().x)/s.zoom(),y:(t.y-s.pan().y)/s.zoom()}};n.prototype.renderedPoint=function(t){var s=this;return{x:t.x*s.zoom()+s.pan().x,y:t.y*s.zoom()+s.pan().y}};n.prototype.renderedPosition=function(t){var s=this;return s.renderedPoint(t._private.position)
};n.prototype.hideElements=function(s){s.each(function(u,t){t._private.bypass.visibility="hidden"});this.updateBypass(s)};n.prototype.showElements=function(u){var t=this;var s=this.cy.collection();u.each(function(w,v){v._private.bypass.visibility="visible"});this.updateBypass(u)};n.prototype.elementIsVisible=function(s){return s._private.style.visibility!="hidden"};n.prototype.renderedDimensions=function(t){var s=this;if(t.isNode()){return{height:t._private.style.height*s.zoom(),width:t._private.style.width*s.zoom()}
}else{return{width:t._private.style.width*s.zoom()}}};n.prototype.unselectElements=function(s){s=s.collection();s.unselect();this.selectedElements=this.selectedElements.not(s)};n.prototype.selectElementsFromIntersection=function(v,x){var t=this;var u=this.cy.collection();var s=this.cy.collection();function w(E){if(!t.elementIsVisible(E)){return false}var H=c(E._private.style.shape).intersectionShape;var L=t.modelPoint({x:x.x1,y:x.y1});var I=t.modelPoint({x:x.x2,y:x.y2});var C=t.svg.rect(L.x,L.y,I.x-L.x,I.y-L.y);
var A=Intersection.intersectShapes(new Rectangle(C),new H(E._private.renderer.svg));t.svg.remove(C);var P=t.zoom();var N=E.renderedPosition().x;var K=E.renderedPosition().y;var O=E.renderedDimensions().width+E._private.style.borderWidth*P;var F=E.renderedDimensions().height+E._private.style.borderWidth*P;var B=x.x1;var M=x.y1;var z=x.x2;var J=x.y2;var D=B<=N&&N<=z&&M<=K&&K<=J;var G=A.points.length>0;return D||G}this.cy.elements().each(function(z,y){if(y.isNode()){if(w(y)){u=u.add(y)}}else{if(t.elementIsVisible(y)&&w(y.source())&&w(y.target())){u=u.add(y)
}}});if(!t.shiftDown){s=s.add(this.cy.elements().filter(function(y,z){return z.selected()&&!u.allSame(z)}))}s.unselect();u.select();t.selectedElements=t.selectedElements.not(s);t.selectedElements=t.selectedElements.add(u)};n.prototype.selectElement=function(u){var t=this;var s=t.cy.collection();var v=t.cy.collection();if(!t.shiftDown){s=s.add(t.cy.elements().filter(function(w,x){return x.selected()&&!u.same(x)}))}if(t.shiftDown){if(u.selected()){s=s.add(u)}else{v=v.add(u)}}else{if(!u.selected()){v=v.add(u)
}}s.unselect();v.select();t.selectedElements=t.selectedElements.not(s);t.selectedElements=t.selectedElements.add(v);t.moveToFront(v)};n.prototype.moveToFront=function(t){t=t.collection();var s=this;t.each(function(v,u){s.svg.remove(u._private.renderer.svgGroup);s.makeSvgElement(u);s.updatePosition(t.closedNeighborhood().edges())})};n.prototype.unselectAll=function(){this.unselectElements(this.cy.elements())};n.prototype.makeSvgNode=function(u){var w=u._private.position;var s=this;if(w.x==null||w.y==null){$.cytoscapeweb("debug","SVG renderer is ignoring creating of node `%s` with position (%o, %o)",u._private.data.id,w.x,w.y);
return}var t;var v=this.calculateStyle(u);var x=this.svg.group(this.nodesGroup);u._private.renderer.svgGroup=x;t=c(v.shape).svg(this.svg,x,u,w,v);u._private.renderer.svg=t;this.makeSvgNodeLabel(u);u._private.renderer.svg=t;$.cytoscapeweb("debug","SVG renderer made node `%s` with position (%i, %i)",u._private.data.id,w.x,w.y);this.makeSvgNodeInteractive(u);this.updateElementStyle(u,v);return t};n.prototype.makeSvgNodeLabel=function(u){var t=this;var s=u._private.position.x;var v=u._private.position.y;
u._private.renderer.svgLabelGroup=t.svg.group(u._private.renderer.svgGroup);u._private.renderer.svgLabelOutline=t.svg.text(u._private.renderer.svgLabelGroup,s,v,"label init");u._private.renderer.svgLabel=t.svg.text(u._private.renderer.svgLabelGroup,s,v,"label init")};n.prototype.positionSvgNodeLabel=function(t){var s=this;s.svg.change(t._private.renderer.svgLabel,{x:t._private.position.x,y:t._private.position.y});s.svg.change(t._private.renderer.svgLabelOutline,{x:t._private.position.x,y:t._private.position.y})
};n.prototype.makeSvgEdgePath=function(I){var E=this;var ag=I.target();var O=I.source();var x=ag._private.data.id==O._private.data.id;var ab;var K=O._private.position.x;var at=O._private.position.y;var J=ag._private.position.x;var ar=ag._private.position.y;if(K==J&&at==ar){J++;ar++}var H=I.parallelEdges();var B=H.size();var Y;var A;var aa=20;var ah=20;var U,R,Q;var X=E.getDistance({x:K,y:at},{x:J,y:ar});var aj=200;if(!x&&D){aa=Math.min(20+4000/X,aj)}H.each(function(au,av){if(av==I){Y=au}});function t(){var au=A!=0;
var av=E.svg.createPath();if(ab!=null){E.svg.remove(ab)}if(x){ab=E.svg.path(I._private.renderer.svgGroup,av.move(K,at).curveC(R.x,R.y,Q.x,Q.y,J,ar))}else{if(au){ab=E.svg.path(I._private.renderer.svgGroup,av.move(K,at).curveQ(U.x,U.y,J,ar))}else{ab=E.svg.path(I._private.renderer.svgGroup,av.move(K,at).line(J,ar))}}}if(x){var M=O._private.style.height;var G=O._private.style.width;aa+=Math.max(G,M);A=Y;aa+=ah*(A);var an=aa;R={x:K,y:at-M/2-an};Q={x:K-G/2-an,y:at};t()}else{var ac=B%2==0;if(ac){A=Y-B/2+(Y<B/2?0:1);
if(A>0){A-=0.5}else{A+=0.5}}else{A=Y-Math.floor(B/2)}var D=A!=0;if(O._private.data.id>ag._private.data.id){A*=-1}if(D){U=R=Q=E.getOrthogonalPoint({x:K,y:at},{x:J,y:ar},aa*A)}else{U=R={x:J,y:ar};Q={x:K,y:at}}t()}var s=E.calculateStyleField(I,"width");var ad=E.calculateStyleField(ag,"shape");var V=E.calculateStyleField(O,"shape");var u=E.calculateStyleField(I,"targetArrowShape");var ap=E.calculateStyleField(I,"sourceArrowShape");var al=3;var y=10;while(al*s<y){al++}var ao=al;var v=ao*s;var ad=c(ad).intersectionShape;
var V=c(V).intersectionShape;var w=Intersection.intersectShapes(new Path(ab),new ad(ag._private.renderer.svg));var ae=w.points[w.points.length-1];w=Intersection.intersectShapes(new Path(ab),new V(O._private.renderer.svg));var F=w.points[0];var Z=ao*s;var C=-1*(this.getAngle(R,{x:K,y:at})-90);var T=-1*(this.getAngle(Q,{x:J,y:ar})-90);if(ae!=null){if(u!="none"){var L=E.getPointAlong(ae,Q,v/2,ae);J=L.x;ar=L.y}else{if(ae!=null){J=ae.x;ar=ae.y}}}if(F!=null){if(ap!="none"){var S=E.getPointAlong(F,R,v/2,F);
K=S.x;at=S.y}else{K=F.x;at=F.y}}t();if(I._private.renderer.svgTargetArrow!=null){this.svg.remove(I._private.renderer.svgTargetArrow)}if(u!="none"){var ak=k(u);var W={x:J-ak.centerPoint.x*Z,y:ar-ak.centerPoint.y*Z,};var z=ak.centerPoint;var am=ak==null?null:ak.svg(this.svg,I._private.renderer.svgGroup,I,I._private.position,I._private.style);I._private.renderer.svgTargetArrow=am;this.svg.change(am,{transform:"translate("+W.x+" "+W.y+") scale("+Z+") rotate("+T+" "+z.x+" "+z.y+")"})}if(I._private.renderer.svgSourceArrow!=null){this.svg.remove(I._private.renderer.svgSourceArrow)
}if(ap!="none"){var P=k(ap);var N={x:K-P.centerPoint.x*Z,y:at-P.centerPoint.y*Z,};var ai=P.centerPoint;var af=P==null?null:P.svg(this.svg,I._private.renderer.svgGroup,I,I._private.position,I._private.style);I._private.renderer.svgSourceArrow=af;this.svg.change(af,{transform:"translate("+N.x+" "+N.y+") scale("+Z+") rotate("+C+" "+ai.x+" "+ai.y+")"})}var aq;if(x){aq={x:(R.x+Q.x)/2*0.85+ag._private.position.x*0.15,y:(R.y+Q.y)/2*0.85+ag._private.position.y*0.15}}else{if(D){aq={x:(U.x+(K+J)/2)/2,y:(U.y+(at+ar)/2)/2}
}else{aq={x:(K+J)/2,y:(at+ar)/2}}}I._private.renderer.svgLabelGroup=E.svg.group(I._private.renderer.svgGroup);I._private.renderer.svgLabelOutline=E.svg.text(I._private.renderer.svgLabelGroup,aq.x,aq.y,"label init");I._private.renderer.svgLabel=E.svg.text(I._private.renderer.svgLabelGroup,aq.x,aq.y,"label init");I._private.renderer.svg=ab;return ab};n.prototype.markerDrawFix=function(){this.forceRedraw()};n.prototype.forceRedraw=function(){this.svg.change(this.svgRoot,{opacity:0});this.svg.change(this.svgRoot,{opacity:Math.random()});
this.svg.change(this.svgRoot,{opacity:1});var s=this.svg.rect(0,0,this.cy.container().width(),this.cy.container().height());this.svg.remove(s)};n.prototype.getAngle=function(y,x){var t=function(z){return z*180/Math.PI};var w=this.getDistance(y,x);var v=x.x-y.x;var s=-1*(x.y-y.y);var u=t(Math.acos(v/w));if(s<0){return 360-u}else{return u}};n.prototype.getOrthogonalPoint=function(x,w,t){var v={x:x.x-w.x,y:x.y-w.y};var u=this.getNormalizedPoint({x:v.y,y:-v.x},1);var s={x:(x.x+w.x)/2,y:(x.y+w.y)/2};return{x:s.x+u.x*t,y:s.y+u.y*t}
};n.prototype.getPointAlong=function(w,v,u,x){var s={x:v.x-w.x,y:v.y-w.y};var t=this.getNormalizedPoint({x:s.x,y:s.y},1);if(x==null){x=v}return{x:x.x+t.x*u,y:x.y+t.y*u}};n.prototype.getNormalizedPoint=function(v,u){var t=Math.sqrt(v.x*v.x+v.y*v.y);var s=u/t;return{x:v.x*s,y:v.y*s}};n.prototype.getDistance=function(t,s){return Math.sqrt((s.x-t.x)*(s.x-t.x)+(s.y-t.y)*(s.y-t.y))};n.prototype.makeSvgEdge=function(t){var s=this;var v=t.source();var x=t.target();if(v==null||x==null){$.cytoscapeweb("debug","SVG renderer is ignoring creating of edge `%s` with missing nodes");
return}var z=v._private.position;var w=x._private.position;if(z.x==null||z.y==null||w.x==null||w.y==null){$.cytoscapeweb("debug","SVG renderer is ignoring creating of edge `%s` with position (%o, %o, %o, %o)",t._private.data.id,z.x,z.y,w.x,w.y);return}var u=this.calculateStyle(t);var y=this.svg.group(this.edgesGroup);t._private.renderer.svgGroup=y;this.svg.change(y);this.makeSvgEdgePath(t);$.cytoscapeweb("debug","SVG renderer made edge `%s` with position (%i, %i, %i, %i)",t._private.data.id,z.x,z.y,w.x,w.y);
this.makeSvgEdgeInteractive(t);this.updateElementStyle(t,u);return t._private.renderer.svg};n.prototype.makeSvgElement=function(t){var s;if(t.group()=="nodes"){s=this.makeSvgNode(t)}else{if(t.group()=="edges"){s=this.makeSvgEdge(t)}}return s};n.prototype.getSvgElement=function(s){if(s._private.renderer.svg!=null){return s._private.renderer.svg}else{return this.makeSvgElement(s)}};n.prototype.updateSelection=function(s){this.updateElementsStyle(s)};n.prototype.updateClass=function(s){this.updateElementsStyle(s)
};n.prototype.updateData=function(t,s){this.updateElementsStyle(t);if(s){this.updateMapperBounds(t)}};n.prototype.updateMapperBounds=function(t){var s=cy.elements();if(t.nodes().size()>0&&t.edges().size()>0){}else{s=s.filter(function(){return this.group()==t[0].group()})}s=s.not(t);this.updateElementsStyle(s)};n.prototype.updateElementsStyle=function(t){var s=this;t=t.collection();t.nodes().each(function(v,u){s.updateElementStyle(u)});t.edges().each(function(v,u){s.updateElementStyle(u)});t.nodes().neighborhood().edges().not(t.edges()).each(function(v,u){s.updatePosition(u)
})};n.prototype.setStyle=function(s){this.style=$.extend(true,{},e.style,s)};n.prototype.updateStyle=function(s){var t=this.cy.elements();this.setStyle(s);this.updateElementsStyle(t)};n.prototype.updateBypass=function(t){var s=this;t=t.collection();t.nodes().each(function(v,u){s.updateElementStyle(u)});t.edges().add(t.closedNeighborhood().edges()).each(function(u,v){s.updateElementStyle(v)})};n.prototype.updateElementStyle=function(s,t){if(s.isNode()){this.updateNodeStyle(s,t)}else{if(s.isEdge()){this.updateEdgeStyle(s,t)
}}};n.prototype.updateNodeStyle=function(v,u){var z=v._private.style.shape;v._private.style=u!=null?u:this.calculateStyle(v);var s=v._private.style;var A=v._private.style.shape;if(v._private.renderer.svg==null){$.cytoscapeweb("error","SVG renderer can not update style for node `%s` since it has no SVG element",v._private.data.id);return}if(A!=z){this.svg.remove(v._private.renderer.svgGroup);this.makeSvgNode(v);return}this.svg.change(v._private.renderer.svg,{"pointer-events":"visible",fill:f(s.fillColor),fillOpacity:l(s.fillOpacity),stroke:f(s.borderColor),strokeWidth:d(s.borderWidth),strokeDashArray:g(s.borderStyle).array,strokeOpacity:l(s.borderOpacity),cursor:q(s.cursor),visibility:a(s.visibility)});
this.svg.change(v._private.renderer.svgGroup,{opacity:l(s.opacity)});var w={visibility:a(s.visibility),"pointer-events":"none",fill:f(s.labelFillColor),"font-family":s.labelFontFamily,"font-weight":s.labelFontWeight,"font-style":s.labelFontStyle,"text-decoration":s.labelFontDecoration,"font-variant":s.labelFontVariant,"font-size":s.labelFontSize};this.svg.change(v._private.renderer.svgLabelGroup,{opacity:l(s.labelOpacity)});this.svg.change(v._private.renderer.svgLabelOutline,{stroke:f(s.labelOutlineColor),strokeWidth:d(s.labelOutlineWidth)*2,fill:"none",opacity:l(s.labelOutlineOpacity)});
this.svg.change(v._private.renderer.svgLabelOutline,w);this.svg.change(v._private.renderer.svgLabel,w);var t=s.labelText==null?"":s.labelText;v._private.renderer.svgLabel.textContent=t;v._private.renderer.svgLabelOutline.textContent=t;var y=h(s.labelValign);var x=r(s.labelHalign);this.svg.change(v._private.renderer.svgGroup,{fillOpacity:l(s.fillOpacity)});c(s.shape).update(this.svg,this.nodesGroup,v,v._private.position,s);this.updateLabelPosition(v,y,x);$.cytoscapeweb("debug","SVG renderer collapsed mappers and updated style for node `%s` to %o",v._private.data.id,s)
};n.prototype.updateLabelPosition=function(v,A,x){var y=3;var G=0;var D=0;var C=0;var s=0;var B=v._private.renderer.svgLabel.textContent;this.positionSvgNodeLabel(v);var u;var z;var t;if(B==null||B==""){return}if(v.isNode()){C=v._private.style.height;s=v._private.style.width}if(x=="middle"){u={"text-anchor":"middle"}}else{if(x=="right"){u={"text-anchor":"start"};G=s/2+y}else{if(x=="left"){u={"text-anchor":"end"};G=-s/2-y}}}var F=parseInt(window.getComputedStyle(v._private.renderer.svgLabel)["fontSize"]);
var E=$.browser.msie?F/3:0;if(A=="middle"){z={style:"alignment-baseline: central; dominant-baseline: central;"};D=0+E}else{if(A=="top"){z={style:"alignment-baseline: normal; dominant-baseline: normal;"};D=-C/2-y}else{if(A=="bottom"){z={style:"alignment-baseline: normal; dominant-baseline: normal;"};D=C/2+F}}}t={transform:"translate("+G+","+D+")"};var w=$.extend({},u,z,t);this.svg.change(v._private.renderer.svgLabelOutline,w);this.svg.change(v._private.renderer.svgLabel,w)};n.prototype.updateEdgeStyle=function(y,v){var E=y._private.style.targetArrowShape;
var w=y._private.style.sourceArrowShape;y._private.style=v!=null?v:this.calculateStyle(y);var s=y._private.style;if(y._private.renderer.svg==null){$.cytoscapeweb("error","SVG renderer can not update style for edge `%s` since it has no SVG element",y._private.data.id);return}var x=y.source().style();var C=y._private.renderer.oldSourceStyle||x;var u=y.target().style();var F=y._private.renderer.oldTargetStyle||u;var G=y._private.style.targetArrowShape;var A=y._private.style.sourceArrowShape;var D=x.height!=C.height||x.width!=C.width||u.height!=F.height||u.width!=F.width||x.shape!=C.shape||u.shape!=F.shape||x.borderWidth!=C.borderWidth||u.borderWidth!=F.borderWidth;
var B=y._private.renderer.oldStyle==null||y._private.renderer.oldStyle.width!=s.width;y._private.renderer.oldSourceStyle=x;y._private.renderer.oldTargetStyle=u;y._private.renderer.oldStyle=s;if(G!=E||A!=w||D||B){this.svg.remove(y._private.renderer.svgGroup);this.makeSvgEdge(y);return}this.svg.change(y._private.renderer.svg,{"pointer-events":"visibleStroke",stroke:f(s.lineColor),strokeWidth:d(s.width),strokeDashArray:g(s.style).array,"stroke-linecap":"butt",opacity:l(s.opacity),cursor:q(s.cursor),fill:"none",visibility:a(s.visibility)});
this.svg.change(y._private.renderer.svgTargetArrow,{fill:f(s.targetArrowColor),cursor:q(s.cursor),visibility:a(s.visibility)});this.svg.change(y._private.renderer.svgSourceArrow,{fill:f(s.sourceArrowColor),cursor:q(s.cursor),visibility:a(s.visibility)});var z={visibility:a(s.visibility),"pointer-events":"none",fill:f(s.labelFillColor),"font-family":s.labelFontFamily,"font-weight":s.labelFontWeight,"font-style":s.labelFontStyle,"text-decoration":s.labelFontDecoration,"font-variant":s.labelFontVariant,"font-size":s.labelFontSize};
this.svg.change(y._private.renderer.svgLabel,z);this.svg.change(y._private.renderer.svgLabelOutline,$.extend({},z,{fill:"none",stroke:f(s.labelOutlineColor),strokeWidth:d(s.labelOutlineWidth)*2,opacity:l(s.labelOutlineOpacity),}));this.svg.change(y._private.renderer.svgLabelGroup,{opacity:l(s.labelOpacity)});var t=s.labelText==null?"":s.labelText;y._private.renderer.svgLabel.textContent=t;y._private.renderer.svgLabelOutline.textContent=t;this.updateLabelPosition(y,"middle","middle");$.cytoscapeweb("debug","SVG renderer collapsed mappers and updated style for edge `%s` to %o",y._private.data.id,s)
};n.prototype.addElements=function(u,t){var s=this;var v=this.cy;u.nodes().each(function(x,w){s.makeSvgElement(w)});u.edges().each(function(x,w){s.makeSvgElement(w)});s.positionEdges(u.edges().parallelEdges());if(t){s.updateMapperBounds(u)}};n.prototype.updatePosition=function(v){$.cytoscapeweb("debug","SVG renderer is updating node positions");v=v.collection();var s=this.cy.container();var u=s.svg("get");var t=this;var w=this.options.cy;v.nodes().each(function(z,y){var x=t.getSvgElement(y);var A=y._private.position;
t.updateNodePositionFromShape(y);t.positionSvgNodeLabel(y);$.cytoscapeweb("debug","SVG renderer is moving node `%s` to position (%o, %o)",y._private.data.id,A.x,A.y)});t.positionEdges(v.closedNeighborhood().edges())};n.prototype.positionEdges=function(t){var s=this;t.each(function(u,v){if(v._private.renderer.svgGroup!=null){s.svg.remove(v._private.renderer.svgGroup)}s.makeSvgEdge(v);var x=v.source()._private.position;var w=v.target()._private.position;$.cytoscapeweb("debug","SVG renderer is moving edge `%s` to position (%o, %o, %o, %o)",v._private.data.id,x.x,x.y,w.x,w.y)
})};n.prototype.drawElements=function(t){var s=this;s.updateElementsStyle(t)};n.prototype.removeElements=function(w,v){$.cytoscapeweb("debug","SVG renderer is removing elements");var s=this.cy.container();var u=s.svg("get");var x=this.options.cy;var t=this;w.each(function(z,y){if(y._private.renderer.svgGroup!=null){u.remove(y._private.renderer.svgGroup);delete y._private.renderer.svg;delete y._private.renderer.svgGroup;delete y._private.renderer.svgSourceArrow;delete y._private.renderer.svgTargetArrow
}else{$.cytoscapeweb("debug","Element with group `%s` and ID `%s` has no associated SVG element",y._private.group,y._private.data.id)}});if(t.selectedElements!=null){t.selectedElements=t.selectedElements.not(w)}if(v){this.updateMapperBounds(w)}};n.prototype.notify=function(u){var s=this.options.cy.container();$.cytoscapeweb("debug","Notify SVG renderer with params (%o)",u);if(u.type==null){$.cytoscapeweb("error","The SVG renderer should be notified with a `type` field");return}var t=this;switch(u.type){case"load":t.init(function(){t.addElements(u.collection)
});break;case"add":this.addElements(u.collection,u.updateMappers);break;case"remove":this.removeElements(u.collection,u.updateMappers);break;case"position":this.updatePosition(u.collection);break;case"style":this.updateStyle(u.style);break;case"bypass":this.updateBypass(u.collection);break;case"class":this.updateClass(u.collection);break;case"data":this.updateData(u.collection,u.updateMappers);break;case"select":case"unselect":this.updateSelection(u.collection);break;case"draw":this.drawElements(u.collection);
break;default:$.cytoscapeweb("debug","The SVG renderer doesn't consider the `%s` event",u.type);break}};function b(s){this.options=s;this.cy=s.cy;this.renderer=s.renderer;if(this.renderer.name()!="svg"){$.cytoscapeweb("error","The SVG exporter can be used only if the SVG renderer is used")}}b.prototype.run=function(){return this.options.cy.container().svg("get").toSVG()};$.cytoscapeweb("renderer","svg",n);$.cytoscapeweb("exporter","svg",b)});$(function(){function a(){$.cytoscapeweb("debug","Creating null layout")
}a.prototype.run=function(c){$.cytoscapeweb("debug","Running null layout with options (%o)",c);var d=c.cy;d.nodes().positions(function(){return{x:0,y:0}});function b(e){if(e!=null&&typeof e==typeof function(){}){e()}}d.trigger("layoutready");b(c.ready);d.trigger("layoutstop");b(c.stop)};$.cytoscapeweb("layout","null",a)});$(function(){var b={fit:true};function a(){$.cytoscapeweb("debug","Creating random layout with options")}a.prototype.run=function(h){var l=$.extend(true,{},b,h);var g=h.cy;var c=g.nodes();
var j=g.edges();var d=g.container();$.cytoscapeweb("debug","Running random layout with options (%o)",h);var e=d.width();var k=d.height();$.cytoscapeweb("debug","Random layout found (w, h, d) = (%i, %i)",e,k);c.positions(function(n,m){if(m.locked()){return false}return{x:Math.round(Math.random()*e),y:Math.round(Math.random()*k)}});if(l.fit){g.fit()}function f(m){if(m!=null&&typeof m==typeof function(){}){m()}}g.trigger("layoutready");f(h.ready);g.trigger("layoutstop");f(h.stop)};$.cytoscapeweb("layout","random",a)
});$(function(){var b={fit:true,rows:undefined,columns:undefined};function a(){$.cytoscapeweb("debug","Creating grid layout")}a.prototype.run=function(x){var g=$.extend(true,{},b,x);var f=x.cy;var t=f.nodes();var e=f.edges();var p=f.container();$.cytoscapeweb("debug","Running grid layout with options (%o)",g);var s=p.width();var r=p.height();$.cytoscapeweb("debug","Running grid layout on container of size (w, h) = (%i, %i) with %i nodes",s,r,t.size());if(r==0||s==0){$.cytoscapeweb("warn","Running grid layout on container of size 0");
t.positions(function(){return{x:0,y:0}})}else{var h=t.size();var n=Math.sqrt(h*r/s);var m=Math.round(n);var o=Math.round(s/r*n);$.cytoscapeweb("debug","Grid layout decided on initial (cols, rows) = (%i, %i)",o,m);function l(z){if(z==undefined){return Math.min(m,o)}else{var y=Math.min(m,o);if(y==m){m=z;$.cytoscapeweb("debug","Grid layout set small number of rows to %i",m)}else{o=z;$.cytoscapeweb("debug","Grid layout set small number of columns to %i",o)}}}function d(z){if(z==undefined){return Math.max(m,o)
}else{var y=Math.max(m,o);if(y==m){m=z;$.cytoscapeweb("debug","Grid layout set large number of rows to %i",m)}else{o=z;$.cytoscapeweb("debug","Grid layout set large number of columns to %i",o)}}}if(g.rows!=null&&g.columns!=null){m=g.rows;o=g.columns}else{if(g.rows!=null&&g.columns==null){m=g.rows;o=Math.ceil(h/m)}else{if(g.rows==null&&g.columns!=null){o=g.columns;m=Math.ceil(h/o)}else{if(o*m>h){var w=l();var q=d();$.cytoscapeweb("debug","Grid layout is looking to make a reduction");if((w-1)*q>=h){l(w-1)
}else{if((q-1)*w>=h){d(q-1)}}}else{$.cytoscapeweb("debug","Grid layout is looking to make an increase");while(o*m<h){var w=l();var q=d();if((q+1)*w>=h){d(q+1)}else{l(w+1)}}}}}}$.cytoscapeweb("debug","Grid layout split area into cells (cols, rows) = (%i, %i)",o,m);var v=s/o;var c=r/m;var k=0;var j=0;t.positions(function(B,A){if(A.locked()){return false}var z=j*v+v/2;var C=k*c+c/2;j++;if(j>=o){j=0;k++}return{x:z,y:C}})}if(g.fit){f.reset()}function u(y){if(y!=null&&typeof y==typeof function(){}){y()
}}f.trigger("layoutready");u(x.ready);f.trigger("layoutstop");u(x.stop)};$.cytoscapeweb("layout","grid",a)});$(function(){var b={fit:true};function a(){$.cytoscapeweb("debug","Creating preset layout with options")}a.prototype.run=function(j){var g=$.extend(true,{},b,j);$.cytoscapeweb("debug","Running preset layout with options (%o)",g);var k=j.cy;var f=k.nodes();var e=k.edges();var d=k.container();function h(l){if(g.positions==null){return null}if(g.positions[l._private.data.id]==null){return null
}return g.positions[l._private.data.id]}f.positions(function(m,n){var l=h(n);if(n.locked()||l==null){return false}return l});if(g.fit){k.fit()}function c(l){if(l!=null&&typeof l==typeof function(){}){l()}}k.trigger("layoutready");c(j.ready);k.trigger("layoutstop");c(j.stop)};$.cytoscapeweb("layout","preset",a)});